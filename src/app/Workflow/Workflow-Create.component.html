<p-breadcrumb [model]="breadcrumbs" *ngIf="!isWorkOrder || isView"></p-breadcrumb>
<div class="x_content margin-bottom-0">
    <div class="card" *ngIf="!isQuote">
        <div class="card-header header">
            <div class="row">
                <div class="col">
                    <h4 class="header-name">{{typeOfForm}} Workflow
                        <button class="btn-sm header-button header-button-alignment"
                            (click)="toggle_wf_header=!toggle_wf_header">
                            {{toggle_wf_header ? 'Collapse' : 'Expand'}}
                        </button>
                    </h4>
                </div>
                <div *ngIf="!isWorkOrder || isView">
                    <button type="button" class="btn-sm header-button pull-right"
                        [routerLink]="['/workflowmodule/workflowpages/app-workflow-list']">
                        Workflow List
                    </button>
                </div>
            </div>
        </div>
        <div class="card-body" *ngIf="toggle_wf_header">
            <div>
                <div class="form-row">
                    <div class="col-md-6 wf-h-col">
                        <div class="form-row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="workflowid">Workflow ID <span class="clr-red">*</span></label>
                                    <input type="text" class="form-control" id="workflowid"
                                        value="{{ sourceWorkFlow.workflowId != undefined ? sourceWorkFlow.workOrderNumber : 'Creating' }}"
                                        [disabled]="true">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="Part Number">
                                        PN <span class="clr-red">*</span>
                                    </label>
                                    <p class="c-workflow-select">
                                        <p-autoComplete appendTo="body" [(ngModel)]="sourceWorkFlow.part"
                                            [suggestions]="partCollection" (completeMethod)="filterpartItems($event)"
                                            [size]="32" [minLength]="1" [dropdown]="true" class="wf-header-select"
                                            #partNum="ngModel" errorMessage="Records not found" field="partName"
                                            (onSelect)="onPartSelect($event)" [forceSelection]="true" title="PN"
                                            required>
                                        </p-autoComplete>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="description">Workflow Description</label>
                                    <input type="text" class="form-control" id="description" (ngModelChange)="checkEnableUpdate()"
                                        [(ngModel)]="sourceWorkFlow.workflowDescription">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="PN Description">PN Description </label>
                                    <input type="text" class="form-control" id="pnDescription" 
                                        [(ngModel)]="sourceWorkFlow.partNumberDescription" [disabled]="true">
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="version">Version <span class="clr-red">*</span></label>
                                    <input type="text" class="form-control" id="version" required
                                        [(ngModel)]="sourceWorkFlow.version" [disabled]="true" value="{{'V-1'}}">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="changepn">Revised PN</label>
                                    <input type="text" class="form-control" id="revisedPartNumber"
                                        [(ngModel)]="sourceWorkFlow.revisedPartNumber" [disabled]="true">
                                    </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="createdate">Create Date <span class="clr-red">*</span></label>
                                    <p-calendar class="workflow-clder" [showIcon]="true" [yearNavigator]="true"
                                        [monthNavigator]="true" yearRange="1900:2100"
                                        [ngModelOptions]="{standalone: true}"
                                        [(ngModel)]="sourceWorkFlow.workflowCreateDate"
                                        (ngModelChange)="checkEnableUpdate()" required #cDate="ngModel">
                                    </p-calendar>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="work scope">Work Scope <span class="clr-red">*</span></label>
                                    <select [(ngModel)]="sourceWorkFlow.workScopeId"  class="form-control"
                                        (change)="checkEnableUpdate()" required>
                                        <option value="0" selected>--Select--</option>
                                        <option *ngFor="let workScope of worksScopeCollection"
                                            [ngValue]="workScope.workScopeId"> {{workScope.description}}</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="expdate">Expiration Date</label>
                                    <p-calendar class="workflow-clder" [minDate]="sourceWorkFlow.workflowCreateDate"
                                        [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"
                                        [showIcon]="true" [ngModelOptions]="{standalone: true}"
                                        [(ngModel)]="sourceWorkFlow.workflowExpirationDate"
                                        (ngModelChange)="checkEnableUpdate()" [disabled]="!cDate.valid">
                                    </p-calendar>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="ItemGroup">Item Group </label>
                                    <input type="text" class="form-control" id="itemGroup"
                                        [(ngModel)]="sourceWorkFlow.itemGroup" [disabled]="true">
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                        </div>
                        <div class="form-row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="currency">Currency <span class="clr-red">*</span></label>
                                    <select [(ngModel)]="sourceWorkFlow.currencyId" (change)="checkEnableUpdate()"
                                        required>
                                        <option value="0" selected>--Select--</option>
                                        <option *ngFor="let currencyName of allCurrencyData"
                                            [ngValue]="currencyName.currencyId"> {{currencyName.code}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="Customer Name">Customer Name<span class="clr-red"></span>
                                    </label>
                                    <p class="c-workflow-select">
                                        <p-autoComplete appendTo="body"  [(ngModel)]="sourceWorkFlow.customerName"
                                            [suggestions]="customerNames" (completeMethod)="filterNames($event)"
                                            [size]="32" [minLength]="1" [dropdown]="true" class="wf-header-select"
                                            #partNum="ngModel" errorMessage="Records not found" field="customerName"
                                            (onSelect)="onCustomerNameselected($event)" [forceSelection]="true"
                                            title="customerName">
                                        </p-autoComplete>
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div class="margin-top-8">
                            <div class="col-md-11">
                                <div class="form-group memo-popup-cstm">
                                    <label>
                                        Memo<i class="fa fa-pencil" data-toggle="modal" data-target="#add-description"
                                            matTooltipPosition="above" matTooltip="Notes"
                                            (click)="onAddDescription('notes')"></i>
                                    </label>
                                    <span>
                                        <div class="form-group memo-popup-cstm mat_emo">
                                            <div [innerHTML]="sourceWorkFlow.memo"
                                                [matTooltip]="parsedText(sourceWorkFlow.memo)" class="form-control"
                                               
                                                class="text_editor_box memo_cehck">
                                            </div>
                                        </div>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <div class="form-row">
                                    <div class="col-md-4">
                                        <h5>BER Determination</h5>
                                    </div>
                                     <div class="col-md-8 ber-padding"> 
                                        <h5 class="float-right"> BER Thershold :
                                            <span   
                                             class="clr-red">{{sourceWorkFlow.berThresholdAmount ? (sourceWorkFlow.berThresholdAmount ) : '0.00'}}</span>
                                        </h5>
                                    </div>
                                </div>
                            </div>
                            <div class="card-body ber-card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="col">
                                            <div class="checkbox-cstm">
                                                <label>
                                                    <input type="checkbox" [checked]="sourceWorkFlow.isFixedAmount"
                                                        name="ber-type" class="trigger2" data-rel="ber-fixed"
                                                        (click)="isFixedcheck('fixed');isFixedUnchecked($event);berDetermination($event.target.value,'html');"
                                                        value="">
                                                    <span class="cr"><i class="cr-icon pi pi-check"></i></span>
                                                    Fixed Amount
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div [hidden]="!isFixed" >
                                            <div class="col-sm-4">
                                            </div>
                                            <div class="col-sm-4">
                                            </div>
                                            <div class="col-sm-4">
                                                <label class="w60">Amount:</label>
                                                <input  class="form-control w70 text-right fix_fnt" type="text"
                                                    name="fixedAmount" [(ngModel)]="sourceWorkFlow.fixedAmount"                                        
                                                    (input)="berDetermination($event.target.value,'html')" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row m-t-10">
                                    <div class="col-md-4">
                                        <div class="col">
                                            <div class="checkbox-cstm">
                                                <label class="m-t-5">
                                                    <input type="checkbox" [checked]="sourceWorkFlow.isPercentageOfNew"
                                                        name="ber-type" class="trigger2" data-rel="ber-new"
                                                        (click)="isFixedcheck('percentage');isPercentageUnchecked($event); berDetermination($event.target.value,'html');"
                                                        value="">
                                                    <span class="cr"><i class="cr-icon pi pi-check"></i></span>
                                                    % of Cost of New
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div [hidden]="!ispercent">
                                            <div class="col-sm-4">
                                                <label class="cost-label-width">Cost of New:  </label>
                                                <input type="text" [(ngModel)]="sourceWorkFlow.costOfNew" 
                                                    class="form-control w70 text-right" id="" name="" pInputText
                                                    pKeyFilter="money"  (ngModelChange)="checkEnableUpdate()"
                                                    (change)="onPercentOfNew(sourceWorkFlow.costOfNew,sourceWorkFlow.percentageOfNew)">
                                            </div>
                                            <div class="col-sm-4">
                                                <label class="w60">Percent:</label>
                                                <select [(ngModel)]="sourceWorkFlow.percentageOfNew"
                                                    class="form-control w70"  (ngModelChange)="checkEnableUpdate()"
                                                    (change)="onPercentOfNew(sourceWorkFlow.costOfNew,sourceWorkFlow.percentageOfNew);">
                                                    <option value="-1">--Select--</option>
                                                    <option *ngFor="let percent of totalPercent"
                                                        [ngValue]="percent.value">
                                                        {{percent.label}}%</option>
                                                </select>
                                            </div>
                                            <div class="col-sm-4">
                                                <label class="w60">Amount:</label>
                                                <input type="text" class="form-control w70 text-right" pInputText
                                                    pKeyFilter="money" value="{{sourceWorkFlow.percentOfNew ==NaN ? ' ' :sourceWorkFlow.percentOfNew}}"
                                                    disabled />
                                             </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row m-t-10">
                                    <div class="col-md-4">
                                        <div class="col">
                                            <div class="checkbox-cstm">
                                                <label class="m-t-5">
                                                    <input type="checkbox"
                                                        [checked]="sourceWorkFlow.isPercentageOfReplacement"
                                                        name="ber-type" class="trigger2" data-rel="ber-replace"
                                                        (click)="isFixedcheck('percentreplace');isPercentreplcaeUnchecked($event); berDetermination($event.target.value,'html');"
                                                        value="">
                                                    <span class="cr"><i class="cr-icon pi pi-check"></i></span>
                                                    % of Replacement Cost
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div [hidden]="!percentreplcae">
                                            <div class="col-sm-4">
                                                  <label class="cost-replace-label">Cost of Replace:  </label>
                                                    <input  [(ngModel)]="sourceWorkFlow.costOfReplacement" pInputText
                                                        pKeyFilter="money" class="form-control w70 amount text-right"
                                                        type="text"  (ngModelChange)="checkEnableUpdate()"
                                                        (change)="onPercentOfReplcaement(sourceWorkFlow.costOfReplacement,sourceWorkFlow.percentageOfReplacement)">
                                             </div>
                                            <div class="col-sm-4">
                                                    <label class="w60">Percent:</label>
                                                 <select [(ngModel)]="sourceWorkFlow.percentageOfReplacement"
                                                        class="form-control w70"  (ngModelChange)="checkEnableUpdate()"
                                                        (change)="onPercentOfReplcaement(sourceWorkFlow.costOfReplacement,sourceWorkFlow.percentageOfReplacement); ">
                                                        <option value="-1">--Select--</option>
                                                        <option *ngFor="let percent of totalPercent"
                                                            [ngValue]="percent.value">{{percent.label}}%
                                                        </option>
                                                    </select>
                                                </div>
                                            <div class="col-sm-4"> 
                                                    <label class="w60">Amount: </label>
                                                    <input type="text" class="form-control w70 text-right" pInputText
                                                        pKeyFilter="money"
                                                        value="{{sourceWorkFlow.percentOfReplacement ==NaN ? ' ' : sourceWorkFlow.percentOfReplacement}}" disabled />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="m-t-10">
                            <h4 class="total-wf-cost">Total Workflow Cost</h4>
                            <div class="form-row mar-top-10 total-wf-cost-form">
                                <div class="col-md-2 workflow-cost-div m-t-20">
                                    <span class="label"><b>Workflow Cost: </b></span> 
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <span class="label"><b>Material </b></span> 
                                        <input type="text" class="form-control text-right" [(ngModel)]="MaterialCost"
                                            disabled />
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <span class="label"><b>Expertise </b></span> 
                                        <input type="text" class="form-control text-right"
                                            [(ngModel)]="TotalExpertiseCost" disabled />
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <span class="label"><b>Charges </b></span> 
                                        <input type="text" class="form-control text-right" [(ngModel)]="TotalCharges"
                                            disabled />
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <span class="label"><b>Other </b></span> 
                                        <input type="text" class="form-control text-right"
                                            (change)="onChangeOtherCost()" pInputText pKeyFilter="money"
                                            (ngModelChange)="checkEnableUpdate()"
                                            [(ngModel)]="sourceWorkFlow.otherCost" />
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <span class="label"><b>Total </b></span> 
                                        <input type="text" class="form-control text-right" [(ngModel)]="Total" value=""
                                            disabled />
                                    </div>
                                </div>                                
                            </div>
                            <div class="form-row mar-top-10 total-wf-cost-form">
                                <div class="col-md-2 workflow-cost-div m-t-5">
                                    <span class="label"><b>Mark Up % </b></span> 
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <select (ngModelChange)="checkEnableUpdate()"
                                            [(ngModel)]="sourceWorkFlow.percentageOfMaterial" class="form-control select_align_right"
                                            (change)="onMaterialCostChange(sourceWorkFlow.percentageOfMaterial,'html');">
                                            <option value="0">--Select--</option>
                                            <option *ngFor="let percent of totalPercent" [ngValue]="percent.value">
                                                {{percent.label}}%</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <select (ngModelChange)="checkEnableUpdate()"
                                            [(ngModel)]="sourceWorkFlow.percentageOfExpertise" class="form-control select_align_right"
                                            (change)="onExpertiseCostChange(sourceWorkFlow.percentageOfExpertise,'html');">
                                            <option value="0">--Select--</option>
                                            <option *ngFor="let percent of totalPercent" [ngValue]="percent.value">
                                                {{percent.label}}%</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <select (ngModelChange)="checkEnableUpdate()"
                                            [(ngModel)]="sourceWorkFlow.percentageOfCharges" class="form-control select_align_right"
                                            (change)="onChargesChange(sourceWorkFlow.percentageOfCharges,'html');">
                                            <option value="0">--Select--</option>
                                            <option *ngFor="let percent of totalPercent" [ngValue]="percent.value">
                                                {{percent.label}}%</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <select (ngModelChange)="checkEnableUpdate()" [disabled]="sourceWorkFlow.otherCost==0"
                                            [(ngModel)]="sourceWorkFlow.percentageOfOthers" class="form-control select_align_right"
                                            (change)="onOtherChange(sourceWorkFlow.percentageOfOthers,'html');">
                                            <option value="0">--Select--</option>
                                            <option *ngFor="let percent of totalPercent" [ngValue]="percent.value">
                                                {{percent.label}}%</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <input type="text" class="form-control text-right"
                                            [(ngModel)]="sourceWorkFlow.totPer" disabled />
                                    </div>
                                </div>
                                <div class="col-md-3 m-t-5">
                                    <div class="form-group adjustTher">
                                        <span class="label"><b>% of BER Threshold </b></span>
                                        <!-- <label><b>% of BER Threshold</b></label> -->
                                    </div>
                                </div>
                            </div>
                            <div class="form-row mar-top-10 total-wf-cost-form">
                                <div class="col-md-2 workflow-cost-div m-t-5">
                                    <span class="label"><b>Est. Price </b></span>
                                    <!-- <label><b>Est. Price</b></label> -->
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <input type="text" class="form-control text-right" [(ngModel)]="EstMaterialCost"
                                            disabled />
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <input type="text" class="form-control text-right"
                                            [(ngModel)]="EstTotalExpertiseCost" disabled />
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <input type="text" class="form-control text-right" [(ngModel)]="EstTotalCharges"
                                            disabled />
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <input type="text" class="form-control text-right" [(ngModel)]="EstTotalOthers"
                                            disabled />
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div"> 
                                    <div class="form-group">
                                        <input type="text" class="form-control text-right" [(ngModel)]="TotalEst"
                                            value="" disabled />
                                    </div>
                                </div>
                                <div class="col-md-2 workflow-cost-div">
                                    <div class="form-group">
                                        <input type="text" name="percentBERTh" class="form-control text-end" [(ngModel)]="percentBERTh"
                                            [value]="percentBERTh" disabled />
                                    </div>
                                </div> 
                            </div>
                        </div>                        
                    </div>
                </div>  
                <div class="pull-right"> 
                    <div class="form-row pull-right" *ngIf="!isWorkOrder">
                        <div class="form-group col-md-4 m-t-15">
                            <button class="btn btn-primary" *ngIf="!UpdateMode"
                                (click)="addWorkFlow(true)"
                                [disabled]=" !sourceWorkFlow.workflowCreateDate || !sourceWorkFlow.currencyId ||
                                !sourceWorkFlow.part || !sourceWorkFlow.workScopeId">Save</button>
                            <button class="btn btn-primary" *ngIf="UpdateMode"
                                [disabled]="disableUpdateButton || !sourceWorkFlow.workflowCreateDate || !sourceWorkFlow.currencyId ||
                                !sourceWorkFlow.part || !sourceWorkFlow.workScopeId"
                                (click)="isHeaderUpdate = true;showVersionUpdate()">Update</button>
                        </div>
                    </div>
                </div>
            </div>
          </div>
    </div>
</div> 
    <div class="x_content workflow-page">
        <div class="card-layout">
            <div>
                 <div class="card" *ngIf="sourceWorkFlow.workflowId">
                    <div class="card-body">
                        <div class="form-group col-sm-6">
                            <div class="col-sm-1 class-task">
                                <strong> <label class="fot-label"> Tasks </label></strong>
                            </div>
                            <div class="form-row">
                                <div class="col-sm-5">
                                    <div class="inner-addon inline-block display-flex">
                                        <select class="form-control custom-select" [(ngModel)]="currenttaskId"
                                            (change)="onActionChange()">
                                            <option value="0">--Select--</option>
                                            <option *ngFor="let action of actions" value={{action.Id}}>
                                                {{action.Name}}
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group col-sm-6" style="margin-left:-25%;" [hidden]="!showActionAttribute">
                            <div class="col-sm-1 class-Attribue">
                                <strong><label class="fot-label">Task Attribute</label></strong>
                            </div>
                            <div class="col-sm-5">
                                <div class="inner-addon inline-block display-flex">
                                    <ng-multiselect-dropdown *ngIf="actionAttributes" class="form-control"
                                        [placeholder]="'--Select--'" [data]="actionAttributes"
                                        [(ngModel)]="selectedItems" [settings]="dropdownSettings"
                                        (onDeSelect)="onDeSelect($event)" (onSelect)="onItemSelect($event)"
                                        (onDeSelectAll)="onDeSelectAll($event)" (onSelectAll)="onSelectAll($event)">
                                    </ng-multiselect-dropdown>
                                 </div>
                            </div>
                        </div>
                    </div>                
                </div>
                <div *ngIf="!workFlowList">
                    <p style="min-height: 200px;"></p>
                </div>
                <div class="bhoechie-tab-container clearfix"
                    *ngIf="workFlowList != undefined && workFlowList.length > 0">
                    <div class="bhoechie-tab-menu">
                        <div class="list-group">
                            <a href="javascript:void(0)" class="list-group-item " id='tab_{{workFlow.taskId}}'
                                (click)="SetCurrectTab(workFlow.taskId , i)"
                                *ngFor="let workFlow of workFlowList; let i = index"
                                [class.active]="workFlow.taskId == currenttaskId">
                                {{workFlow.ActionName}}

                                <i class="fa fa-trash delete-icon" (click)="removeTask(workFlow)"></i>
                            </a>

                        </div>
                    </div>

                    <div class="bhoechie-tab">
                         <div class="bhoechie-tab-content active">
                            <div class="custom-pill">
                                <ul class="nav nav-pills">
                                    <li *ngFor="let item of workFlow.selectedItems;let i=index;"
                                        (click)="setCurrentPanel(item.Name, item.Id)">
                                        <a data-toggle="pill"
                                            [class.active]="workFlow.selectedItems[i].Id == currentPanelId"
                                            href="#tab{{item.Name}}">{{item.Name}}</a>
                                    </li>
                                </ul>
                                <div class="tab-content" style="position: relative;">
                                    <div id="tab_Publications"
                                        *ngIf="workFlow != undefined && workFlow.publication != undefined"
                                        class="tab-pane fade pan">
                                        <grd-publication [UpdateMode]="UpdateMode" [workFlow]='workFlow'
                                            [itemMasterId]="itemMasterId">
                                        </grd-publication>
                                    </div>
                                    <div id="tab_Charges" *ngIf="workFlow != undefined && workFlow.charges != undefined"
                                        class="tab-pane fade in active pan">
                                        <grd-charges [UpdateMode]="UpdateMode" [workFlow]='workFlow' isWorkFlow="true">
                                        </grd-charges> 
                                    </div>
                                    <div id="tab_Directions"
                                        *ngIf="workFlow != undefined && workFlow.directions != undefined"
                                        class="tab-pane pan">
                                        <grd-directions [UpdateMode]="UpdateMode" [workFlow]='workFlow'>
                                        </grd-directions>
                                    </div>

                                    <div id="tab_Tools"
                                        *ngIf="workFlow != undefined && workFlow.equipments != undefined"
                                        class="tab-pane fade pan">
                                        <grd-equipment [UpdateMode]="UpdateMode" [workFlow]='workFlow' isWorkFlow="true">
                                        </grd-equipment>
                                    </div>
                                    <div id="tab_Exclusions"
                                        *ngIf="workFlow != undefined && workFlow.exclusions != undefined"
                                        class="tab-pane fade pan">
                                        <grd-exclusions [UpdateMode]="UpdateMode" [workFlow]='workFlow' [masterItemMasterId]="masterItemMasterId"
                                            isWorkFlow="true"></grd-exclusions>
                                    </div>
                                    <div id="tab_Expertise"
                                        *ngIf="workFlow != undefined && workFlow.expertise != undefined "
                                        class="tab-pane fade pan">
                                        <grd-expertise [UpdateMode]="UpdateMode" [workFlow]='workFlow'>
                                        </grd-expertise>
                                    </div>
                                    <div id="tab_Material_List"
                                        *ngIf="workFlow != undefined && workFlow.materialList != undefined"
                                        class="tab-pane fade pan">
                                        <grd-material [UpdateMode]="UpdateMode" [workFlow]='workFlow' isWorkFlow="true">
                                        </grd-material>
                                    </div>
                                    <div id="tab_Measurements"
                                        *ngIf="workFlow != undefined && workFlow.measurements != undefined"
                                        class="tab-pane fade pan">
                                        <grd-measurement (childEvent)="updateStatus($event)" [UpdateMode]="UpdateMode" [workFlow]='workFlow'>
                                        </grd-measurement>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div *ngIf="isWorkOrder" class="wowf-save-btn">
                        <div class="text-right">
                            <button class="btn btn-primary" data-target="#saveToWorkFlow" data-toggle="modal"
                              >Save To Work Flow</button>
                            <button class="btn btn-primary" data-target="#saveToWorkOrder" data-toggle="modal"
                               >Save To Work Order
                                Only</button>
                        </div>
                    </div>
                </div>
                <div *ngIf="!isWorkOrder">
                    <div class="text-right save-work-btn" *ngIf="isQuote">
                        <button class="btn btn-primary btn-primary" (click)="saveBuildFromScratchData()"
                          >Save</button>
                    </div>
                    <div class="text-right save-work-btn"
                        *ngIf="(showMainPage) && (!UpdateMode) && workFlowList.length > 0 && !isQuote">
                        <button class="btn btn-primary" (click)="addWorkFlow(false)"
                        style="padding:4px 8px !important"  >Save Work Flow</button>
                    </div>
                    <div class="text-right save-work-btn" *ngIf="(showMainPage) && (UpdateMode) ">
                        <button class="btn btn-primary " (click)="isHeaderUpdate = false;showVersionUpdate()"
                         style="padding:4px 8px !important"  >Update Work Flow Details</button> <!-- add-btn -->
                    </div>
                </div>
            </div>
            <div class="clear"></div>
            <div id="myModal" class="modal fade custom-popup" role="dialog" data-backdrop="static">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">
                                <i class="fa fa-close"></i>
                            </button>
                            <h4 class="modal-title">Add Task</h4>
                        </div>
                        <div class="modal-body">
                            <div class=" selection-box ">
                                <div class="row">
                                    <div class="col-lg-6 col-md-2 col-sm-2 col-xs-10">
                                        <label>Action Task Name</label>
                                        <input type="text" class="custom-form-control"
                                            [(ngModel)]="newAction.Description" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-lg-6 col-md-2 col-sm-2 col-xs-10">
                                        <label>Memo</label>
                                        <input type="text" class="custom-form-control" [(ngModel)]="newAction.Memo" />
                                    </div>
                                </div>
                                <br />
                                <div class="row">
                                    <div class="col-lg-2 col-md-2 col-sm-2 col-xs-10">
                                        <button class="btn btn-success" data-dismiss="modal" (click)="addAction()">
                                            SAVE
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="clear"></div>
        </div>
        <div class="clear"></div>
    </div>
    <ng-template #deleteConfirm let-c="close" let-d="dismiss" data-backdrop="static">
        <div class="modal-title">
            <h4>Confirm workflow delete</h4>
        </div>
        <div>
            <p> Are you sure you want to delete Worklflow Task?</p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-success" (click)="removeTask(null)">Yes</button>
            <button type="button" class="btn btn-danger" (click)="dismissModel()">No</button>
        </div>
    </ng-template>
    <div #saveToWorkFlow id="saveToWorkFlow" class="modal fade" role="dialog" data-backdrop="static"
        data-keyboard="false">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Are You Sure Want to Save to Workflow</h4>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal"
                        (click)="saveWorkFlowWorkOrder(true)">Yes</button>
                    <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
                </div>
            </div>
        </div>
    </div>
    <div #saveToWorkOrder id="saveToWorkOrder" class="modal fade" role="dialog" data-backdrop="static"
        data-keyboard="false">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Are You Sure Want to Save to WorkOrder Only</h4>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal"
                        (click)="saveWorkFlowWorkOrder(false)">Yes</button>
                    <button type="button" class="btn btn-danger" data-dismiss="modal">No</button>
                </div>
            </div>

        </div>
    </div>
    <div id="quoteVer" class="modal fade" role="dialog" data-backdrop="static">
        <div class="modal-dialog modal-sm text-center"> 
              <div class="modal-content">
                <div class="modal-header text-start">
                    <h4 class="modal-title text-left">Do you want to create a new version?</h4>
                    <button type="button" class="close" data-dismiss="modal">
                        &times;
                    </button>
                </div>
                <div class="modal-body table-responsive text-end m-t-15">
                    <button class="btn btn-primary " data-dismiss="modal" (click)="increaseVerConfirmation(true)"
                      >
                        Yes
                    </button>
                    <button class="btn btn-danger " data-dismiss="modal"
                        (click)="increaseVerConfirmation(false)">
                        No
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div id="confir" class="modal fade" role="dialog" data-backdrop="static">
        <div class="modal-dialog modal-sm text-center">
             <div class="modal-content">
                <div class="modal-header text-start">
                    <h4 class="modal-title text-left">Confirmation !</h4>
                    <button type="button" class="close" data-dismiss="modal">
                        &times;
                    </button>
                </div>
                <div class="modal-body table-responsive text-end" >
                    <p class="confirmation-p">Work Flow total cost exceed the BER threshold amount.
                        Do you still want to continue?</p>
                    <button class="btn btn-primary " data-dismiss="modal" (click)="confirmation()"
                       >
                        Ok
                    </button>
                    <button class="btn btn-danger " data-dismiss="modal"
                        (click)="dataCancel()">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="add-description" role="dialog" data-backdrop="static" data-keyboard="false">
        <div class="modal-dialog modal-lg" style="max-width: 500px !important;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Edit Memo</h4>
                </div>
                <div class="modal-body">
                   <p-editor [(ngModel)]="tempMemo" [style]="{'height':'320px'}" name="tempMemo"
                    required>
                </p-editor>
                </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary editor-buttons-margin" data-dismiss="modal" 
                        
                            (click)="onSaveDescription()">
                            Save
                        </button>
                        <button type="button" class="btn btn-danger editor-buttons-margin" data-dismiss="modal">
                            Close
                        </button>
                    </div>
                
            </div>
        </div>
    </div>
    <div id="UpdateConfirm" class="modal fade" role="dialog" data-backdrop="static">
        <div class="modal-dialog modal-sm text-center">
             <div class="modal-content">
                <div class="modal-header text-start">
                    <h4 class="modal-title text-left">Confirmation !</h4>
                    <button type="button" class="close" data-dismiss="modal">
                        &times;
                    </button>
                </div>
                <div class="modal-body table-responsive text-end">
                    <p class="confirmation-p">Work Flow total cost exceed the BER threshold amount.
                        Do you still want to continue?</p>
                    <button class="btn btn-primary " data-dismiss="modal" (click)="updateConfirmation()"
                        >
                        Ok
                    </button>
                    <button class="btn btn-danger " data-dismiss="modal"
                        (click)="upDateDataCancel()">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
    <div class="preloader" *ngIf="isSpinnerVisible">
        <div class="loading">
            <div class="lds-roller">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
    </div>