﻿<div class="card new-card">
  <div class="card-header header">
		<div class="row">
		  <div class="col">
			<h4 class="header-name">Stock Line List</h4>
		  </div>
		  <div>
			<button
			type="button"
			class="btn-sm header-button"
			[routerLink]="['/stocklinemodule/stocklinepages/app-stock-line-setup']">
			Add New Stock Line
			</button>
		  </div>
		</div>
  </div>
  <div class="card-body header-body">
    <p-table #dt 
            class="rpo-table-cstm rro-table-cstm" 
            [value]="data" 
            [first]="0" 
            [rows]="pageSize"
            [paginator]="true" 
            [pageLinks]="3" 
            [rowsPerPageOptions]="[10, 20, 50, 100]" 
            [columns]="selectedGridColumns"
            selectionMode="multiple"             
            [lazy]="true" 
            (onLazyLoad)="loadData($event)" 
            [resizableColumns]="true"
            [reorderableColumns]="true" 
            [totalRecords]="totalRecords" 
            [metaKeySelection]="true" 
            [scrollable]="true"
            scrollHeight="450px">
            <ng-template pTemplate="caption">
              <div class="row">
                <div class="col">
                  <p-multiSelect
                  [maxSelectedLabels]="2"
                  [options]="headers"
                  optionLabel="header"
                  [(ngModel)]="selectedGridColumns"
                 class="multiselect-field"
                  (onChange)="columnsChanges()"
                  ></p-multiSelect>
                </div>
                <div class="col">
                  <div class="global-search-field inner-addon right-addon inline-block">
                  <i class="fa fa-search"></i>
                  <input
                    type="text"
                    pInputText
                    size="50"
                    class="form-control"
                    (input)="globalSearch($event.target.value)"
                    placeholder="Filter" [(ngModel)]="globalSearchText"
                  />
                  </div>
                </div>
              </div>
                <div class="row">
                  <div class="col">
                    <button type="button"
                                    class="btn btn-primary exports-button"
                                    matTooltip="Download Data"
                                    matTooltipPosition="above"
                                    pButton
                                    icon="fa-download"
                                    iconPos="left"
                                    label="Export All Data"
                                    data-toggle="modal" 
                                    (click)="selectedOnly = false; targetData = dt;"
                                     data-target="#downloadConfirmation">
                            </button> 
                            <button type="button"
                                    class="btn btn-primary exports-button"
                                    matTooltip="Download Selected Data"
                                    matTooltipPosition="above"
                                    pButton
                                    icon="fa-download"
                                    iconPos="left"
                                    label="Export Selected Data"
                                    (click)="dt.exportCSV({selectionOnly:true})">
                            </button>
                  </div>
                  <div class="col">
                    <div class="">
                    <div
                      class="col stockline-radios"
                    >
                      <div class="form-group">
                        <div class="pull-left radio-buttons-align">
                          <label class="radio-cstm wauto">
                              <input type="radio" name="stockType" class="form-control" value="stock" (click)="geStocklineByStock('stock')" [(ngModel)]="currentStock">
                              <span class="checkmark"></span>Stock
                          </label>
                      </div>
                      <div class="pull-left radio-buttons-align">
                          <label class="radio-cstm wauto">
                              <input type="radio" name="stockType" class="form-control" value="nonstock" (click)="geStocklineByStock('nonstock')" [(ngModel)]="currentStock">
                              <span class="checkmark"></span>Non-Stock
                          </label>
                      </div>
                      <div class="pull-left radio-buttons-align">
                        <label class="radio-cstm wauto">
                            <input type="radio" name="stockType" class="form-control" value="all" (click)="geStocklineByStock('all')" [(ngModel)]="currentStock">
                            <span class="checkmark"></span>All
                        </label>
                      </div>
                      </div>
                    </div>
                    </div>
                  </div>
                  </div>
            </ng-template>
            <ng-template pTemplate="colgroup" let-columns>
                <colgroup>
                    <col *ngFor="let col of columns" class="table-column-width" [ngStyle]="{'width': col.width}" />
                </colgroup>
            </ng-template>

            <ng-template pTemplate="header" let-columns>
                <tr>
                    <ng-container *ngFor="let col of columns">
                        <th class="table-column-width"
                            *ngIf="col.field!='companyName' && col.field!='buName' && col.field!='divName' && col.field!='deptName'"
                            pResizableColumn pReorderableColumn [pSortableColumn]="col.field">
                            {{col.header}}
                            <p-sortIcon [field]="col.field"></p-sortIcon>
                        </th>
                        <th class="table-column-width" *ngIf="col.field=='companyName'" colspan="4" pResizableColumn
                            pReorderableColumn [pSortableColumn]="col.field">
                            Management Structure
                        </th>
                    </ng-container>
                    <th class="table-actions-column" *ngIf="selectedGridColumns.length > 0">
                        Actions
                    </th>
                </tr>
                <tr>
                    <th class="table-column-width" *ngFor="let col of columns" [ngSwitch]="col.field">
                        <input class="text-right" [type]="(col.field == 'quantityOnHand' || col.field == 'quantityAvailable')?'number':'text'"
                         *ngIf="col.field !== 'receivedDate' && col.field !== 'expirationDate' && col.field !== 'tagDate' && col.field !== 'createdDate' && col.field !== 'updatedDate'" 
                        class="table-header-input-width" pInputText [ngModel]="dt.filters[col.field] ? dt.filters[col.field].value : ''"
                            (input)="dt.filter($event.target.value, col.field, 'contains')" >
                        <input type="date" class="table-header-input-width" *ngIf="col.field == 'receivedDate'"
                            name="receivedDate"  (change)="dateFilterForTable($event.target.value, col.field)" />                        
                        <input type="date" class="table-header-input-width" *ngIf="col.field == 'expirationDate'"
                            name="expirationDate"  (change)="dateFilterForTable($event.target.value, col.field)" />                        
                        <input type="date" class="table-header-input-width" *ngIf="col.field == 'tagDate'"
                            name="tagDate"  (change)="dateFilterForTable($event.target.value, col.field)" />
                        <input type="date"   class="table-header-input-width" *ngIf="col.field == 'createdDate'"
                            name="createdDate"  (change)="dateFilterForTable($event.target.value, col.field)" />
                        <input type="date"   class="table-header-input-width"  *ngIf="col.field == 'updatedDate'"
                            name="updatedDate"  (change)="dateFilterForTable($event.target.value, col.field)" />
                    </th>
                    <th class="table-actions-column"></th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns">
                <tr [pSelectableRow]="rowData" pReorderableRowHandle (dblclick)="openView(rowData)">
                    <td class="table-column-width" *ngFor="let col of columns" class="ui-resizable-column" pReorderableRowHandle>    
                      <span *ngIf="col.field != 'quantityOnHand' && col.field != 'quantityAvailable'">  {{
                                          col.field == 'receivedDate'
                                            ? (rowData[col.field] |  date: 'MM/dd/yyyy h:mm a')
                                            : rowData[col.field] && col.field == 'expirationDate'
                                            ? (rowData[col.field] |  date: 'MM/dd/yyyy h:mm a')
                                            : rowData[col.field] && col.field == 'tagDate'
                                            ? (rowData[col.field] |  date: 'MM/dd/yyyy h:mm a')
                                            : rowData[col.field] && col.field == 'createdDate'
                                            ? (rowData[col.field] | date: 'MM/dd/yyyy h:mm a')
                                            : rowData[col.field] && col.field == 'updatedDate'
                                            ? (rowData[col.field] | date: 'MM/dd/yyyy h:mm a')
                                            : rowData[col.field]
                        }}</span>
                        <span class="float-right" *ngIf="col.field == 'quantityOnHand' || col.field == 'quantityAvailable'">
                         {{rowData[col.field]}} </span>
                    </td>

                    <td class="action-icons-cstm table-column-width" *ngIf="selectedGridColumns.length > 0">
                        <span data-toggle="modal"><a class="btn nobg btn-view-cstm" (click)="openView(rowData)"
                                matTooltip="View" matTooltipPosition="above"><i class="fa fa-eye"></i></a> </span>
                        <span><a class="btn nobg btn-edit-cstm" (click)="openEdits(rowData)" matTooltip="Edit"
                                matTooltipPosition="above"><i class="fa fa-pencil"></i></a> </span>
                        <span><a class="btn nobg btn-stock-cstm btn-users-cstm" (click)="openAdjustment(rowData)"
                                matTooltip="Stock Adjustment" matTooltipPosition="above"><i class="fa fa-cubes"></i></a> </span>
                        <span data-toggle="modal" data-target="#stockAdjAudit"><a class="btn nobg btn-adjhist-cstm" (click)="openStocklineAdj(rowData)" matTooltip="Stock Adjustment History" matTooltipPosition="above"><i class="fa fa-history"></i></a></span>
                        <span><a class="btn nobg btn-pluspo-cstm" (click)="routeToPORO(rowData, 'PO')" matTooltip="Create PO"
                                matTooltipPosition="above"><i class="fa fa-plus"></i></a> </span>
                        <span><a class="btn nobg btn-plusro-cstm" (click)="routeToPORO(rowData, 'RO')" matTooltip="Create RO"
                                matTooltipPosition="above"><i class="fa fa-plus" style="color: #259e08;"></i></a>
                        </span>
                        <span data-toggle="modal" data-target="#stockAudit"><a class="btn nobg btn-hist-cstm" (click)="openStocklineAudit(rowData)" matTooltip="History" matTooltipPosition="above"><i class="fa fa-history"></i></a></span>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage" let-columns *ngIf="data.length == 0">
                <tr>
                  <td colspan="25" class="no-records-msg no-records-cstm">
                    No records found
                  </td>
                </tr>
              </ng-template>

            <ng-template pTemplate="summary" id="footer">
                <label id="footer" class="footer">Total:</label>
                <input class="footer-input-width" [(ngModel)]="totalRecords" [disabled]="true" pInputText type="text" />
                &nbsp;&nbsp;
                <label id="footer" class="footer1">Pages Count:</label>
                <input class="footer-input-width" [(ngModel)]="totalPages" [disabled]="true" pInputText type="text" />
            </ng-template>
        </p-table>
  </div>
</div>
<div class="modal fade" id="downloadConfirmation" role="dialog" data-backdrop="static" data-keyboard="false">
	<div class="modal-dialog modal-sm">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" (click)="closeDeleteModal()">&times;</button>
				<h4 class="modal-title">Are You Sure Want to Download?</h4> 
			</div>
			<div class="modal-body" *ngIf="targetData">
				<strong>
					<!-- <span *ngIf="selectedOnly"> -->
          <span> 
						You are attempting to export {{targetData.totalRecords}} of records. 
					</span> 
				</strong>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary" (click)="(selectedOnly)?targetData.exportCSV({ selectionOnly: true }):exportCSV(targetData); closeDeleteModal();">Confirm</button>
				<button type="button" class="btn btn-danger" (click)="closeDeleteModal()">Cancel</button>
			</div>
		</div>
	</div>
</div>

<div id="stockAudit" class="modal fade" role="dialog" data-backdrop="static"
  data-keyboard="false">
  <div class="modal-dialog modal-xl">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          &times;
        </button>
        <h4 class="modal-title">History of Stockline</h4>
      </div>
      <div class="modal-body">
        <div class="table-responsive stockline-audit">
          <div class="tableFixHead">
          <table class="table table-bordered header-table-width" *ngIf="auditHistory.length > 0; else noDatavailable">
            <thead>
                <tr>
                    <th colspan="16">General</th>
                    <th colspan="6">Expiration</th>
                    <th colspan="3">Application</th>
                    <th colspan="4">Application</th>
                    <th colspan="12">Acquisition</th>
                    <th colspan="6">Traceability</th>
                    <th colspan="2">Export/International</th>
                    <th colspan="9">Inventory</th>
                    <th colspan="5">Location</th>
                    <th colspan="3">Lot & Consignment</th>
                    <th colspan="6">Warnings</th>
                    <th colspan="4">Management Structure <span class="clr-red">*</span></th>
                    <th colspan="9">Certification, Tag and Inspection</th>
                    <th colspan="1">Other</th>
                    <th colspan="1">Memo </th>
                    <th colspan="13">Time Life</th>
                    <th colspan="5"></th>
                </tr>
              <tr>
                <th>Is Customer Stock</th>
                <th>PN <span class="clr-red">*</span></th>
                <th>PN Description</th>
                <th>Revised PN</th>
                <th>OEM</th>
                <th>PMA</th>
                <th>DER</th>
                <th>Item Group </th>
                <th>Cond <span class="clr-red">*</span></th>
                <th>Is Serialized</th>
                <th>Serial Num <span class="clr-red">*</span></th>
                <th>Stockline Num</th>
                <th>NSN</th>
                <th>ESN</th>
                <th>Control Num</th>
                <th>Control ID Num</th>
                <th>Days Since Received</th>
                <th>Days Since Mfg</th>
                <th>Days Since Tagged</th>
                <th>Days Opened</th>
                <th>Shelf Life</th>
                <th>Shelf Life Exp Date</th>
                <th>NHA <span class="clr-red">*</span></th>
                <th>TLA <span class="clr-red">*</span></th>
                <th>Aircraft Tail Num</th>
                <th>Manufacturer <span class="clr-red">*</span></th>
                <th>Mfg. Lot Num</th>
                <th>Mfg. Batch Num</th>
                <th>Mfg. Date</th>
                <th>Acquisition Type</th>
                <th>Order Date</th>
                <th>Entry Date</th>
                <th>Expiration Date</th>
                <th>Vendor</th>
                <th>PO Num</th>
                <th>RO Num</th>
                <th>Requestor</th>
                <th>Received Date <span class="clr-red">*</span></th>
                <th>Receiver Num <span class="clr-red">*</span></th>
                <th>Reconciliation Num</th>
                <th>WO Num</th>
                <th>Obtain From Type</th>
                <th>Obtain From</th>
                <th>Owner Type</th>
                <th>Owner</th>
                <th>Traceable To Type</th>
                <th>Traceable To</th>
                <th>ECCN</th>
                <th>ITAR</th>
                <th>Qty On Hand <span class="clr-red">*</span></th>
                <th>Qty Reserved</th>
                <th>Qty Issued</th>
                <th>Qty Avail</th>
                <th>PO Unit Cost</th>
                <th>RO Unit Cost</th>
                <th>Unit Sale Price</th>
                <th>Core Cost/Unit</th>
                <th>GL Account</th>
                <th>Site <span class="clr-red">*</span></th>
                <th>Warehouse</th>
                <th>Location</th>
                <th>Shelf</th>
                <th>Bin</th>
                <th>Lot Num</th>
                <th>Lot Description</th>
                <th>Lot Cost</th>
                <th>Black List</th>
                <th>Black List Reason</th>
                <th>Accident</th>
                <th class="min-width-250">Accident Reason</th>
                <th>Incident</th>
                <th>Incident Reason</th>
                <th colspan="4"></th>
                <th>Part Cert Num</th>
                <th>Certify By</th>
                <th>Certified Date</th>
                <th>Certify Due Date</th>
                <th>Tag Type</th>
                <th>Tag Num</th>
                <th>Tag Date</th>
                <th>Inspection By</th>
                <th>Inspection Date</th>
                <th>Integration With</th>
                <th>Memo <span class="clr-red">*</span></th>
                <th>Cycles Remaining</th>
                <th>Cycles Since New</th>
                <th>Cycles Since Ovh</th>
                <th>Cycles Since Insp</th>
                <th>Cycles Since Repair</th>
                <th>Time Remaining</th>
                <th>Time Since New</th>
                <th>Time Since Ovh</th>
                <th>Time Since Insp</th>
                <th>Time Since Repair</th>
                <th>Last Since New</th>
                <th>Last Since Ovh</th>
                <th>Last Since Insp</th>
                <th>Is Active</th>
                <th>Created Date</th>
                <th>Created By</th>
                <th>Updated Date</th>
                <th>Updated By</th>                
              </tr>
            </thead>
            <tbody *ngIf="auditHistory.length > 0">
              <tr *ngFor="let audit of auditHistory; let i = index">
                <td class="text-center width-60">
                  <span class="value">
                    <label class="wauto"> 
                      <input type="checkbox" name="isCustomerStock"
                       [(ngModel)]="audit.isCustomerStock" disabled>
                      </label></span>
                    </td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'partNumber', audit.partNumber) ? 'black' : 'red'}">{{ audit.partNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'partDescription', audit.partDescription) ? 'black' : 'red'}">{{ audit.partDescription }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'revisedPart', audit.revisedPart) ? 'black' : 'red'}">{{ audit.revisedPart }}</td>
                <td class="text-center width-60">
                  <span class="value">
                    <label class="wauto">
                       <input type="checkbox" name="oem" [(ngModel)]="audit.oem" disabled>
                      </label></span></td>
                      <td class="text-center width-60">
                        <span class="value">
                          <label class="wauto"> <input type="checkbox" name="isPMA" [(ngModel)]="audit.isPMA" disabled></label></span></td>
                            <td class="text-center width-60">
                              <span class="value">
                                <label class="wauto"> <input type="checkbox" name="isDER" [(ngModel)]="audit.isDER" disabled></label></span></td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'itemGroup', audit.itemGroup) ? 'black' : 'red'}">{{ audit.itemGroup }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'condition', audit.condition) ? 'black' : 'red'}">{{ audit.condition }}</td>
                <td class="text-center width-60">
                  <span class="value">
                    <label class="wauto"> <input type="checkbox" name="isSerialized" [(ngModel)]="audit.isSerialized" disabled></label></span></td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'serialNumber', audit.serialNumber) ? 'black' : 'red'}">{{ audit.serialNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'stockLineNumber', audit.stockLineNumber) ? 'black' : 'red'}">{{ audit.stockLineNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'nationalStockNumber', audit.nationalStockNumber) ? 'black' : 'red'}">{{ audit.nationalStockNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'engineSerialNumber', audit.engineSerialNumber) ? 'black' : 'red'}">{{ audit.engineSerialNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'controlNumber', audit.controlNumber) ? 'black' : 'red'}">{{ audit.controlNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'idNumber', audit.idNumber) ? 'black' : 'red'}">{{ audit.idNumber }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'daysReceived', audit.daysReceived) ? 'black' : 'red'}">{{ audit.daysReceived }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'manufacturingDays', audit.manufacturingDays) ? 'black' : 'red'}">{{ audit.manufacturingDays }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'tagDays', audit.tagDays) ? 'black' : 'red'}">{{ audit.tagDays }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'openDays', audit.openDays) ? 'black' : 'red'}">{{ audit.openDays }}</td>
                <td class="text-center width-60">
                  <span class="value">
                    <label class="wauto"> <input type="checkbox" name="shelfLife" [(ngModel)]="audit.shelfLife" disabled></label></span></td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'shelfLifeExpirationDate', audit.shelfLifeExpirationDate) ? 'black' : 'red'}">{{ audit.shelfLifeExpirationDate |  date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'nha', audit.nha) ? 'black' : 'red'}">{{ audit.nha }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'tla', audit.tla) ? 'black' : 'red'}">{{ audit.tla }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'aircraftTailNumber', audit.aircraftTailNumber) ? 'black' : 'red'}">{{ audit.aircraftTailNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'manufacturer', audit.manufacturer) ? 'black' : 'red'}">{{ audit.manufacturer }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'manufacturerLotNumber', audit.manufacturerLotNumber) ? 'black' : 'red'}">{{ audit.manufacturerLotNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'manufacturingBatchNumber', audit.manufacturingBatchNumber) ? 'black' : 'red'}">{{ audit.manufacturingBatchNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'manufacturingDate', audit.manufacturingDate) ? 'black' : 'red'}">{{ audit.manufacturingDate |  date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'acquistionTypeName', audit.acquistionTypeName) ? 'black' : 'red'}">{{ audit.acquistionTypeName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'orderDate', audit.orderDate) ? 'black' : 'red'}">{{ audit.orderDate |  date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'entryDate', audit.entryDate) ? 'black' : 'red'}">{{ audit.entryDate |  date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'expirationDate', audit.expirationDate) ? 'black' : 'red'}">{{ audit.expirationDate |  date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'vendorName', audit.vendorName) ? 'black' : 'red'}">{{ audit.vendorName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'purchaseOrderNumber', audit.purchaseOrderNumber) ? 'black' : 'red'}">{{ audit.purchaseOrderNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'repairOrderNumber', audit.repairOrderNumber) ? 'black' : 'red'}">{{ audit.repairOrderNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'requestedByName', audit.requestedByName) ? 'black' : 'red'}">{{ audit.requestedByName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'receivedDate', audit.receivedDate) ? 'black' : 'red'}">{{ audit.receivedDate |  date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'receiver', audit.receiver) ? 'black' : 'red'}">{{ audit.receiver }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'reconciliationNumber', audit.reconciliationNumber) ? 'black' : 'red'}">{{ audit.reconciliationNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'workOrderNumber', audit.workOrderNumber) ? 'black' : 'red'}">{{ audit.workOrderNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'obtainFromTypeName', audit.obtainFromTypeName) ? 'black' : 'red'}">{{ audit.obtainFromTypeName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'obtainFromName', audit.obtainFromName) ? 'black' : 'red'}">{{ audit.obtainFromName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'ownerTypeName', audit.ownerTypeName) ? 'black' : 'red'}">{{ audit.ownerTypeName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'ownerName', audit.ownerName) ? 'black' : 'red'}">{{ audit.ownerName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'traceableToTypeName', audit.traceableToTypeName) ? 'black' : 'red'}">{{ audit.traceableToTypeName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'tracableToName', audit.tracableToName) ? 'black' : 'red'}">{{ audit.tracableToName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'exportECCN', audit.exportECCN) ? 'black' : 'red'}">{{ audit.exportECCN }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'itarNumber', audit.itarNumber) ? 'black' : 'red'}">{{ audit.itarNumber }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'quantityOnHand', audit.quantityOnHand) ? 'black' : 'red'}">{{ audit.quantityOnHand }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'quantityReserved', audit.quantityReserved) ? 'black' : 'red'}">{{ audit.quantityReserved }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'quantityIssued', audit.quantityIssued) ? 'black' : 'red'}">{{ audit.quantityIssued }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'quantityAvailable', audit.quantityAvailable) ? 'black' : 'red'}">{{ audit.quantityAvailable }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'purchaseOrderUnitCost', audit.purchaseOrderUnitCost) ? 'black' : 'red'}">{{ audit.purchaseOrderUnitCost }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'repairOrderUnitCost', audit.repairOrderUnitCost) ? 'black' : 'red'}">{{ audit.repairOrderUnitCost }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'unitSalesPrice', audit.unitSalesPrice) ? 'black' : 'red'}">{{ audit.unitSalesPrice }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'coreUnitCost', audit.coreUnitCost) ? 'black' : 'red'}">{{ audit.coreUnitCost }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'glAccountName', audit.glAccountName) ? 'black' : 'red'}">{{ audit.glAccountName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'siteName', audit.siteName) ? 'black' : 'red'}">{{ audit.siteName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'warehouse', audit.warehouse) ? 'black' : 'red'}">{{ audit.warehouse }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'location', audit.location) ? 'black' : 'red'}">{{ audit.location }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'shelfName', audit.shelfName) ? 'black' : 'red'}">{{ audit.shelfName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'binName', audit.binName) ? 'black' : 'red'}">{{ audit.binName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'lotNum', audit.lotNum) ? 'black' : 'red'}">{{ audit.lotNum }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'lotDescription', audit.lotDescription) ? 'black' : 'red'}">{{ audit.lotDescription }}</td>
                <td class="text-right" [ngStyle]="{color: getColorCodeForHistory(i, 'lotCost', audit.lotCost) ? 'black' : 'red'}">{{ audit.lotCost }}</td>
                <td class="text-center width-60">
                  <span class="value">
                    <label class="wauto"> <input type="checkbox" name="blackListed" [(ngModel)]="audit.blackListed" disabled></label></span></td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'blackListedReason', audit.blackListedReason) ? 'black' : 'red'}">
                    <p [innerHTML]="audit.blackListedReason"></p>    
                </td>
                <td class="text-center width-60">
                  <span class="value">
                    <label class="wauto"> <input type="checkbox" name="accident" [(ngModel)]="audit.accident" disabled></label></span></td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'accidentReason', audit.accidentReason) ? 'black' : 'red'}">
                    <p [innerHTML]="audit.accidentReason"></p>    
                </td>
                <td class="text-center width-60">
                  <span class="value">
                    <label class="wauto"> <input type="checkbox" name="incident" [(ngModel)]="audit.incident" disabled></label></span></td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'incidentReason', audit.incidentReason) ? 'black' : 'red'}">
                    <p [innerHTML]="audit.incidentReason"></p>    
                </td>
                <td class="min-w-100" [ngStyle]="{color: getColorCodeForHistory(i, 'companyName', audit.companyName) ? 'black' : 'red'}">{{ audit.companyName }}</td>
                <td class="min-w-100" [ngStyle]="{color: getColorCodeForHistory(i, 'buName', audit.buName) ? 'black' : 'red'}">{{ audit.buName }}</td>
                <td class="min-w-100" [ngStyle]="{color: getColorCodeForHistory(i, 'divName', audit.divName) ? 'black' : 'red'}">{{ audit.divName }}</td>
                <td class="min-w-100" [ngStyle]="{color: getColorCodeForHistory(i, 'deptName', audit.deptName) ? 'black' : 'red'}">{{ audit.deptName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'partCertificationNumber', audit.partCertificationNumber) ? 'black' : 'red'}">{{ audit.partCertificationNumber }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'certifiedByName', audit.certifiedByName) ? 'black' : 'red'}">{{ audit.certifiedByName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'certifiedDate', audit.certifiedDate) ? 'black' : 'red'}">{{ audit.certifiedDate |  date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'certifiedDueDate', audit.certifiedDueDate) ? 'black' : 'red'}">{{ audit.certifiedDueDate |  date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'tagTypeName', audit.tagTypeName) ? 'black' : 'red'}">{{ audit.tagTypeName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'tagNum', audit.tagNum) ? 'black' : 'red'}">{{ audit.tagNum }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'tagDate', audit.tagDate) ? 'black' : 'red'}">{{ audit.tagDate |  date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'inspectionByName', audit.inspectionByName) ? 'black' : 'red'}">{{ audit.inspectionByName }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'inspectionDate', audit.inspectionDate) ? 'black' : 'red'}">{{ audit.inspectionDate |  date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'integrationPortal', audit.integrationPortal) ? 'black' : 'red'}">{{ audit.integrationPortal }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'memo', audit.memo) ? 'black' : 'red'}">
                    <p [innerHTML]="audit.memo"></p>
                </td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'cyclesRemaining', audit.cyclesRemaining) ? 'black' : 'red'}">{{ audit.cyclesRemaining }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'cyclesSinceNew', audit.cyclesSinceNew) ? 'black' : 'red'}">{{ audit.cyclesSinceNew }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'cyclesSinceOVH', audit.cyclesSinceOVH) ? 'black' : 'red'}">{{ audit.cyclesSinceOVH }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'cyclesSinceInspection', audit.cyclesSinceInspection) ? 'black' : 'red'}">{{ audit.cyclesSinceInspection }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'cyclesSinceRepair', audit.cyclesSinceRepair) ? 'black' : 'red'}">{{ audit.cyclesSinceRepair }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'timeRemaining', audit.timeRemaining) ? 'black' : 'red'}">{{ audit.timeRemaining }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'timeSinceNew', audit.timeSinceNew) ? 'black' : 'red'}">{{ audit.timeSinceNew }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'timeSinceOVH', audit.timeSinceOVH) ? 'black' : 'red'}">{{ audit.timeSinceOVH }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'timeSinceInspection', audit.timeSinceInspection) ? 'black' : 'red'}">{{ audit.timeSinceInspection }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'timeSinceRepair', audit.timeSinceRepair) ? 'black' : 'red'}">{{ audit.timeSinceRepair }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'lastSinceNew', audit.lastSinceNew) ? 'black' : 'red'}">{{ audit.lastSinceNew }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'lastSinceOVH', audit.lastSinceOVH) ? 'black' : 'red'}">{{ audit.lastSinceOVH }}</td>
                <td [ngStyle]="{color: getColorCodeForHistory(i, 'lastSinceInspection', audit.lastSinceInspection) ? 'black' : 'red'}">{{ audit.lastSinceInspection }}</td>
                <td class="text-center width-60">
                  <span class="value">
                    <label class="wauto"> <input type="checkbox" name="isActive" [(ngModel)]="audit.isActive" disabled></label></span></td>
                
                <td>{{ audit.createdDate | date: 'MM/dd/yyyy h:mm a' }}</td>
                <td>{{ audit.createdBy }}</td>                
                <td>{{ audit.updatedDate | date: 'MM/dd/yyyy h:mm a' }}</td>
                <td>{{ audit.updatedBy }}</td>
              </tr>
            </tbody>
          </table>
          </div>
          <ng-template #noDatavailable>
            <div class="text-center">
              <h4 style="color: #ff5663;">No History Found</h4>
            </div>
          </ng-template>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<div id="stockAdjAudit" class="modal fade" role="dialog" data-backdrop="static"
  data-keyboard="false">
  <div class="modal-dialog modal-xl">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close"  (click)="dismissStockAdjAudit()">
          &times;
        </button>
        <h4 class="modal-title">History of Stockline Adjustment</h4>
      </div>
      <div class="modal-body">
        <div class="table-responsive pas-table-cstm poro-table-cstm parts-list-table-align">
					<div class="tableFixHead">
						<table class="table table-bordered header-table-width" *ngIf="adjAuditHistoryList.length > 0; else noDatavailable">
            <thead>
              <tr>
                <th>Adjustment Data Type</th>
                <th>Changed From</th>
                <th>Changed To</th>
                <th>Adjustment Reason</th>
                <th>Adjustment Memo</th>
                <th>Currency</th>   
                <th>Created Date</th>             
                <th>Created By</th>
                <th>Updated Date</th>
                <th>Updated By</th>               
                <!-- <th>Action</th> -->
              </tr>
            </thead>
            <tbody *ngIf="adjAuditHistoryList.length > 0">
              <tr *ngFor="let audit of adjAuditHistoryList; let i = index">
                <td [ngStyle]="{color: getColorCodeForStockLineAdjHistory(i, 'adjustmentDataType', audit.adjustmentDataType) ? 'black' : 'red'}">{{ audit.adjustmentDataType }}</td>
                <td [ngClass]="audit.auditRightAlign ? 'text-right' : ''" [ngStyle]="{color: getColorCodeForStockLineAdjHistory(i, 'changedFrom', audit.changedFrom) ? 'black' : 'red'}">{{ audit.changedFrom }}</td>
                <td [ngClass]="audit.auditRightAlign ? 'text-right' : ''" [ngStyle]="{color: getColorCodeForStockLineAdjHistory(i, 'changedTo', audit.changedTo) ? 'black' : 'red'}">{{ audit.changedTo }}</td>
                <td [ngStyle]="{color: getColorCodeForStockLineAdjHistory(i, 'adjustmentReason', audit.adjustmentReason) ? 'black' : 'red'}">{{ audit.adjustmentReason }}</td>
                <td [ngStyle]="{color: getColorCodeForStockLineAdjHistory(i, 'adjustmentMemo', audit.adjustmentMemo) ? 'black' : 'red'}">{{ audit.adjustmentMemo }}</td>
                <td [ngStyle]="{color: getColorCodeForStockLineAdjHistory(i, 'currencyName', audit.currencyName) ? 'black' : 'red'}">{{ audit.currencyName }}</td>
                <td>{{ audit.createdDate | date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForStockLineAdjHistory(i, 'createdBy', audit.createdBy) ? 'black' : 'red'}">{{ audit.createdBy }}</td>
                <td>{{ audit.updatedDate | date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForStockLineAdjHistory(i, 'updatedBy', audit.updatedBy) ? 'black' : 'red'}">{{ audit.updatedBy }}</td>
              </tr>
            </tbody>
          </table>
          </div>
          <ng-template #noDatavailable>
            <div class="text-center">
              <h4 class="no-history-found-msg">No History Found</h4>
            </div>
          </ng-template>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" (click)="dismissStockAdjAudit()">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<div id="stockAdjAuditData" class="modal fade" role="dialog" data-backdrop="static"
  data-keyboard="false">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          &times;
        </button>
        <h4 class="modal-title">History of Stockline Adjustment Data Type</h4>
      </div>
      <div class="modal-body">
        <div class="table-responsive pas-table-cstm poro-table-cstm parts-list-table-align">
					<div class="tableFixHead">
						<table class="table table-bordered header-table-width" *ngIf="adjAuditHistoryData.length > 0; else noDatavailable">
            <thead>
              <tr>
                <th>Adjustment Data Type</th>
                <th>Changed From</th>
                <th>Changed To</th>
                <th>Adjustment Reason</th>
                <th>Adjustment Memo</th>
                <th>Currency</th>
                <th>Created Date</th>
                <th>Created By</th>                
              </tr>
            </thead>
            <tbody *ngIf="adjAuditHistoryData.length > 0">
              <tr *ngFor="let audit of adjAuditHistoryData; let i = index">
                <td [ngStyle]="{color: getColorCodeForAdjAudit(i, 'adjustmentDataType', audit.adjustmentDataType) ? 'black' : 'red'}">{{ audit.adjustmentDataType }}</td>
                <td [ngClass]="audit.auditRightAlign ? 'text-right' : ''" [ngStyle]="{color: getColorCodeForAdjAudit(i, 'changedFrom', audit.changedFrom) ? 'black' : 'red'}">{{ audit.changedFrom }}</td>
                <td [ngClass]="audit.auditRightAlign ? 'text-right' : ''" [ngStyle]="{color: getColorCodeForAdjAudit(i, 'changedTo', audit.changedTo) ? 'black' : 'red'}">{{ audit.changedTo }}</td>
                <td [ngStyle]="{color: getColorCodeForAdjAudit(i, 'adjustmentReason', audit.adjustmentReason) ? 'black' : 'red'}">{{ audit.adjustmentReason }}</td>
                <td [ngStyle]="{color: getColorCodeForAdjAudit(i, 'adjustmentMemo', audit.adjustmentMemo) ? 'black' : 'red'}">{{ audit.adjustmentMemo }}</td>
                <td [ngStyle]="{color: getColorCodeForAdjAudit(i, 'currencyName', audit.currencyName) ? 'black' : 'red'}">{{ audit.currencyName }}</td>
                <td>{{ audit.createdDate | date: 'MM/dd/yyyy h:mm a' }}</td>
                <td [ngStyle]="{color: getColorCodeForAdjAudit(i, 'createdBy', audit.createdBy) ? 'black' : 'red'}">{{ audit.createdBy }}</td>
              </tr>
            </tbody>
          </table>
          </div>
          <ng-template #noDatavailable>
            <div class="text-center">
              <h4 class="no-history-found-msg">No History Found</h4>
            </div>
          </ng-template>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<div class="preloader" *ngIf="isSpinnerVisible">
  <div class="loading">
      <div class="lds-roller"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
  </div>
</div>