<p-breadcrumb [model]="breadcrumbs"></p-breadcrumb>
<div class="card new-card">
    <div class="header">
        <div class="row">
            <div class="col">
                <h4 class="header-name" > {{isEditMode? 'Edit' : ''}} Receive Customer Work</h4>
            </div>
            <div>
                <button type="button" class="btn-sm header-button"
                    [routerLink]="['/receivingmodule/receivingpages/app-customer-works-list']">
                    Receive Customer List
                </button>
            </div>
        </div>
    </div>
    <div class="card-body new-card-body">
        <form #customerWorkForm="ngForm">
            <div class="form-row">
                <div class="col-md-7">
                    <div class="form-row">
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>Receiving Num</label>
                                <input class="form-control" type="text" name="receivingCusNum"
                                    [(ngModel)]="receivingForm.receivingNumber" disabled>
                            </div>
                            <div class="form-group">
                                <label>Received Date <span class="text-danger">*</span></label>
                                <p-calendar class="workflow-clder" [maxDate]="currentDate" [showIcon]="true"
                                    [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"
                                    name="receivedDate" [(ngModel)]="receivingForm.receivedDate"></p-calendar>
                            </div>
                            <div class="form-group">
                                <label>Work Scope <span class="text-danger">*</span></label>
                                <p-dropdown [showClear]="true" class="p-dropdown-100" required
                                    (ngModelChange)="getActive()" (input)="onFilterWorkScope($event.target.value)"
                                    [options]="workScopeList" filter="true" [(ngModel)]="receivingForm.workScopeId"
                                    name="workScopeId" [resetFilterOnHide]="true" placeholder="--Select--"></p-dropdown>
                            </div>
                            <div class="form-group">
                                <label>Customer Request Date <span class="text-danger">*</span></label>
                                <p-calendar class="workflow-clder" [minDate]="receivingForm.receivedDate"
                                    (ngModelChange)="getActive()" [yearNavigator]="true" [monthNavigator]="true"
                                    yearRange="1900:2100" [showIcon]="true" name="custReqDate"
                                    [(ngModel)]="receivingForm.custReqDate" required></p-calendar>
                            </div>
                            <div class="form-group">
                                <label>Customer Ref <span class="text-danger">*</span></label>
                                <input class="form-control" type="text" name="referenceId" (ngModelChange)="getActive()"
                                    [(ngModel)]="receivingForm.reference" #custRef="ngModel" required>
                                <div *ngIf="custRef.invalid && (custRef.dirty || custRef.touched)"
                                    class="alert alert-danger alert-danger-cstm">
                                    <div *ngIf="custRef.errors.required">
                                        <small> Please enter Customer Ref </small>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Employee Name <span class="text-danger">*</span></label>
                                <p-autoComplete field="label" class="pautocomp-cstm" disabled
                                    [(ngModel)]="receivingForm.employeeId" name="employeeId"
                                    (ngModelChange)="getActive()" [suggestions]="allEmployeeList"
                                    (completeMethod)="filterEmployees($event)" [size]="30" [minLength]="1"
                                    [dropdown]="true" errorMessage="Records not found" [forceSelection]="true"
                                    #empName="ngModel" required></p-autoComplete>
                                <div *ngIf="empName.invalid && (empName.dirty || empName.touched)"
                                    class="alert alert-danger alert-danger-cstm">
                                    <div *ngIf="empName.errors.required">
                                        <small> Employee Name is required </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group float-right">
                                <div class="pull-left radio-buttons-align">
                                    <label class="radio-inline">
                                        <input type="radio" value="1" name="assetRadio" class="form-check-inline"
                                            [checked]="receivingForm.isCustomerStock == true"
                                            (change)="getStockStatus(0)">
                                        Rotable Customer Stock
                                    </label>
                                </div>
                                <div class="pull-left radio-buttons-align">
                                    <label class="radio-inline">
                                        <input type="radio" value="2" name="assetRadio" (change)="getStockStatus(1)"
                                            [checked]="receivingForm.isCustomerStock == false">
                                        Piece Parts
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Customer Name <span class="text-danger">*</span></label>
                                <p-autoComplete field="name" class="pautocomp-cstm" [disabled]="isEditCustomerWork"
                                    (ngModelChange)="getActive()" [(ngModel)]="receivingForm.customerId"
                                    name="customerId" (keyup)="getCustomers($event.target.value, 1)"
                                    [suggestions]="customerNamesInfo" (completeMethod)="filterCustNames($event)"
                                    [size]="30" [minLength]="1" [dropdown]="true" errorMessage="Records not found"
                                    [forceSelection]="true" (onSelect)="onSelectCustomer(receivingForm.customerId)"
                                    #custName="ngModel" required></p-autoComplete>
                                <div *ngIf="custName.invalid && (custName.dirty || custName.touched)"
                                    class="alert alert-danger alert-danger-cstm">
                                    <div *ngIf="custName.errors.required">
                                        <small> Customer Name is required </small>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Customer Code <span class="text-danger">*</span></label>
                                <input type="text" class="form-control" disabled name="customerCode"
                                    (ngModelChange)="getActive()" [(ngModel)]="receivingForm.customerCode"
                                    [value]="receivingForm.customerCode">
                            </div>
                            <div class="form-group">
                                <label>Contact <span class="text-danger">*</span></label>
                                <p-autoComplete (onSelect)="onSelectCustomerContact(receivingForm.customerContactId)"
                                    field="customerContact" class="pautocomp-cstm" (ngModelChange)="getActive()"
                                    [(ngModel)]="receivingForm.customerContactId" name="customerContactId"
                                    [suggestions]="customerContactInfo" (completeMethod)="filterCustContacts($event)"
                                    [size]="30" [minLength]="1" [dropdown]="true" errorMessage="Records not found"
                                    [forceSelection]="true" [disabled]="custName.invalid" #cusContact="ngModel"
                                    required></p-autoComplete>
                                <div *ngIf="cusContact.invalid && (cusContact.dirty || cusContact.touched)"
                                    class="alert alert-danger alert-danger-cstm">
                                    <div *ngIf="cusContact.errors.required">
                                        <small> Contact is required </small>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Contact Phone <span class="text-danger">*</span></label>
                                <p-autoComplete field="workPhone" class="pautocomp-cstm"
                                    (onSelect)="onSelectCustomerContactPhone(receivingForm.customerPhone)"
                                    [(ngModel)]="receivingForm.customerPhone" name="customerPhone"
                                    (ngModelChange)="getActive()" [suggestions]="customerPhoneInfo"
                                    (completeMethod)="filterCustContactPhone($event)" [size]="30" [minLength]="1"
                                    [dropdown]="true" errorMessage="Records not found" [forceSelection]="true"
                                    [disabled]="custName.invalid" #cusPhone="ngModel" required>
                                </p-autoComplete>
                                <div *ngIf="cusPhone.invalid && (cusPhone.dirty || cusPhone.touched)"
                                    class="alert alert-danger alert-danger-cstm">
                                    <div *ngIf="cusPhone.errors.required">
                                        <small> Contact Phone is required </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>PN <span class="text-danger">*</span></label>
                                <p-autoComplete field="label" class="pautocomp-cstm"
                                    [(ngModel)]="receivingForm.itemMasterId" name="partNumber"
                                    (ngModelChange)="getActive()" [suggestions]="partNumbersInfo"
                                    (completeMethod)="filterPartNumbers($event)" [size]="30" [minLength]="1"
                                    [dropdown]="true" (keyup)="loadPartNumData($event.target.value)"
                                    (onSelect)="onPartNumberSelected(receivingForm.itemMasterId,'html'); resetSerialNoTimeLife();"
                                    #partNum="ngModel" errorMessage="Records not found" [forceSelection]="true"
                                    required></p-autoComplete>
                                <div *ngIf="partNum.invalid && (partNum.dirty || partNum.touched)"
                                    class="alert alert-danger alert-danger-cstm">
                                    <div *ngIf="partNum.errors.required">
                                        <small> Part Number is required </small>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>PN Description</label>
                                <input class="form-control" type="text" name="partDescription"
                                    [(ngModel)]="receivingForm.partDescription" disabled>
                            </div>
                            <div class="form-group">
                                <label>Revised PN</label>
                                <input class="form-control" type="text" name="revisedPart"
                                    [(ngModel)]="receivingForm.revisedPart" disabled>
                            </div>
                            <div class="form-group">
                                <label>Item Group</label>
                                <input class="form-control" disabled type="text" name="itemGroup"
                                    [(ngModel)]="receivingForm.itemGroup">
                            </div>
                            <div class="form-group">
                                <label>Manufacturer</label>
                                <input class="form-control" type="text" name="manufacturer"
                                    [(ngModel)]="receivingForm.manufacturer" disabled>
                            </div>
                            <div class="form-group">
                                <label>QTY</label>
                                <input class="form-control" type="number" name="quantity"
                                    [(ngModel)]="receivingForm.quantity" disabled>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <label>Condition <span class="text-danger">*</span></label>
                                <select class="form-control" name="conditionId" [(ngModel)]="receivingForm.conditionId"
                                    (ngModelChange)="getActive()" (change)="onSelectCondition()" required>
                                    <option value="0">-- Select --</option>
                                    <option *ngFor="let condition of allConditionInfo"
                                        [ngValue]="condition.conditionId">
                                        {{condition.description}}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>
                                    Site <span class="text-danger">*</span>
                                </label>
                                <select [(ngModel)]="receivingForm.siteId" name="siteId" (ngModelChange)="getActive()"
                                    (change)="siteValueChange(receivingForm.siteId)" required>
                                    <option value="0">-- Select --</option>
                                    <option *ngFor="let site of allSites" [ngValue]="site.siteId">{{site.name}}</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Warehouse</label>
                                <select [(ngModel)]="receivingForm.warehouseId" name="warehouseId"
                                    (ngModelChange)="getActive()"
                                    (change)="wareHouseValueChange(receivingForm.warehouseId)">
                                    <option value="0">-- Select --</option>
                                    <option *ngFor="let site of allWareHouses" [ngValue]="site.warehouseId">
                                        {{site.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Location</label>
                                <select [(ngModel)]="receivingForm.locationId" name="locationId"
                                    (ngModelChange)="getActive()"
                                    (change)="locationValueChange(receivingForm.locationId)">
                                    <option value="0">-- Select --</option>
                                    <option *ngFor="let site of allLocations" [ngValue]="site.locationId">
                                        {{site.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Shelf</label>
                                <select [(ngModel)]="receivingForm.shelfId" name="shelfId" (ngModelChange)="getActive()"
                                    (change)="shelfValueChange(receivingForm.shelfId)">
                                    <option value="0">-- Select --</option>
                                    <option *ngFor="let site of allShelfs" [ngValue]="site.shelfId">
                                        {{site.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Bin</label>
                                <select [(ngModel)]="receivingForm.binId" name="binId" (ngModelChange)="getActive()">
                                    <option value="0">-- Select --</option>
                                    <option *ngFor="let site of allBins" [ngValue]="site.binId">{{site.name}}</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div [ngClass]="receivingForm.isTimeLife ? 'card card-timelife' : ''">
                            <div [ngClass]="receivingForm.isTimeLife ? 'card-body' : ''">
                                <div class="form-row">
                                    <div class="col-md-3">
                                        <div class="form-group">
                                            <div class="checkbox-cstm m-t-15">
                                                <label>
                                                    <input type="checkbox" name="isSerialized"
                                                        (ngModelChange)="getActive()"
                                                        [(ngModel)]="receivingForm.isSerialized">
                                                    <span class="cr">
                                                        <i class="cr-icon pi pi-check"></i>
                                                    </span>
                                                    Is Serialized
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3" *ngIf="receivingForm.isSerialized">
                                        <div class="form-group">
                                            <div class="checkbox-cstm m-t-15">
                                                <label>
                                                    <input type="checkbox" name="isSkipSerialNo"
                                                        (ngModelChange)="getActive()"
                                                        [(ngModel)]="receivingForm.isSkipSerialNo"
                                                        (change)="resetSerialNo()">
                                                    <span class="cr">
                                                        <i class="cr-icon pi pi-check">
                                                        </i>
                                                    </span>
                                                    Serial Number  not provided
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3" *ngIf="receivingForm.isSerialized">
                                        <div class="form-group" *ngIf="!receivingForm.isSkipSerialNo">
                                            <label>
                                                Serial Number <span *ngIf="receivingForm.isSerialized"
                                                    class="text-danger">*</span>
                                            </label>
                                            <input class="form-control" type="text" name="serialNumber"
                                                [(ngModel)]="receivingForm.serialNumber" (ngModelChange)="getActive()"
                                                [required]="receivingForm.isSerialized">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div [ngClass]="receivingForm.isTimeLife ? 'card card-timelife' : ''">
                            <div [ngClass]="receivingForm.isTimeLife ? 'card-body' : ''">
                                <div class="form-row">
                                    <div class="col-md-2">
                                        <div class="form-group">
                                            <div class="checkbox-cstm m-t-15">
                                                <label>
                                                    <input type="checkbox" name="isTimeLife"
                                                        [(ngModel)]="receivingForm.isTimeLife" disabled>
                                                    <span class="cr disabled_color">
                                                        <i class="cr-icon pi pi-check"></i>
                                                    </span>
                                                    Time Life
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4" *ngIf="receivingForm.isTimeLife">
                                        <div class="form-group">
                                            <div class="checkbox-cstm m-t-15">
                                                <label>
                                                    <input type="checkbox" name="isSkipTimeLife"
                                                        (ngModelChange)="getActive()"
                                                        [(ngModel)]="receivingForm.isSkipTimeLife"
                                                        (change)="resetTimelife()">
                                                    <span class="cr">
                                                        <i class="cr-icon pi pi-check">
                                                        </i>
                                                    </span>
                                                    Time Life info not provided
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3" *ngIf="receivingForm.isTimeLife">
                                        <div class="form-group" *ngIf="!receivingForm.isSkipTimeLife">
                                            <label>
                                                Date <span *ngIf="receivingForm.isTimeLife" class="text-danger">*</span>
                                            </label>
                                            <p-calendar class="workflow-clder" [showIcon]="true" name="timeLifeDate"
                                                [(ngModel)]="receivingForm.timeLifeDate" (ngModelChange)="getActive()"
                                                [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"
                                                [required]="receivingForm.isTimeLife"></p-calendar>
                                        </div>
                                    </div>
                                    <div class="col-md-3" *ngIf="receivingForm.isTimeLife">
                                        <div class="form-group" *ngIf="!receivingForm.isSkipTimeLife">
                                            <label>
                                                Origin <span *ngIf="receivingForm.isTimeLife"
                                                    class="text-danger">*</span>
                                            </label>
                                            <input class="form-control" type="text" name="timeLifeOrigin"
                                                [(ngModel)]="receivingForm.timeLifeOrigin" (ngModelChange)="getActive()"
                                                [required]="receivingForm.isTimeLife">
                                        </div>
                                    </div>
                                </div>
                                <div class="form-row" *ngIf="receivingForm.isTimeLife">
                                    <div class="table-responsive form-group time-life-padding"
                                        *ngIf="!receivingForm.isSkipTimeLife">
                                        <table class="table table-bordered">
                                            <thead>
                                                <tr>
                                                    <th colspan="15" class="text-center">
                                                        <strong>Time Life Info</strong>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <th></th>
                                                    <th class="text-center">Cycles (Hrs)</th>
                                                    <th class="text-center">Time (Hrs)</th>
                                                    <th class="text-center">Last (Hrs)</th>
                                                </tr>
                                                <tr>
                                                    <td>Remaining</td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="cyclesRemaining" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.cyclesRemaining">
                                                    </td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="timeRemaining" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.timeRemaining">
                                                    </td>
                                                    <td></td>
                                                </tr>
                                                <tr>
                                                    <td>Since New</td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="cyclesSinceNew" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.cyclesSinceNew">
                                                    </td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="timeSinceNew" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.timeSinceNew">
                                                    </td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="lastSinceNew" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.lastSinceNew">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Since Ovh</td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="cyclesSinceOVH" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.cyclesSinceOVH">
                                                    </td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="timeSinceOVH" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.timeSinceOVH">
                                                    </td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="lastSinceOVH" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.lastSinceOVH">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Since Insp</td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="cyclesSinceInspection" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.cyclesSinceInspection">
                                                    </td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="timeSinceInspection" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.timeSinceInspection">
                                                    </td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="lastSinceInspection" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.lastSinceInspection">
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td>Since Repair</td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="cyclesSinceRepair" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.cyclesSinceRepair">
                                                    </td>
                                                    <td class="clr2 text-center">
                                                        <input type="number" (keypress)="restrictMinus($event)"
                                                            class="w60 form-control" placeholder="hours"
                                                            name="timeSinceRepair" (ngModelChange)="getActive()"
                                                            [(ngModel)]="sourceTimeLife.timeSinceRepair">
                                                    </td>
                                                    <td></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-5">
                    <div class="form-row">
                        <div class="col-md-4">
                            <div class="form-group">
                                <label>Parts Cert Num</label>
                                <input class="form-control" type="text" name="partCertificationNumber"
                                    (ngModelChange)="getActive()" [(ngModel)]="receivingForm.partCertificationNumber">
                            </div>
                            <div class="form-group">
                                <label>
                                    Inspected By
                                </label>
                                <p-dropdown class="p-dropdown-100" [showClear]="true"
                                    [options]="certifiedEmployeeList"
                                    placeholder="Select" filter="true"                                                
                                    name="certifiedById" [resetFilterOnHide]="true"
                                    [(ngModel)]="receivingForm.certifiedById"
                                    (ngModelChange)="getActive()">             
                                </p-dropdown>
                            </div>     
                            <div class="form-group">
                                <label> Inspected Date</label>
                                <p-calendar class="workflow-clder" [showIcon]="true" name="certifiedDate"
                                    (ngModelChange)="getActive()" [yearNavigator]="true" [monthNavigator]="true"
                                    yearRange="1900:2100" [(ngModel)]="receivingForm.certifiedDate"></p-calendar>
                            </div>                       
                            <div class="form-group">
                                <label>Tag Date</label>
                                <p-calendar class="workflow-clder" [showIcon]="true" name="tagDate"
                                    (ngModelChange)="getActive()" [yearNavigator]="true" [monthNavigator]="true"
                                    yearRange="1900:2100" [(ngModel)]="receivingForm.tagDate"></p-calendar>
                            </div>
                            <div class="form-group">
                                <label>Tag Type</label>
                                <p-multiSelect [options]="allTagTypes" (input)="onFilterTangible($event)"
                                    (ngModelChange)="getActive()" [(ngModel)]="receivingForm.tagType" name="tagType">
                                </p-multiSelect>
                            </div>
                            <div class="form-group">
                                <label>MFG Trace</label>
                                <input class="form-control" type="text" name="MFGTrace" (ngModelChange)="getActive()"
                                    [(ngModel)]="receivingForm.mfgTrace">
                            </div>
                            <div class="form-group">
                                <label>MFG Lot</label>
                                <input class="form-control" type="text" name="MFGLotNo" (ngModelChange)="getActive()"
                                    [(ngModel)]="receivingForm.mfgLotNo">
                            </div>
                            <div class="form-group">
                                <div class="checkbox-cstm m-t-20">
                                    <label>
                                        <input type="checkbox" name="isMFGDate" [(ngModel)]="receivingForm.isMFGDate"
                                            (ngModelChange)="getActive()">
                                        <span class="cr"><i class="cr-icon pi pi-check"></i></span>
                                        MFG Date <span class="text-danger" *ngIf="receivingForm.isMFGDate">*</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group" *ngIf="receivingForm.isMFGDate">
                                <p-calendar class="workflow-clder" [showIcon]="true" [yearNavigator]="true"
                                    [monthNavigator]="true" yearRange="1900:2100" (ngModelChange)="getActive()"
                                    [required]="receivingForm.isMFGDate" [maxDate]="currentDate"
                                    name="manufacturingDate" [(ngModel)]="receivingForm.mfgDate"></p-calendar>
                            </div>
                            <div class="form-group">
                                <div class="checkbox-cstm m-t-10">
                                    <label>
                                        <input type="checkbox" name="isExpDate" [(ngModel)]="receivingForm.isExpDate"
                                            (ngModelChange)="getActive()">
                                        <span class="cr"><i class="cr-icon pi pi-check"></i></span>
                                        Exp Date <span class="text-danger" *ngIf="receivingForm.isExpDate">*</span>
                                    </label>
                                </div>
                            </div>
                            <div class="form-group" *ngIf="receivingForm.isExpDate">
                                <p-calendar class="workflow-clder" [showIcon]="true" (ngModelChange)="getActive()"
                                    [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"
                                    [required]="receivingForm.isExpDate" [minDate]="currentDate" name="expDate"
                                    [(ngModel)]="receivingForm.expDate"></p-calendar>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group margin-bottom-8">
                                <label>Obtain From </label>
                                <!-- <label>Obtain From <span class="text-danger">*</span> </label> -->
                                <select [(ngModel)]="receivingForm.obtainFromTypeId" (ngModelChange)="getActive()"
                                    name="obtainFromTypeId"
                                    (change)="onSelectObrainFrom(receivingForm.obtainFromTypeId)" >
                                    <option value="0">-- Select --</option>
                                    <option *ngFor="let item of moduleListDropdown" [ngValue]="item.moduleId">
                                        {{item.moduleName}}</option>
                                </select>
                            </div>
                            <div class="form-group margin-bottom-8">
                                <div class="form-row" *ngIf="receivingForm.obtainFromTypeId == 1">
                                    <div class="col-sm-12">
                                        <label>
                                            Customer 
                                        </label>
                                        <!-- [required]="receivingForm.obtainFromTypeId == 1" -->
                                        <p-autoComplete field="name" class="pautocomp-cstm"
                                            (ngModelChange)="getActive()"                                            
                                            (keyup)="getCustomers($event.target.value, 2)"
                                            [(ngModel)]="receivingForm.obtainFrom" name="obtainFromCustomer"
                                            [suggestions]="customersList" (completeMethod)="filterCustomerNames($event)"
                                            [size]="30" [minLength]="1" [dropdown]="true"
                                            errorMessage="Records not found" [forceSelection]="true"></p-autoComplete>
                                    </div>
                                </div>
                                <div class="form-row" *ngIf="receivingForm.obtainFromTypeId == 2">
                                    <div class="col-sm-12">
                                        <label>
                                            Vendor 
                                        </label>
                                        <!-- [required]="receivingForm.obtainFromTypeId == 2" -->
                                        <p-autoComplete field="label" class="pautocomp-cstm"
                                            (ngModelChange)="getActive()"                                           
                                            [(ngModel)]="receivingForm.obtainFrom" name="obtainFromVendor"
                                            [suggestions]="vendorsList" (completeMethod)="filterVendorNames($event)"
                                            [size]="30" [minLength]="1" [dropdown]="true"
                                            errorMessage="Records not found" [forceSelection]="true">
                                        </p-autoComplete>
                                    </div>
                                </div>
                                <div class="form-row" *ngIf="receivingForm.obtainFromTypeId == 9">
                                    <div class="col-sm-12">
                                        <label>Company </label>
                                        <!-- [required]="receivingForm.obtainFromTypeId == 9" -->
                                        <p-autoComplete field="label" class="pautocomp-cstm"
                                            (ngModelChange)="getActive()" [(ngModel)]="receivingForm.obtainFrom"
                                            name="obtainFromCompany" [suggestions]="companyList"
                                            (completeMethod)="filterCompanyNames($event)" [size]="30" [minLength]="1"
                                            [dropdown]="true" errorMessage="Records not found"
                                             [forceSelection]="true">
                                        </p-autoComplete>
                                    </div>
                                </div>
                                <div class="form-row" *ngIf="receivingForm.obtainFromTypeId == 4">
                                    <div class="col-sm-12">
                                        <label>Other </label>
                                        <!-- [required]="receivingForm.obtainFromTypeId == 4" -->
                                        <input class="form-control" type="text" name="obtainFromOther"
                                            (ngModelChange)="getActive()"                                            
                                            [(ngModel)]="receivingForm.obtainFromName">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group margin-bottom-8">
                                <label>Owner </label>
                                <select [(ngModel)]="receivingForm.ownerTypeId" name="ownerType"
                                    (ngModelChange)="getActive()" (change)="onSelectOwner(receivingForm.ownerTypeId)"
                                    >
                                    <option value="0">-- Select --</option>
                                    <option *ngFor="let item of moduleListDropdown" [ngValue]="item.moduleId">
                                        {{item.moduleName}}</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <div class="form-row" *ngIf="receivingForm.ownerTypeId == 1">
                                    <div class="col-sm-12">
                                        <label>
                                            Customer 
                                        </label>
                                        <p-autoComplete field="name" class="pautocomp-cstm"
                                            (ngModelChange)="getActive()"
                                            [(ngModel)]="receivingForm.owner" name="ownerCustomer"
                                            (keyup)="getCustomers($event.target.value, 2)" [suggestions]="customersList"
                                            (completeMethod)="filterCustomerNames($event)" [size]="30" [minLength]="1"
                                            [dropdown]="true" errorMessage="Records not found" [forceSelection]="true">
                                        </p-autoComplete>
                                    </div>
                                </div>
                                <div class="form-row" *ngIf="receivingForm.ownerTypeId == 2">
                                    <div class="col-sm-12">
                                        <label>
                                            Vendor 
                                        </label>
                                        <!-- [required]="receivingForm.ownerTypeId == 2" -->
                                        <p-autoComplete field="label" class="pautocomp-cstm"
                                            (ngModelChange)="getActive()" 
                                            [(ngModel)]="receivingForm.owner" name="ownerVendor"
                                            [suggestions]="vendorsList" (completeMethod)="filterVendorNames($event)"
                                            [size]="30" [minLength]="1" [dropdown]="true"
                                            errorMessage="Records not found" [forceSelection]="true">
                                        </p-autoComplete>
                                    </div>
                                </div>
                                <div class="form-row" *ngIf="receivingForm.ownerTypeId == 9">
                                    <div class="col-sm-12">
                                        <label>Company </label>
                                        <!-- [required]="receivingForm.ownerTypeId == 9"  -->
                                        <p-autoComplete field="label" class="pautocomp-cstm"
                                            (ngModelChange)="getActive()" [(ngModel)]="receivingForm.owner"
                                            name="ownerCompany" [suggestions]="companyList"
                                            (completeMethod)="filterCompanyNames($event)" [size]="30" [minLength]="1"
                                            [dropdown]="true" errorMessage="Records not found"
                                            [forceSelection]="true">
                                        </p-autoComplete>
                                    </div>
                                </div>
                                <div class="form-row" *ngIf="receivingForm.ownerTypeId == 4">
                                    <div class="col-sm-12">
                                        <label>Other </label>
                                        <!-- [required]="receivingForm.ownerTypeId == 4" -->
                                        <input class="form-control" type="text" name="ownerOther"
                                            (ngModelChange)="getActive()" 
                                            [(ngModel)]="receivingForm.ownerName">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Traceble To </label>
                                <select [(ngModel)]="receivingForm.traceableToTypeId" name="traceableToType"
                                    (ngModelChange)="getActive()"
                                    (change)="onSelectTraceableTo(receivingForm.traceableToTypeId)" >
                                    <option value="0">-- Select --</option>
                                    <option *ngFor="let item of moduleListDropdown" [ngValue]="item.moduleId">
                                        {{item.moduleName}}</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <div class="form-row" *ngIf="receivingForm.traceableToTypeId == 1">
                                    <div class="col-sm-12">
                                        <label>
                                            Add Customer 
                                        </label>
                                        <!-- [required]="receivingForm.traceableToTypeId == 1" -->
                                        <p-autoComplete field="name" class="pautocomp-cstm"
                                            (ngModelChange)="getActive()"                                            
                                            (keyup)="getCustomers($event.target.value, 2)"
                                            [(ngModel)]="receivingForm.traceableTo" name="traceableToCustomer"
                                            [suggestions]="customersList" (completeMethod)="filterCustomerNames($event)"
                                            [size]="30" [minLength]="1" [dropdown]="true"
                                            errorMessage="Records not found" [forceSelection]="true"></p-autoComplete>
                                    </div>
                                </div>
                                <div class="form-row" *ngIf="receivingForm.traceableToTypeId == 2">
                                    <div class="col-sm-12">
                                        <label>
                                            Add Vendor 
                                        </label>
                                        <!-- [required]="receivingForm.traceableToTypeId == 2" -->
                                        <p-autoComplete field="label" class="pautocomp-cstm"
                                            (ngModelChange)="getActive()"                                            
                                            [(ngModel)]="receivingForm.traceableTo" name="traceableToVendor"
                                            [suggestions]="vendorsList" (completeMethod)="filterVendorNames($event)"
                                            [size]="30" [minLength]="1" [dropdown]="true"
                                            errorMessage="Records not found" [forceSelection]="true">
                                        </p-autoComplete>
                                    </div>
                                </div>
                                <div class="form-row" *ngIf="receivingForm.traceableToTypeId == 9">
                                    <div class="col-sm-12">
                                        <label> Add Company </label>
                                        <!-- [required]="receivingForm.traceableToTypeId == 9" -->
                                        <p-autoComplete field="label" class="pautocomp-cstm"
                                            (ngModelChange)="getActive()" [(ngModel)]="receivingForm.traceableTo"
                                            name="traceableToCompany" [suggestions]="companyList"
                                            (completeMethod)="filterCompanyNames($event)" [size]="30" [minLength]="1"
                                            [dropdown]="true" errorMessage="Records not found" [forceSelection]="true">
                                        </p-autoComplete>
                                    </div>
                                </div>
                                <div class="form-row" *ngIf="receivingForm.traceableToTypeId == 4">
                                    <div class="col-sm-12">
                                        <label> Add Other </label>
                                        <!-- [required]="receivingForm.traceableToTypeId == 4" -->
                                        <input class="form-control" type="text" name="traceableToOther"
                                            (ngModelChange)="getActive()"
                                            [(ngModel)]="receivingForm.tracableToName">
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        <div class="col-md-4 main_facture">
                            <div class="card mgmt-card">
                                <div class="card-header mgmt-card-header">
                                    <h5 class="mgmt-header">
                                        Management Structure <span class="text-danger">*</span>
                                    </h5>
                                </div>
                                <div class="card-body mgmt-card-body">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <p-dropdown [showClear]="true" class="p-dropdown-100"
                                                (onChange)="selectedLegalEntity(managementStructure.companyId,'html');"
                                                required (ngModelChange)="getActive()" [options]="legalEntityList"
                                                filter="true" [(ngModel)]="managementStructure.companyId"
                                                name="companyId" [resetFilterOnHide]="true" placeholder="Select">
                                            </p-dropdown>
                                        </div>
                                        <div class="form-group">
                                            <p-dropdown [showClear]="true" class="p-dropdown-100"
                                                (onChange)="selectedBusinessUnit(managementStructure.buId,'html')"
                                                (ngModelChange)="getActive()" [options]="businessUnitList" filter="true"
                                                [(ngModel)]="managementStructure.buId" name="buId"
                                                [resetFilterOnHide]="true" placeholder="Select"></p-dropdown>
                                        </div>
                                        <div class="form-group">
                                            <p-dropdown [showClear]="true" class="p-dropdown-100"
                                                (onChange)="selectedDivision(managementStructure.divisionId,'html')"
                                                (ngModelChange)="getActive()" [options]="divisionList" filter="true"
                                                [(ngModel)]="managementStructure.divisionId" name="divisionId"
                                                [resetFilterOnHide]="true" placeholder="Select"></p-dropdown>
                                        </div>
                                        <div class="form-group">
                                            <p-dropdown [showClear]="true" class="p-dropdown-100"
                                                (onChange)="selectedDepartment(managementStructure.departmentId,'html' )"
                                                (ngModelChange)="getActive()" [options]="departmentList" filter="true"
                                                [(ngModel)]="managementStructure.departmentId" name="departmentId"
                                                [resetFilterOnHide]="true" placeholder="Select"></p-dropdown>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div>
                               <span class="label input-width-100-percent">Memo
                                    <span>
                                        <a style="margin-left: 5px;" class="nobg"  (click)="onClickMemo()" matTooltip="Add Memo"
                                            matTooltipPosition="above"><i class="fa fa-pencil" style="color: #2275ce;
                                        font-size: 12px;"></i>
                                        </a>
                                    </span>
                                </span>
                                <div class="col-sm-12">
                                    <span>
                                        <div class="memo-popup-cstm mat_emo">
                                            <div [innerHTML]=" receivingForm.memo"
                                                [matTooltip]="parsedText(receivingForm.memo)" style="width: 100%;padding-top: 4px;height: 76px;white-space: initial;
                                        padding: 10px;" class="text_editor_box"></div>
                                        </div>
                                    </span>
                                </div>
              
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="col-md-12">
                        <div class="form-group">
                            <div class="checkbox-cstm m-t-15">
                                <label>
                                    <input type="checkbox" name="isTimeLife1" [(ngModel)]="isDocumentsToShow"
                                        [value]="isDocumentsToShow==true">
                                    <span class="cr disabled_color1">
                                        <i class="cr-icon pi pi-check"></i>
                                    </span>
                                    Attachments
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12" *ngIf="isDocumentsToShow">
                        <app-common-documents [moduleName]="moduleName" (parentTrigger)="changeOfStatus($event)"  [uploadDocsToser]="uploadDocs" [referenceId]="receivingCustomerWorkId"
                            [isViewMode]="false" [offLineUpload]="true"></app-common-documents>
                    </div>
                </div>
            </div>
            <div class="form-row pull-right m-t-10">
                <button *ngIf="!isEditMode" type="submit" class="btn btn-primary" (click)="onSaveCustomerReceiving()"
                    [disabled]="!customerWorkForm.valid || disableMagmtStruct ||  disableCondition || disableSite">
                    Save 
                </button>
                <button *ngIf="isEditMode" type="submit" class="btn btn-primary" (click)="onSaveCustomerReceiving()"
                    [disabled]="!customerWorkForm.valid  || disableUpdateButton">
                    Update 
                </button>
            </div>
        </form> 
       
    </div>
</div>

<div class="modal fade" id="textareapopup"  role="dialog" data-backdrop="static"
>
 <div class="modal-dialog modal-sm">
     <div class="modal-content">
         <div class="modal-header">
             <button type="button" class="close" (click)="closeMemoModel()">
                 &times;
             </button>
             <h4 class="modal-title">Edit Memo</h4>
         </div>
         <div class="modal-body">
             <!-- <table class="table table-bordered table-fixed workflow-table-material">
                 <thead>
                     <th style="color: #fff;">Memo</th>
                 </thead>
                 <tbody>
                     <tr>
                         <td style="white-space: inherit">
                             <p-editor spellcheck="true" [(ngModel)]="memoPopupContent"
                                 (ngModelChange)="enableSaveMemo()" [style]="{ height: '320px' }"
                                 name="memoPopupContent" required></p-editor>
                         </td>
                     </tr>
                 </tbody>
             </table> -->
             <p-editor spellcheck="true" [(ngModel)]="memoPopupContent"
             (ngModelChange)="enableSaveMemo()" [style]="{ height: '320px' }"
             name="memoPopupContent" required></p-editor>
             <div class="editor-buttons">
                 <button type="button" class="btn btn-primary editor-buttons-margin" [disabled]="disabledMemo" (click)="onClickPopupSave()">
                     Save
                 </button>
                 <button type="button" class="btn btn-danger editor-buttons-margin" (click)="closeMemoModel()">
                     Close
                 </button>
             </div>
         </div>
     </div>
 </div>
</div>
<div class="modal fade" id="workorderpopup" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-sm" style="max-width: 530px !important;">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Customer Work is saved. Would you like to create Work Order ?</h4>
            </div>
           <div class="modal-footer" style="border-top: transparent;">
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="goToWorkOrder()">
                    Yes
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="goToCustomerWorkList()">
                    No
                </button>
            </div>
        </div>
    </div>
</div>
<div id="warnRestrictMesg" class="modal fade" role="dialog" data-backdrop="static">
    <div class="modal-dialog modal-xsm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title warning_color" *ngIf="restrictID == 0">Warning</h4>
                <h4 class="modal-title restrict_color" *ngIf="restrictID != 0">Restriction</h4>
            </div>
            <div class="pad_msf">
                <p *ngIf="warningID != 0 && restrictID == 0" class="mar_o warning_color">
                    {{warningMessage}}
                </p>
                <p *ngIf="restrictID != 0" class="mar_o restrict_color">
                    {{restrictMessage}}
                </p>
            </div>
            <div class="modal-footer" style="padding:10px;">
                <button class="btn btn-primary btn-primary" data-dismiss="modal" (click)="WarnRescticModel()">
                    Ok
                </button>
            </div>
        </div>
    </div>
</div>
<div class="preloader" *ngIf="isSpinnerVisible">
    <div class="loading">
        <div class="lds-roller">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>