<div class="modal-header">
  <button type="button" class="close" (click)="onClose($event)">
    &times;
  </button>
  <h4 class="modal-title" *ngIf="!isEdit">Exchange/Loan Fees</h4>
  <h4 class="modal-title" *ngIf="isEdit">Edit Exchange/Loan Fees</h4>
</div>
<div class="modal-body">
  <!-- <div class="row margin-row">
    <div class="col-md-12 col-sm-12 col-12">
      <div class="form-group" style="display: inline-block;margin: 10px 5px 0 5px;">
        <p class="fs10 wauto no-bg">
          <label style="width: auto;">PN <span class="clr-red">:</span></label>
          {{part.partNumber}}
        </p>
      </div>
      <div class="form-group" style="display: inline-block;margin: 10px 5px 0 5px;">
        <p class="fs10 wauto no-bg">
          <label style="width: auto;">Description <span class="clr-red">:</span></label>
          {{part.description}} </p>
      </div>
      <div class="form-group" style="display: inline-block;margin: 10px 5px 0 5px;">
        <p class="fs10 wauto no-bg">
          <label style="width: auto;">Cond <span class="clr-red">:</span></label>
          {{part.conditionDescription}}
        </p>
      </div>
      <div class="form-group" style="display: inline-block;margin: 10px 5px 0 5px;">
        <p class="fs10 wauto no-bg">
          <label style="width: auto;">Classification <span class="clr-red">:</span></label>
          {{ part.itemClassification  ? part.itemClassification : ''}}</p>
      </div>
      <div *ngIf="part.stockLineNumber" class="form-group" style="display: inline-block;margin: 10px 5px 0 5px;">
        <p class="fs10 wauto no-bg">
          <label style="width: auto;">Stk Line Number <span class="clr-red">:</span></label>
          {{ part.stockLineNumber  ? part.stockLineNumber : ''}}</p>
      </div>
    </div>
  </div> -->
  <div class="row margin-row">
    <div class="col-md-12 col-sm-12 col-12">
      <div class="col-3 column">
        <div class="form-group">
          <label>Exchange/Loan Fee<span class="clr-red">*</span></label>
          <input type="text" class="form-control quantityTextBox text-right" pInputText pKeyFilter="num"
            name="exchangeListPrice" [ngModel]="part.exchangeListPrice  | twoDecimalGlobalNumberFormatPipe"
            (ngModelChange)="part.exchangeListPrice=formatStringToNumberGlobal($event)" />
        </div>
      </div>
      <div class="col-3 column">
        <div class="form-group">
          <label>Entry Date<span class="clr-red">*</span></label>
          <p-calendar name="entryDate" class="form-control quantityTextBox border-none text-right" [yearNavigator]="true"
              [monthNavigator]="true" yearRange="1900:2100"
              [(ngModel)]="part.entryDate" [showIcon]="true" id="entryDate"
              #entryDate="ngModel" required>
          </p-calendar>
        </div>
      </div>
      <div class="col-3 column">
        <div class="form-group">
          <label>Overhaul Price (Est)<span class="clr-red">*</span></label>
          <input type="text" class="form-control quantityTextBox text-right" pInputText pKeyFilter="num"
            name="exchangeOverhaulPrice" [ngModel]="part.exchangeOverhaulPrice  | twoDecimalGlobalNumberFormatPipe"
            (ngModelChange)="part.exchangeOverhaulPrice=formatStringToNumberGlobal($event)" />
        </div>
      </div>
      <div class="col-3 column">
        <div class="form-group">
          <label>Core Price<span class="clr-red">*</span></label>
          <input type="text" class="form-control quantityTextBox text-right" pInputText pKeyFilter="num"
            name="exchangeCorePrice" [ngModel]="part.exchangeCorePrice  | twoDecimalGlobalNumberFormatPipe"
            (ngModelChange)="part.exchangeCorePrice=formatStringToNumberGlobal($event)" />
        </div>
      </div>
    </div>
  </div>
  <div class="row margin-row">
    <div class="col-md-12 col-sm-12 col-12">
      <div class="col-3 column">
        <div class="form-group">
          <label>Est. # of Fee Billings<span class="clr-red">*</span></label>
          <input type="text" class="form-control quantityTextBox text-right" pKeyFilter="num"
            name="estOfFeeBilling" (ngModelChange)="part.estOfFeeBilling=formatStringToNumberGlobal($event)" (blur)="addSchesuleBilling($event)" [ngModel]="part.estOfFeeBilling  | globalNmberFormat"
            [disabled]="isDisable"/>
        </div>
      </div>
      <div class="col-3 column">
        <div class="form-group">
          <label>Billing Start Date<span class="clr-red">*</span></label>
          <p-calendar name="billingStartDate" class="form-control quantityTextBox border-none text-right" [yearNavigator]="true"
              [monthNavigator]="true" yearRange="1900:2100"
              [(ngModel)]="part.billingStartDate" [showIcon]="true" id="billingStartDate"
              #billingStartDate="ngModel" required>
          </p-calendar>
        </div>
      </div>
      <div class="col-3 column">
        <div class="form-group">
          <label>Out Right Amt<span class="clr-red">*</span></label>
          <input type="text" class="form-control quantityTextBox text-right" pInputText pKeyFilter="num"
            name="exchangeOutrightPrice" [ngModel]="part.exchangeOutrightPrice  | twoDecimalGlobalNumberFormatPipe"
            (ngModelChange)="part.exchangeOutrightPrice=formatStringToNumberGlobal($event)" />
        </div>
      </div>
      <div class="col-3 column">
        <div class="form-group">
          <label>Days for Core Return<span class="clr-red">*</span></label>
          <input type="text" class="form-control quantityTextBox text-right" pInputText pKeyFilter="num"
            name="daysForCoreReturn" [ngModel]="part.daysForCoreReturn  | globalNmberFormat"
            />
        </div>
      </div>
    </div>
  </div>
  <div class="row margin-row">
    <div class="col-md-12 col-sm-12 col-12">
      <div class="col-3 column">
        <div class="form-group">
          <label>Billing Intervals (Days)<span class="clr-red">*</span></label>
          <input type="text" class="form-control quantityTextBox text-right" pInputText pKeyFilter="num"
            name="billingIntervalDays" (ngModelChange)="part.billingIntervalDays=formatStringToNumberGlobal($event)" (blur)="addSchesuleBillingIntervalDays()" [ngModel]="part.billingIntervalDays  | globalNmberFormat"
            [disabled]="isDisable"/>
        </div>
      </div>
      <div class="col-3 column">
        <div class="form-group">
          <label>Curr</label>
          <!-- <input type="text" class="form-control quantityTextBox text-right" pInputText
            name="curr" [ngModel]="part.curr"/> -->
            <select class="form-control quantityTextBox"
              [(ngModel)]="part.exchangeCurrencyId" [disabled]="true">
              <option value="" selected>Select</option>
              <option *ngFor="let markUp of currencyArr" [value]="markUp.value">{{ markUp.label }}
              </option>
            </select>
        </div>
      </div>
      <div class="col-3 column">
        <div class="form-group">
          <label>Deposit Amt</label>
          <input type="text" class="form-control quantityTextBox text-right" pInputText pKeyFilter="num"
            name="depositeAmount" [ngModel]="part.depositeAmount  | twoDecimalGlobalNumberFormatPipe"
            (ngModelChange)="part.depositeAmount=formatStringToNumberGlobal($event)" />
        </div>
      </div>
      <div class="col-3 column">
        <div class="form-group">
          <label>Core Due Date<span class="clr-red">*</span></label>
          <p-calendar name="coreDueDate" class="form-control quantityTextBox border-none text-right" [yearNavigator]="true"
              [monthNavigator]="true" yearRange="1900:2100"
              [(ngModel)]="part.coreDueDate" [showIcon]="true" id="coreDueDate"
              #coreDueDate="ngModel" required>
          </p-calendar>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="isScheduleBilling">
    <form>
      <table class="table table-bordered " id="ESB-table"  >
        <thead>
            <tr class="header-table-width" >
                <th class="th-width">Schedule Billing Dates</th>
                <th>Periodic Billing Amt</th>
                <th>COGS % </th>
                <th>COGS Amount</th>
            </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let partList of part.exchangeQuoteScheduleBilling;let row_index=index;">
            <tr>
              <td>
                <p-calendar name="scheduleBillingDate{{row_index}}" class="form-control border-none quantityTextBox text-right" [yearNavigator]="true"
                  [monthNavigator]="true" yearRange="1900:2100"
                  [(ngModel)]="partList.scheduleBillingDate" [showIcon]="true" id="scheduleBillingDate{{row_index}}"
                  #scheduleBillingDate="ngModel" required>
                </p-calendar>
              </td>
              <td>
                <input type="text" class="form-control quantityTextBox text-right" pInputText pKeyFilter="num"
                name="periodicBillingAmount{{row_index}}" id="periodicBillingAmount{{row_index}}" [ngModel]="partList.periodicBillingAmount  | twoDecimalGlobalNumberFormatPipe"
                (ngModelChange)="partList.periodicBillingAmount=formatStringToNumberGlobal($event)" (blur)="calculateCOGS(row_index)"/>
              </td>
              <td>
                <!-- (change)="onChangeInput()" -->
                <select style="width:90%" name ="cogs{{row_index}}" (change)="calculateCOGS(row_index)" id="cogs{{row_index}}" [(ngModel)]="partList.cogs">
                  <option [ngValue]="0">Select</option>
                  <option *ngFor="let p of percentage" [ngValue]="p.label">{{ p.label }}</option>
                </select>
              </td>
              <td>
                <input type="text" class="form-control quantityTextBox text-right" pInputText pKeyFilter="num"
                name="cogsAmount{{row_index}}" id="cogsAmount{{row_index}}" [ngModel]="partList.cogsAmount  | twoDecimalGlobalNumberFormatPipe"
                (ngModelChange)="partList.cogsAmount=formatStringToNumberGlobal($event)" />
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </form>
  </div>
  <div class="row margin-row">
    <div class="col-md-12 col-sm-12 col-12">
      <div class="col-3 column">
        <div class="form-group">
          <label>
            <input type="checkbox" name="isRemark" [(ngModel)]="part.isRemark" />
            <span class="cr"><i class="cr-icon pi"></i></span>
            Print
          </label>
          <div class="rpma-input memo-popup-cstm col-sm-12 m-t-15" *ngIf="part.isRemark">
            <div class="col-sm-11">
              <span>
                <div class="form-group memo-popup-cstm mat_emo">
                  <div [innerHTML]="part.remarkText" [matTooltip]="parsedText(part.remarkText)" matTooltipPosition="above"
                    class="form-control quantityTextBox" style="width: 63%;" class="text_editor_box"></div>
                </div>
              </span>
            </div>
            <div class="col-sm-1">
              <span style="margin-left:-95px"><a class="btn nobg" data-toggle="modal" data-target="#memo-popup"
                  (click)="onClickRemarktext('remarkText')" matTooltip="Add Memo" matTooltipPosition="above"><i
                    class="fa fa-pencil"></i></a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- <div class="row margin-row row-table calculation">
    <table>
      <thead>
        <tr>
          <th style="width:25%"></th>
          <th style="width:15%"></th>
          <th style="width:25%"><span>Per Unit</span></th>
          <th style="width:25%"><span>Extended</span></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <span>Sales Price</span></td>
          <td>
          </td>
          <td><span><input type="text" class="form-control text-right"
                [ngModel]="part.salesPricePerUnit  | twoDecimalGlobalNumberFormatPipe"
                [ngModelOptions]="{updateOn:'blur'}"
                (ngModelChange)="part.salesPricePerUnit=formatStringToNumberGlobal($event)" (blur)="calculate()"
                pKeyFilter="money" /></span></td>
          <td><span>{{part.salesPriceExtended | twoDecimalGlobalNumberFormatPipe }}</span></td>
        </tr>
        <tr>
          <td>
            <span>Markup (%)</span>
          </td>
          <td>
            <select style="width:90%" [(ngModel)]="part.markUpPercentage" (change)="calculate()">
              <option [ngValue]="0">Select</option>
              <option *ngFor="let p of percentage" [ngValue]="p.label">{{ p.label }}</option>
            </select>
            <span style="padding-left: 5px;">%</span>
          </td>
          <td><span><input type="text" class="form-control text-right"
                [ngModel]="part.markupPerUnit | twoDecimalGlobalNumberFormatPipe" [ngModelOptions]="{updateOn:'blur'}"
                (ngModelChange)="part.markupPerUnit=formatStringToNumberGlobal($event)" (blur)="calculate()"
                pKeyFilter="money" /></span>
          </td>
          <td><span>{{part.markupExtended | twoDecimalGlobalNumberFormatPipe }}</span></td>
        </tr>
        <tr>
          <td>
            <span>Sales Disc (%)</span>
          </td>
          <td>
            <select style="width:90%" [(ngModel)]="part.salesDiscount" (change)="calculate()">
              <option [ngValue]="0">Select</option>
              <option *ngFor="let p of percentage" [ngValue]="p.label">{{ p.label }}</option>
            </select>
            <span style="padding-left: 5px;">%</span>

          </td>
          <td>
            <input type="text" class="form-control text-right"
              [ngModel]="part.salesDiscountPerUnit  | twoDecimalGlobalNumberFormatPipe"
              [ngModelOptions]="{updateOn:'blur'}"
              (ngModelChange)="part.salesDiscountPerUnit=formatStringToNumberGlobal($event)" (blur)="calculate()"
              pKeyFilter="money" />
          </td>
          <td><span>{{part.salesDiscountExtended | twoDecimalGlobalNumberFormatPipe}}</span></td>
        </tr>
        <tr>
          <td>
            <span>Net Sale Price</span>
          </td>
          <td>
          </td>
          <td>
            <span>{{part.netSalesPricePerUnit | twoDecimalGlobalNumberFormatPipe}}</span>
          </td>
          <td><span>{{part.netSalesPriceExtended | twoDecimalGlobalNumberFormatPipe }}</span></td>
        </tr>
        <tr>
          <td colspan="4">&nbsp;</td>
        </tr>
        <tr>
          <td>
            <span>Unit Cost</span>
          </td>
          <td>
          </td>
          <td><span>{{ part.unitCostPerUnit | twoDecimalGlobalNumberFormatPipe }}</span></td>
          <td><span>{{ part.unitCostExtended | twoDecimalGlobalNumberFormatPipe }}</span></td>
        </tr>
        <tr>
          <td>
            <span>Margin Amount</span>
          </td>
          <td>
          </td>
          <td><span>{{ part.marginAmountPerUnit | twoDecimalGlobalNumberFormatPipe }}</span></td>
          <td><span>{{ part.marginAmountExtended | twoDecimalGlobalNumberFormatPipe }}</span></td>
        </tr>
        <tr>
          <td>
            <span>Margin (%)</span>
          </td>
          <td>
          </td>
          <td><span>{{ part.marginPercentagePerUnit | twoDecimalGlobalNumberFormatPipe }} % </span></td>
          <td><span>{{ part.marginPercentageExtended | twoDecimalGlobalNumberFormatPipe }} %</span></td>
        </tr>
      </tbody>
    </table>
  </div> -->
</div>
<div class="modal-footer">
  <button type="submit" class="btn btn-primary" [disabled]="invalidQuantityenteredForQuantityFromThis == true"
    (click)="onSave($event)">
    Save
  </button>
  <button type="button" (click)="onClose($event)" class="btn btn-danger">
    Close
  </button>
</div>
<div class="modal fade" id="memo-popup" role="dialog" data-backdrop="static">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          &times;
        </button>
        <h4 class="modal-title">Edit Memo</h4>
      </div>
      <div class="modal-body">
        <p-editor
        spellcheck="true"
        (ngModelChange)="enableSaveMemo()"
         [(ngModel)]="memoPopupContent"
         [style]="{ height: '320px' }"
         name="memoPopupContent"
         required
       ></p-editor>
        <div class="editor-buttons">
          <button
            type="button"
            class="btn btn-primary editor-buttons-margin"
            data-dismiss="modal"
            (click)="onClickPopupSave()"
            [disabled]="disableSaveMemo"
          >
            Save
          </button>
          <button
            type="button"
            class="btn btn-danger editor-buttons-margin"
            data-dismiss="modal"
          >
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<ng-template #errorMessagePop let-c="close" let-d="dismiss">
  <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" (click)="closeErrorMessage()">&times;</button>
      <h4 class="modal-title"> Please Enter (*) Mandatory Fields</h4>
  </div>
  <div class="modal-body">
      <p *ngFor="let error of errorMessages" [ngStyle]="{'color':'red'}"> {{ error }} </p>
  </div>
  <div class="modal-footer">

      <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="closeErrorMessage()">Close</button>
  </div>
</ng-template>
