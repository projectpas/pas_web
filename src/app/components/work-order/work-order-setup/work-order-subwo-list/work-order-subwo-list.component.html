

<div class="">
  
</div>

<div class="card">
  <div class="card-body">
    <!-- <div style="margin-left: 5px;">
      <button class="btn btn-primary"
        (click)="openNewSubWorkOrder()" *ngIf="!isView">
        Add New Sub-WO
      </button>
    </div> -->
    <p-table #dt class="rpo-table-cstm rro-table-cstm ptable-f10"
      [columns]="subWorkOrderCols"
      [value]="subWorkOrderData"
      [paginator]="true"
      [rows]="pageSize" [resizableColumns]="true" [reorderableColumns]="true" [pageLinks]="3" [rowsPerPageOptions]="[10, 20, 50, 100]" [scrollable]="true" scrollHeight="450px"
    >
    <ng-template pTemplate="colgroup" let-columns>
      <colgroup>
          <col *ngFor="let col of columns" class="table-column-width">
      </colgroup>
    </ng-template>
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th class="table-column-width"
              *ngFor="let col of columns"
              pResizableColumn
              pReorderableColumn
              [pSortableColumn]="col.field">
              {{ col.header }}
              <p-sortIcon [field]="col.field"></p-sortIcon>
          </th>
          <th class="table-actions-column" *ngIf="!isView">
            Actions
          </th>
        </tr>
        <tr>
          <th class="table-column-width" *ngFor="let col of columns" [ngSwitch]="col.field">
            <input  pInputText type="text" (input)="dt.filter($event.target.value, col.field, 'contains')">
          </th>
          <th class="table-column-width" *ngIf="!isView"></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-rowData let-columns="columns">
        <tr>
          <td class="table-column-width" *ngFor="let col of columns">
            {{
              col.field == 'openDate'
                ? (rowData[col.field] | date: 'MM/dd/yyyy')
                : rowData[col.field] && col.field == 'needDate'
                ? (rowData[col.field] | date: 'MM/dd/yyyy')
                : rowData[col.field]
            }}
          </td>
          <td class="action-icons-cstm table-column-width" *ngIf="subWorkOrderData && !isView">
            <!-- <p-inputSwitch
              [(ngModel)]="rowData['isActive']"
              name="isActive{{ rowIndex }}"
              (onChange)="changeStatus(rowData)"
            ></p-inputSwitch> -->

            <span data-toggle="modal" data-target="#viewSubWOrkOrder" *ngIf="!forSubWorkOrder"><a class="btn nobg btn-view-cstm" 
              (click)="view(rowData)" matTooltip="View" matTooltipPosition="above"><i class="fa fa-eye"></i></a></span>
            <span *ngIf="!forSubWorkOrder"><a class="btn nobg btn-edit-cstm" 
              (click)="edit(rowData)" matTooltip="Edit" matTooltipPosition="above"><i class="fa fa-pencil"></i></a> </span>
         <span *ngIf="forSubWorkOrder==true">
          <a class="btn nobg btn-edit-cstm"   (click)="AddSubWo(rowData)" >
            <i class="fa fa-plus" style="color:green" matTooltip="Add to Existing Sub Work Order" matTooltipPosition="above" ></i>
          </a>
         </span>
              
         
              <!-- <span data-toggle="modal" data-target="#viewSubWOrkOrder">
              <a
                class="btn btn-info boxed-float-btn nobg"
                data-toggle="tooltip"
                (click)="view(rowData)"
              >
                <i class="fa fa-eye"></i>
              </a>
            </span> -->
            <!-- <button
              class="btn-edit ptable-wo-btns"
              mat-icon-button
              (click)="edit(rowData)"
              matTooltip="Edit"
            >
              <mat-icon>edit</mat-icon>
            </button> -->
<!-- 
            <button
              class="btn-delete ptable-wo-btns"
              mat-icon-button
              matTooltip="Delete"
              data-target="#delete"
              data-toggle="modal"
              (click)="delete(rowData)"
            >
              <mat-icon color="warn">delete</mat-icon>
            </button> -->
            <!-- <button
              class="btn-history ptable-wo-btns"
              mat-icon-button
              matTooltip="History"
              data-target="#contentHist"
              data-toggle="modal"
              (click)="getAuditHistoryById(rowData)"
            >
              <mat-icon color="green">history</mat-icon>
            </button> -->
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage" let-columns *ngIf="subWorkOrderData.length == 0">
        <tr>
          <td colspan="9" class="no-records-cstm no-records-msg">
            No records found
          </td>
        </tr>
    </ng-template>
    <ng-template pTemplate="summary" id="footer">
        <label id="footer">Total:</label>
        <input class="footer-input-width" [(ngModel)]="dt._totalRecords" [disabled]="true" pInputText type="text" />
        &nbsp;&nbsp;
        <label id="footer">Pages Count:</label>    
        <input class="footer-input-width" [ngModel]="getPageCount(dt._totalRecords, pageSize)" [disabled]="true" pInputText type="text" />
      </ng-template>
    </p-table>
  </div>
</div>

<div id="viewSubWOrkOrder" class="modal fade" role="dialog" data-backdrop="static">
  <div class="modal-dialog modal-xl">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          &times;
        </button>
        <h4 class="modal-title">Sub WorkOrder View</h4>
      </div>

      <div class="modal-body" *ngIf="subWorkOrderHeader">
        <div class="card">
          <div class="card-body">
            <div class="table-responsive default-bg clear">
              <div>
                <div class="col-md-6">
                  <p>
                    <span class="label"><b> WorkOrder Number </b></span
                    ><span class="value">{{
                      subWorkOrderHeader.workOrderNum
                    }}</span>
                  </p>
                </div>
                <div class="col-md-6">
                  <p>
                    <span class="label"><b> Master Part </b></span
                    ><span class="value">{{ subWorkOrderHeader.mcpn }}</span>
                  </p>
                </div>
              </div>
              <hr style="clear: both;" />

              <div>
                <div class="col-sm-3">
                  <p>
                    <span class="label"><b> Sub WO Number </b></span
                    ><span class="value">{{
                      subWorkOrderHeader.subWorkOrderNo
                    }}</span>
                  </p>
                  <p>
                    <span class="label"><b>Open Date: </b></span
                    ><span class="value">{{
                      subWorkOrderHeader.openDate | date: 'MM/dd/yyyy'
                    }}</span>
                  </p>
                  <p>
                    <span class="label"><b>Sub WO Need Date: </b></span
                    ><span class="value">{{
                      subWorkOrderHeader.needDate
                    }}</span>
                  </p>
                </div>
                <div class="col-sm-3">
                  <p>
                    <span class="label"><b>Sub WO Est.Completed Date: </b></span
                    ><span class="value">{{
                      subWorkOrderHeader.estCompDate
                    }}</span>
                  </p>
                  <p>
                    <span class="label"><b>Sub WO Stage: </b></span
                    ><span class="value">{{
                      subWorkOrderHeader.workOrderStage
                    }}</span>
                  </p>
                  <p>
                    <span class="label"><b>Sub WO Status: </b></span
                    ><span class="value">{{
                      subWorkOrderHeader.workOrderStatus
                    }}</span>
                  </p>
                </div>

                <div class="col-sm-3">
                  <p>
                    <span class="label"><b>Sub Wo CMM: </b></span
                    ><span class="value">{{
                      subWorkOrderHeader.workOrderCMM
                    }}</span>
                  </p>

                  <p>
                    <span class="label"><b>Sub Wo Work Flow : </b></span
                    ><span class="value">{{
                      subWorkOrderHeader.workFlowNo
                    }}</span>
                  </p>
                </div>
                <div class="col-sm-3">
                  <p>
                    <span class="label"><b>Is PMA: </b></span
                    ><span class="value">
                      {{ subWorkOrderHeader.isPMA }}
                    </span>
                  </p>
                  <p>
                    <span class="label"><b>Is DER: </b></span
                    ><span class="value">{{ subWorkOrderHeader.isDER }}</span>
                  </p>
                </div>
              </div>
            </div>
          </div>



          <div class="card"  >
                <div class="card-body" *ngIf="showTableGrid">
                  <p-tabView  class="pas-tabview" [activeIndex]="activeIndex">
                              
                    <p-tabPanel  *ngIf="workFlowId" header="Work Flow">
                        <app-workflow-list [isWorkOrder]="isWorkOrder"   [workFlowId]="workFlowId" ></app-workflow-list>  
                    </p-tabPanel>
      
                    <p-tabPanel header="Material List">
                        <div class="equipment-tab-content"  >
                            <div class="x_panel" *ngIf="workOrderMaterialList">
                                <div class="tab-content">
                                    <div class="table-responsive table-overflow pas-table-cstm header-table-width poro-table-cstm parts-list-table-align" id="workflow-attributes-block">
                                      <div class="tableFixHead">
                                      <table class="table table-bordered ">
                                            <thead>
                                                <tr>
        
                                                    <th class="text-center">Part Number </th>
                                                    <th class="text-center">Part Description</th>
                                                    <th class="text-center">Alternate PN</th>
                                                    <th class="text-center">SerialNumber</th>
                                                    <th class="text-center">Provision</th>
                                                    <th class="text-center">OEM</th>
                                                    <th class="text-center">Control</th>
                                                    <th class="text-center">Condition</th>
                                                    <th class="text-center">Item Type</th>
                                                    <th class="text-center">Qunatity Requried</th>
                                                    <th class="text-center">Qunatity Reserved</th>
                                                    <th class="text-center">Qunatity TurnIn</th>
                                                    <th class="text-center">Qunatity Issued</th>
                                                    <th class="text-center">Qunatity BackOrder</th>
                                                    <th class="text-center">Qunatity Remaining</th>
                                                    <th class="text-center">Unit Cost</th>
                                                    <th class="text-center">Extended Cost</th>
                                                    <th class="text-center">Currency</th>
                                                    <th class="text-center">Purchase OrderNumber</th>
                                                    <th class="text-center">Repair OrderNumber</th>
                                                    <th class="text-center">Part Quantity OnHand</th>
                                                    <th class="text-center">Part Quantity Available</th>
                                                    <th class="text-center">Part Quantity OnOrder</th>
                                                    <th class="text-center">WorkOrder Number</th>
                                                    <th class="text-center">Sub WorkOrder</th>
                                                    <th class="text-center">SalesOrder</th>
                                                    <th class="text-center">Condition</th>
                                                    <th class="text-center">TimeLife</th>
                                                    <th class="text-center">Ware House</th>
                                                    <th class="text-center">Location</th>
                                                    <th class="text-center">Shelf</th>
                                                    <th class="text-center">Bin</th>
        
                                                </tr>
                                            </thead>
                                        
                                            <tbody>
                                                <tr *ngFor="let m  of workOrderMaterialList; let i=index;">
                                                    <td>{{m.partNumber}}</td>
                                                    <td>{{m.partDescription}}</td>
                                                    <td>{{m.altPartNumber}}</td>
                                                    <td>{{m.serialNumber}}</td>
                                                    <td>{{m.provision}}</td>
                                                    <td>{{m.oem}}</td>
                                                    <td>{{m.control}}</td>
                                                    <td>{{m.condition}}</td>
                                                    <td>{{m.itemType}}</td>
                                                    <td>{{m.qunatityRequried}}</td>
                                                    <td>{{m.qunatityReserved}}</td>
                                                    <td>{{m.qunatityTurnIn}}</td>
                                                    <td>{{m.qunatityIssued}}</td>
                                                    <td>{{m.qunatityBackOrder}}</td>
                                                    <td>{{m.qunatityRemaining}}</td>
                                                    <td>{{m.unitCost}}</td>
                                                    <td>{{m.extendedCost}}</td>
                                                    <td>{{m.currency}}</td>
                                                    <td>{{m.purchaseOrderNumber}}</td>
                                                    <td>{{m.repairOrderNumber}}</td>
                                                    <td>{{m.partQuantityOnHand}}</td>
                                                    <td>{{m.partQuantityAvailable}}</td>
                                                    <td>{{m.partQuantityOnOrder}}</td>
                                                    <td>{{m.receiver}}</td>
                                                    <td>{{m.workOrderNumber}}</td>
                                                    <td>{{m.subWorkOrder}}</td>
                                                    <td>{{m.salesOrder}}</td>
                                                    <td>{{m.timeLife}}</td>
                                                    <td>{{m.wareHouse}}</td>
                                                    <td>{{m.location}}</td>
                                                    <td>{{m.shelf}}</td>
                                                    <td>{{m.bin}}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        </div>
                                    </div>
                                </div>
                                <div class="clear"></div>
                                <br />
                                <br />
                                <br />
                                <br />
                            </div>
                        </div>
                      </p-tabPanel> 
      
      
                      <p-tabPanel  header="Labor">
      
                          <p-accordion [multiple]="true">
         
                                <p-accordionTab header="{{x.task}}" *ngFor="let x of workOrderLaborList; let i = index;" >
                    
                                    <div class="equipment-tab-content" >
                                        <div class="x_panel" *ngIf="workOrderLaborList">
                                            <div class="tab-content">
                                                <div class="table-responsive table-overflow pas-table-cstm header-table-width poro-table-cstm parts-list-table-align" id="workflow-attributes-block">
                                                  <div class="tableFixHead"> 
                                                  <table class="table table-bordered ">
                                                        <thead>
                                                            <tr>
                                                                <th class="text-center">Expertise</th>
                                                                <th class="text-center">Description</th>
             
                                                            </tr> 
                                                        </thead>
                                                    
                                                        <tbody>
                                                          <tr >
                                                                <td>{{x.expertise}}</td>
                                                                <td>{{x.hours}}</td>
                                                            </tr> 
                                                        </tbody>
                                                    </table>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="clear"></div>
                                            <br />
                                            <br />
                                            <br />
                                            <br />
                                        </div>
                                    </div> 
                                  </p-accordionTab>
              
             
                            
                            
                          </p-accordion>
                       
         
         
                      </p-tabPanel> 
                    <p-tabPanel header="Assets">
                     
                        <div class="equipment-tab-content" *ngIf="workOrderAssetList">
                            <div class="x_panel">
                                <div class="tab-content">
                                    <div class="table-responsive" id="workflow-attributes-block">
                                        <table class="table table-bordered ">
                                            <thead>
                                                <tr>
                                                </tr>
                                                <tr>
                                                    <th colspan="4" class="text-center"></th>
                                                    <th colspan="4" class="text-center">TOLERANCE</th>
                     
                                                </tr>
                                                <tr>
                                                    <th class="text-center">Equipment </th>
                                                    <th class="text-center">Equipment Description</th>
                                                    <th class="text-center">Equipment Type</th>
                                                    <th class="text-center">Qty</th>
                                                    <th class="text-center">Min</th>
                                                    <th class="text-center">Max</th>
                                                    <th class="text-center">Expected</th>
                                                    <th class="text-center">Findings</th>
                                     
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr *ngFor="let asset of workOrderAssetList; let i=index;">
                                                    <td>{{asset.asset}}</td>
                                                    <td>{{asset.description}}</td>
                                                    <td>{{asset.assetTypeName}}</td>
                                                    <td>{{asset.quantity}}</td>
                                                    <td>
                                                       {{asset.minQuantity}}
                                                    </td>
                                                    <td>
                                                       {{asset.maxQuantity}}
                                                    </td>
                                                    <td>
                                                      {{asset.expectedQuantity}}
                                                    </td>
                                                    <td>
                                                      {{asset.findings}}
                                                    </td>
                              
                                                </tr>
      
                        
                                                
                         
                                            </tbody>
                                        </table>
      
                                    </div>
                                </div>
                                <div class="clear"></div>
                                <br />
                                <br />
                                <br />
                                <br />
                            </div>
                        </div>
      
      
                    </p-tabPanel> 
      
      
                    <p-tabPanel header ="Quote">
      
                      <div class="h-300">
                      <h3>No Data Found</h3>
                      </div>
      
                    </p-tabPanel>
                    <p-tabPanel header ="Main Component">
                          <div class="h-300">
                                  <h3>No Data Found</h3>
                                  </div>
                      </p-tabPanel>
                      <p-tabPanel header ="Billing/Invocing">
                          <div class="h-300">
                                  <h3>No Data Found</h3>
                                  </div>
                        </p-tabPanel>
      
                        <p-tabPanel header ="Shipping">
                              <div class="h-300">
                                      <h3>No Data Found</h3>
                                      </div>
                          </p-tabPanel>
      
                          <p-tabPanel header ="Sub-WO">
                                  <div class="h-300">
                                          <h3>No Data Found</h3>
                                          </div>
                            </p-tabPanel>
      
                            <p-tabPanel header ="Communication">
                                  <div class="h-300">
                                          <h3>No Data Found</h3>
                                          </div>
                              </p-tabPanel>
      
      
                              <p-tabPanel header ="Documents">
                                      <div class="h-300">
                                              <h3>No Data Found</h3>
                                              </div>
                                </p-tabPanel>
      
      
                                <p-tabPanel header ="Work Complete">
                                      <div class="h-300">
                                              <h3>No Data Found</h3>
                                              </div>
                                  </p-tabPanel>
      
      
      
                                  <p-tabPanel header ="WO Analysis">
                                          <div class="h-300">
                                                  <h3>No Data Found</h3>
                                                  </div>
                                    </p-tabPanel>
      
      
                                    <p-tabPanel header ="Labor Analysis">
                                          <div class="h-300">
                                                  <h3>No Data Found</h3>
                                                  </div>
                                      </p-tabPanel>
                                      <p-tabPanel header ="Tear Down">
                                              <div class="h-300">
                                                      <h3>No Data Found</h3>
                                                      </div>
                                        </p-tabPanel>
      
      
                                      <p-tabPanel>
                                          <ng-template pTemplate="header" style="height: 36px; width: 134px;">Other Options
                                              <i (click)="showOtherOptions()" class="fa fa-caret-down" aria-hidden="true"></i>
                                                <div class="vertical-menu-wolist" *ngIf="otherOptionShow">
                                                    <a (click)="otherOptionSelected('freight')" style="color: #333333 !important">Freight</a>
                                                    <a (click)="otherOptionSelected('contactGrid')" style="color: #333333 !important">Contact Grid</a>
                                                    <a (click)="otherOptionSelected('accounting')" style="color: #333333 !important">Accounting</a>
                                                    <a (click)="otherOptionSelected('charges')" style="color: #333333 !important">Charges</a>
                                                    <a (click)="otherOptionSelected('exclusion')" style="color: #333333 !important">Exclusion</a>
                                                  </div>
      
                                          </ng-template>
      
                                          <div >
                                       
                                                  <div class="equipment-tab-content" *ngIf="selectedOtherSubTask === 'charges'" >
                                                    <div class="x_panel" *ngIf="workOrderChargesList">
                                                        <div class="tab-content">
                                                            <div class="table-responsive table-overflow pas-table-cstm header-table-width poro-table-cstm parts-list-table-align" id="workflow-attributes-block">
                                                              <div class="tableFixHead"> 
                                                              <table class="table table-bordered ">
                                                                    <thead>
                                                                        <tr>
                                                                            <th class="text-center">Charge Type </th>
                                                                            <th class="text-center">Description</th>
                                                                            <th class="text-center">Quantity</th>
                                                                            <th class="text-center">Unit Cost</th>
                                                                            <th class="text-center">Extented Cost</th>
                                                                            <th class="text-center">Unit Price</th>
                                                                            <th class="text-center">Extended Price</th>
                                                                            <th class="text-center">vendorName</th>
                                                                        </tr> 
                                                                    </thead>
                                                                
                                                                    <tbody>
                                                                      <tr *ngFor="let w  of workOrderChargesList; let i=index;">
                                                                            <td>{{w.chargeType}}</td>
                                                                            <td>{{w.description}}</td>
                                                                            <td>{{w.quantity}}</td>
                                                                            <td>{{w.unitCost}}</td>
                                                                            <td>{{w.extendedCost}}</td>
                                                                            <td>{{w.unitPrice}}</td>
                                                                            <td>{{w.extendedPrice}}</td>
                                                                            <td>{{w.vendorName}}</td>
                                                                        </tr> 
                                                                    </tbody>
                                                                </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="clear"></div>
                                                        <br />
                                                        <br />
                                                        <br />
                                                        <br />
                                                    </div>
                                                </div>
                                         
        
                                          </div>
                                          
                                          <div *ngIf="selectedOtherSubTask === 'exclusion'">
                                            
      
                                                  <div class="equipment-tab-content" >
                                                      <div class="x_panel" *ngIf="workOrderExclusionsList">
                                                          <div class="tab-content">
                                                              <div class="table-responsive table-overflow pas-table-cstm header-table-width poro-table-cstm parts-list-table-align" id="workflow-attributes-block">
                                                                <div class="tableFixHead"> 
                                                                <table class="table table-bordered ">
                                                                      <thead>
                                                                          <tr>
                                                                              <th class="text-center">EPN</th>
                                                                              <th class="text-center">EPN Description</th>
                                                                              <th class="text-center">Quantity</th>
                                                                              <th class="text-center">Unit Cost</th>
                                                                              <th class="text-center">Extended Cost</th>
                                                                              <th class="text-center">Memo</th>
                                                                          </tr> 
                                                                      </thead>
                                                                  
                                                                      <tbody>
                                                                        <tr *ngFor="let w  of workOrderExclusionsList; let i=index;">
                                                                              <td>{{w.epn}}</td>
                                                                              <td>{{w.epnDescription}}</td>
                                                                              <td>{{w.quantity}}</td>
                                                                              <td>{{w.unitCost}}</td>
                                                                              <td>{{w.extendedCost}}</td>
                                                                              <td>{{w.memo}}</td>
                                     
                                                                          </tr> 
                                                                      </tbody>
                                                                  </table>
                                                                  </div>
                                                              </div>
                                                          </div>
                                                          <div class="clear"></div>
                                                          <br />
                                                          <br />
                                                          <br />
                                                          <br />
                                                      </div>
                                                  </div>
                                             
                                          </div>
                                      </p-tabPanel>
      
    
      
                    
                  </p-tabView>
                </div>
              </div> 
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
