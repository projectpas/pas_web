<div [@fadeInOut] class="page-content work_order_cont">
    <p-breadcrumb [model]="breadcrumbs" [home]="home" *ngIf="!isSubWorkOrder && !isView"></p-breadcrumb>
    <div class="right_col" role="main">
        <form #workOrderForm="ngForm">
            <div class="x_content">
                <div class="card new-card" *ngIf="!isSubWorkOrder">
                  
                        <div class="card-header header " *ngIf="!isSubWorkOrder && !isView">
                            <div class="row">
                                <div class="col">
                                  <h4  class="header-name">
                                      {{ isEdit ? 'Edit' : 'Create' }} Work Order
                             
                              <button class="btn-sm header-button header-button-alignment"  (click)="toggleDisplayMode()">
                                {{isDetailedView ? 'Collapse' : 'Expand'}}</button>
                            </h4>
                            </div>
                            <div>
                                <button type="button"
                                  class="btn-sm header-button pull-right"
                                  [routerLink]="['/workordersmodule/workorderspages/app-work-order-list']">
                                  Work Order List  </button>
                                  
                                </div>
                           </div>
                        </div>
                        <!-- <div class="pheading" *ngIf="!hideWOHeader">
                            <h4 *ngIf="!isSubWorkOrder && !isView" class="page-heading">Create Work Order </h4>
                            <h4 *ngIf="isSubWorkOrder && !isView" class="page-heading">Create Sub Work Order </h4>
                        </div> -->
                        <div class="clear"></div> 
                        <div class="card card-border" *ngIf="!hideWOHeader">
                            <div class="card-body new-card-body">
                                <div class="col-sm-12 link-block">
                                    <h4 class="pull-right style_h4" >
                                        <!-- General Info -->
                                        <button *ngIf="isView" class="btn-sm header-button expand-left" (click)="toggleDisplayMode()">
                                            {{isDetailedView ? 'Collapse' : 'Expand'}}</button>
                                        <!-- <span [hidden]="isDetailedView" class="more-details-btn">
                                            (More <i class="fa fa-caret-down"></i>)
                                        </span>
                                        <span [hidden]="!isDetailedView" class="less-details-btn">
                                            (Less <i class="fa fa-caret-up"></i>)
                                        </span> -->
                                    </h4>
                                    <!--(click)="toggleDisplayMode()"-->
                                  
                                    <!-- <div class="clear"></div> -->
                                </div>
                                <div class="less-details" [hidden]="isDetailedView">
                                   
                                    <div class="col-sm-3">
                                        <div class="form-group col-sm-12">
                                            <label class="control-label col-sm-4" style="padding-top:5px !important">
                                                WO Num
                                            </label>
                                            <div class="col-sm-7" matTooltipPosition="above"
                                                matTooltip="This field should display 'creating' before the header info is saved WO ID should be autogenerated.  Allow siffices or prefeices depending on what config in the WO setup screen">
                                                <input *ngIf="workOrderGeneralInformation.workOrderNumber !== '' "
                                                    type="text" class="form-control"
                                                    value={{workOrderGeneralInformation.workOrderNumber}} disabled>
                                                <input *ngIf="workOrderGeneralInformation.workOrderNumber === '' "
                                                    type="text" class="form-control" value='' disabled>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-sm-3">
                                        <div class="form-group col-sm-12">
                                            <label class="control-label col-sm-4" style="padding-top:5px !important">Cust
                                                Name</label>
                                            <div class="col-sm-7" matTooltipPosition="above"
                                                matTooltip="This field should display 'creating' before the header info is saved WO ID should be autogenerated.  Allow siffices or prefeices depending on what config in the WO setup screen">
                                                <input *ngIf="workOrderGeneralInformation.customerId !== null"
                                                    type="text" class="form-control"
                                                    value={{workOrderGeneralInformation.customerId.customerName}}
                                                    disabled>
                                                <input *ngIf="workOrderGeneralInformation.customerId === null"
                                                    type="text" class="form-control" value='' disabled>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="clear"></div>
                                <div class="more-details" [hidden]="!isDetailedView">
                                    <!-- <div class="clear"></div>
                                    <hr class="hr_mrt"> -->
                                    <div class="col-md-12 row">
                                        <div class="col-md-3"> 
                                            <label class="wauto" matTooltipPosition="above" [ngClass]="{pointerEvents : isEdit && !isRecCustomer}"
                                                matTooltip="Single MPN">
                                                <input type="radio" [value]=true name="type" #type="ngModel"
                                                    class="radio_adjust"
                                                    [(ngModel)]="workOrderGeneralInformation.isSinglePN">
                                                Single MPN
                                            </label>
                                            <label class="wauto" matTooltipPosition="above" [ngClass]="{pointerEvents : isEdit && !isRecCustomer}"
                                                matTooltip="Multiple MPN">
                                                <input type="radio" [value]=false name="type" #type="ngModel"
                                                    class="radio_adjust"
                                                    [(ngModel)]="workOrderGeneralInformation.isSinglePN"
                                                    >
                                                Multiple MPN
                                            </label>
                                            <!-- <div class="form-group">
                                                <div class="pull-left" style="margin-top: 4px; margin-right: 15px;">
                                                    <label class="radio-cstm wauto" [ngClass]="{pointerEvents : workOrderGeneralInformation.isRecCustomer || isEdit}">
                                                        <input type="radio" name="type" class="form-control" [value]=true [disabled]="isEdit && !isRecCustomer" [(ngModel)]="workOrderGeneralInformation.isSinglePN">
                                                        <span class="checkmark"></span>  Single MPN
                                                    </label>
                                                </div>
                                                <div class="pull-left" style="margin-top: 4px; margin-right: 15px;">
                                                    <label class="radio-cstm wauto" [ngClass]="{pointerEvents : workOrderGeneralInformation.isRecCustomer || isEdit}">
                                                        <input type="radio" name="type" class="form-control" [value]=false [disabled]="isEdit && !isRecCustomer"  [(ngModel)]="workOrderGeneralInformation.isSinglePN">
                                                        <span class="checkmark"></span>  Multiple MPN
                                                    </label>
                                                </div>
                                            </div>  -->
                                        </div>
                                        <div class="col-md-6">
                                            <div *ngFor="let workOrderType of workOrderTypes" class="align-row">
                                                <label matTooltipPosition="above" matTooltip="Work Order Type"
                                                   class="wauto" [ngClass]="{pointerEvents : workOrderGeneralInformation.isRecCustomer || isEdit}">
                                                    <input type="radio" class="radio_adjust" name="work-type"
                                                        [value]="workOrderType.id"
                                                        (click)="woDealerChange($event.target.value)"
                                                        [checked]="workOrderGeneralInformation.workOrderTypeId == workOrderType.id"
                                                        (change)="selectedCustomerType()"
                                                        
                                                        >
                                                    {{workOrderType.description}}
                                                </label>
                                                  </div>
                                                <!-- [ngClass]="{pointerEvents : workOrderGeneralInformation.isRecCustomer || isEdit}" -->
                                        
                                        
                                                <!-- <div class="form-group"> 
                                                    <div *ngFor="let workOrderType of workOrderTypes" class="pull-left align-row" style="margin-top: 4px; margin-right: 15px;">
                                                        <label class="radio-cstm wauto" [ngClass]="{pointerEvents : workOrderGeneralInformation.isRecCustomer || isEdit}" matTooltipPosition="above" matTooltip="{{workOrderType.description}}"
                                                        style="width: auto;">
                                                            <input type="radio" name="type" class="form-control"  [value]="workOrderType.id"
                                                            (click)="woDealerChange($event.target.value)"
                                                            [(ngModel)]="workOrderGeneralInformation.workOrderTypeId == workOrderType.id"
                                                            (change)="selectedCustomerType()">
                                                            <span class="checkmark"></span>  {{workOrderType.description}}
                                                        </label>
                                                    </div>
                                        </div> -->
                                        
                                        
                                          

                                        </div>
                                    </div>
                                    <div class="clear"></div>
                                    <hr>
                                    <div class="form-row">
                                        <div class="col-md-6 main_ar">
                                            <div class="form-row">
                                                <div class="col-md-6">
                                                    <div class="form-group ">
                                                        <label for="workflownum">
                                                            WO Num
                                                        </label>
                                                        <input class="form-control" matTooltipPosition="above"
                                                            type="text" name="workOrderNumber"
                                                            #workOrderNumber="ngModel" disabled
                                                            [(ngModel)]="workOrderGeneralInformation.workOrderNumber"
                                                            matTooltip="This field should display 'creating' before the header info is saved WO ID should be autogenerated.  Allow siffices or prefeices depending on what config in the WO setup screen" />
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="opendate">
                                                            Open Date <span class="clr-red">*</span>
                                                        </label>
                                                        <p-calendar [showIcon]="true" class="calender-cstm"
                                                        [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"
                                                            name="openDate" #openDate="ngModel" required (ngModelChange)="getmemo($event)"
                                                            [(ngModel)]="workOrderGeneralInformation.openDate" [disabled]="isView" appendTo="body">
                                                        </p-calendar>
                                                    </div>
                                                    <div class="form-group">
                                                        <label for="credit" class="width-100">
                                                            WO Status
                                                            <span class="clr-red">*</span>
                                                        </label>
                                                        <input class="form-control" matTooltipPosition="above" required
                                                            type="text" name="WoSatus" #contactName="ngModel" disabled
                                                            [ngModel]="workOrderNumberStatus" />
                                                    </div>
                                                    <div class="form-group memo-popup-cstm">
                                                        <label>
                                                            Notes <i class="fa fa-pencil" *ngIf="!isView" data-toggle="modal" data-target="#add-description"
                                                                matTooltipPosition="above" matTooltip="Notes"
                                                                (click)="onAddDescription(1)"></i>
                                                        </label>
                                                        <span>
                                                            <div class="form-group memo-popup-cstm mat_emo">
                                                                <div [innerHTML]="workOrderGeneralInformation.notes"
                                                                    [matTooltip]="parsedText(workOrderGeneralInformation.notes)"
                                                                    matTooltipPosition="above"
                                                                    class="form-control text_editor_box memo_cehck1">
                                                                </div>
                                                            </div>
                                                        </span>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group">
                                                        <label for="customername"> 
                                                            Customer Name
                                                            <span class="clr-red">*</span>
                                                            <span
                                                                *ngIf="workOrderGeneralInformation.customerId !== null ">
                                                                <a matTooltipPosition="above"
                                                                    matTooltip="Customer Email: {{workOrderGeneralInformation.customerId.customerEmail}}, Customer Phone: {{workOrderGeneralInformation.customerPhoneNo}}"
                                                                    (click)="viewCustomerDetails(workOrderGeneralInformation.customerId.customerId)">
                                                                    <i class="fa fa-eye view_icon_adjust"></i>
                                                                </a>
                                                            </span>
                                                        </label>
                                                        <p-autoComplete field="customerName"
                                                            [(ngModel)]="workOrderGeneralInformation.customerId"
                                                            name="customerName" errorMessage="Records not found"
                                                            [forceSelection]="true"
                                                            (onSelect)="selectCustomer($event, workOrderGeneralInformation ,'formHtml')"
                                                            [suggestions]="customerNamesList"
                                                            (completeMethod)="filterCustomerName($event)"
                                                            (onClear)="clearautoCompleteInput(workOrderGeneralInformation, 'customerId' )"
                                                            [size]="30" [minLength]="1" #customerName="ngModel" required
                                                            [dropdown]="true" class="p-autoComplete-ctsm"
                                                            [disabled]="workOrderGeneralInformation.isRecCustomer || isView || isEdit">
                                                        </p-autoComplete>

                                                        <div *ngIf="customerName.invalid && (customerName.dirty || customerName.touched)"
                                                            class="alert alert-danger alert-danger-cstm">
                                                            <div *ngIf="customerName.errors.required">
                                                                <small> Customer Name is required </small>
                                                            </div>
                                                        </div>

                                                        <div class="clear"></div>

                                                    </div>
                                                    <div class="form-group">
                                                        <label>Contact Name<span class="text-danger">*</span></label>

                                                        <!-- {{myCustomerContact|json}} -->
                                                        <input type="text" *ngIf="isView" class="form-control" name="customercontact"  [(ngModel)]="workOrderGeneralInformation.customerContact"  disabled>
                                                        <p-autoComplete *ngIf="!isView"
                                                            (onSelect)="onSelectCustomerContact(myCustomerContact)"
                                                            field="customerContact" class="pautocomp-cstm"
                                                            [(ngModel)]="myCustomerContact" name="customerContactId"
                                                            [suggestions]="customerContactInfo"
                                                            (completeMethod)="filterCustContacts($event)" [size]="30"
                                                            [minLength]="1" [dropdown]="true" (ngModelChange)="getmemo($event)"
                                                            errorMessage="Records not found" [forceSelection]="true"
                                                            #cusContact="ngModel" required [disabled]="isView"></p-autoComplete>
                                                    </div>
                                                    <div class="form-group ">
                                                        <label for="workflownum">
                                                            Contact Phone
                                                        </label>
                                                        <input class="form-control" matTooltipPosition="above"
                                                            type="text" name="customerPhoneNo" #contactPhone="ngModel"
                                                            disabled
                                                            [(ngModel)]="workOrderGeneralInformation.customerPhoneNo" />
                                                    </div>
                                                    <div class="form-group ">
                                                        <label for="workflownum">
                                                           Warning
                                                        </label>
                                                        <input class="form-control" matTooltipPosition="above"
                                                            type="text" name="warningMessag" #adminUsername="ngModel"
                                                            disabled
                                                            [(ngModel)]="currentWarningMessage" />
                                                    </div>
                                                </div>
                                                <!-- <div class="col-md-12 max_alf">
                                                    <label for="notes">
                                                        Notes
                                                    </label>
                                                    <textarea class="form-control text-area-cstm m-0" (ngModelChange)="getmemo($event)" rows="2" cols="50"
                                                        [(ngModel)]="workOrderGeneralInformation.notes" name="notes"
                                                        [disabled]="isView"></textarea>
                                                </div> -->
                                            </div>

                                        </div>

                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label for="credit">
                                                    Credit Limit &amp; Term
                                                    <span class="clr-red">*</span>
                                                </label>
                                                <div class="col-md-12 set_padNone">
                                                    <div class="col-md-6">
                                                        <input type="text" class="form-control wo-input text_right"
                                                            name="creditLimit" #creditLimit="ngModel"
                                                            [(ngModel)]="workOrderGeneralInformation.creditLimit"
                                                            required [readonly]="true">
                                                    </div>

                                                    <div class="col-md-6">
                                                        <input type="text" class="form-control wo-input"
                                                            name="creditTerm" #creditTerm="ngModel"
                                                            [(ngModel)]="workOrderGeneralInformation.creditTerm"
                                                            required [readonly]="true">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group p-t-10" style="clear: both;">

                                                <label for="employee">
                                                    Salesperson / Agent
                                                </label>

                                                <p-autoComplete field="name"
                                                    [(ngModel)]="workOrderGeneralInformation.salesPerson"
                                                    name="salesPerson" #salesPerson="ngModel"
                                                    errorMessage="Records not found" [forceSelection]="true"
                                                    [dropdown]="true" [suggestions]="salesPersonList" (ngModelChange)="getmemo($event)"
                                                    (completeMethod)="filterSalesPerson($event)"
                                                    (onClear)="clearautoCompleteInput(workOrderGeneralInformation, 'salesPersonId' )"
                                                    [size]="30" [minLength]="1" [dropdown]="true"
                                                    class="p-autoComplete-ctsm" [disabled]="isView">
                                                </p-autoComplete>
                                            </div>
                                            <div class="form-group ">
                                                <label for="customercontact">
                                                    CSR
                                                </label>
                                                <p-autoComplete field="name"
                                                    [(ngModel)]="workOrderGeneralInformation.csr" name="csr"
                                                    #csr="ngModel" errorMessage="Records not found" (ngModelChange)="getmemo($event)"
                                                    [forceSelection]="true" [dropdown]="true" [suggestions]="csrList"
                                                    (completeMethod)="filterCsr($event)"
                                                    (onClear)="clearautoCompleteInput(workOrderGeneralInformation, 'csr' )"
                                                    [size]="30" [minLength]="1" class="p-autoComplete-ctsm" [disabled]="isView">
                                                </p-autoComplete>
                                            </div>

                                            <div class="form-group ">
                                                <label for="employee">
                                                    Employee
                                                </label>
                                                <!-- <p-autoComplete field="name"
                                                    [(ngModel)]="workOrderGeneralInformation.woEmployee"
                                                    name="employees" #employees="ngModel" (ngModelChange)="getmemo($event)"
                                                    errorMessage="Records not found" [forceSelection]="true"
                                                    [dropdown]="true" [suggestions]="employeeList"
                                                    (completeMethod)="filterEmployee($event)"
                                                    (onClear)="clearautoCompleteInput(workOrderGeneralInformation, 'employeeId' )"
                                                    [size]="30" [minLength]="1" [dropdown]="true"
                                                    class="p-autoComplete-ctsm" [disabled]="isView">
                                                </p-autoComplete> -->
                                                <input type="text" class="form-control wo-input"
                                                            name="woEmployee" #woEmployee="ngModel"
                                                            [(ngModel)]="workOrderGeneralInformation.woEmployee"
                                                            required [readonly]="true">
                                            </div> 
                                        </div>
                                        <div class="col-md-3">
                                            <!-- <div class="form-group">
                                                <label for="memo">Memo</label>
                                                <textarea class="form-control" rows="4" cols="50"
                                                    style="height: 190px !important;" (ngModelChange)="getmemo($event)"
                                                    [(ngModel)]="workOrderGeneralInformation.memo" name="memo"
                                                    [disabled]="isView"></textarea>
                                            </div> -->
                                            <div class="form-group memo-popup-cstm">
                                                <label>
                                                    Memo <i *ngIf="!isView" class="fa fa-pencil" data-toggle="modal" data-target="#add-description"
                                                        matTooltipPosition="above" matTooltip="Memo"
                                                        (click)="onAddDescription(2)"></i>
                                                </label>
                                                <span>
                                                    <div class="form-group memo-popup-cstm mat_emo">
                                                        <div [innerHTML]="workOrderGeneralInformation.memo"  matTooltipPosition="above"
                                                            [matTooltip]="parsedText(workOrderGeneralInformation.memo)" 
                                                           
                                                            class="form-control text_editor_box memo_cehck1 adjust_he">
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="footer_adjust" *ngIf="isEdit && !isRecCustomer && !isView">
                                        <button class="btn btn-primary pull-right" type="button"
                                            [disabled]="!workOrderForm.valid || disableSaveForEdit" (click)="saveWorkOrder()">
                                            Update
                                        </button>
                                        <button class="btn btn-primary pull-right"
                                            *ngIf="(!showTabsGrid && !isEdit) || isRecCustomer" type="button"
                                            [disabled]="!workOrderForm.valid" (click)="saveWorkOrder()">
                                            Save
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div *ngIf="!workOrderGeneralInformation.isSinglePN && workOrderId">
                        <app-common-wo-summarization [workOrderId]="workOrderId"  [savedWorkOrderData]="savedWorkOrderData" [mpnPartNumbersList]="mpnPartNumbersList" [employeesOriginalData]="employeesOriginalData" [taskList]="taskList" [workOrderWorkFlowOriginalData]="workOrderWorkFlowOriginalData" [customerContactList]="customerContactList" [defaultTab]="defaultTab" (resetSelectedTab)="resetSelectedTab()"></app-common-wo-summarization>
                    </div>
                    <div *ngIf="!hideWOHeader && !isView">
                        <button *ngIf="!workOrderGeneralInformation.isSinglePN && !workOrderQuoteId"
                            class="btn btn-primary pull-right addMPN_details" (click)="addMPN()">
                            Add MPN
                        </button>
                    </div>
                    <div>
                    </div>
                    <div class=" wid_cal"  *ngIf="!isSubWorkOrder">
                        <div >
                    <div class="table-responsive add-wo-grid pas-table-cstm poro-table-cstm parts-list-table-align" *ngIf="!hideWOHeader">
                        <div class="tableFixHead">
                        <table class="table table-bordered lastcol-fix mpn-list-table header-table-width"
                            id="mpn-list-table">
                            <thead>
                                <tr>
                                    <th rowspan="2">MPN <span class="clr-red">*</span></th>
                                    <th rowspan="2">MPN Description <span class="clr-red">*</span></th>
                                    <th rowspan="2" >Revised MPN</th>
                                    <th rowspan="2" style="width:130px !important">Serial Num </th>
                                    <th rowspan="2" style="min-width:60px !important">Qty</th>
                                    <th rowspan="2">Rec'd Date</th>
                                    <th rowspan="2">Cust Req Date <span class="clr-red">*</span></th>
                                    <th rowspan="2">Promised Date <span class="clr-red">*</span></th>
                                    <th rowspan="2">Est. Comp Date <span class="clr-red">*</span></th>
                                    <th rowspan="2">Est. Ship Date <span class="clr-red">*</span></th>
                                    <th rowspan="2">Stage <span class="clr-red">*</span></th>
                                    <th rowspan="2">Status <span class="clr-red">*</span></th>
                                    <th rowspan="2">Tech Name</th>
                                    <th rowspan="2">Station ID</th>
                                    <th rowspan="2">Work Scope <span class="clr-red">*</span></th>
                                    <th rowspan="2">Priority <span class="clr-red">*</span></th>
                                    <th rowspan="2">Cond <span class="clr-red">*</span></th>
                                    <th rowspan="2">CMM/Pub Ref</th>
                                    <th rowspan="2">Workflow ID </th>
                                    <th rowspan="2" style="width:130px !important">Item Group</th>
                                    <th rowspan="2">Cust Ref</th>
                                    <th rowspan="2" style="min-width:60px !important" *ngIf="workOrderGeneralInformation.workOrderTypeId==1">Contract</th>
                                    <th rowspan="2" *ngIf="workOrderGeneralInformation.workOrderTypeId==1"
                                        style="min-width: 80px !important;">Contract No</th>
                                        <th rowspan="2" style="width:130px !important">Stk Line </th>
                                  
                                    <th rowspan="2" style="min-width:60px !important">NTE</th>
                              
                                    <th colspan="2">Restrictions</th>
                                  
                                    <th rowspan="2" style="display:none">Tear Down Report</th>
                                    <th colspan="2">TAT (Days)</th>
                                    <th rowspan="2" colspan="4">Management Structure </th>
                                    <th rowspan="2" class="table-column-icon-width">Action</th>
                                </tr>
                                <tr>
                                    <th style="min-width:60px !important">PMA</th>
                                    <th style="min-width:60px !important">DER</th>
                                    <th style="min-width:60px !important">Current</th>    
                                    <th style="z-index:1;min-width:60px !important">Standard</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="mpn-row" style="display: table-row;"
                                    *ngFor="let workOrderPartNumber of workOrderGeneralInformation.partNumbers; let i=index;">
                                    <td>
                                        <!-- workOrderQuoteId -->
                                        <p-autoComplete field="partNumber"
                                                        [(ngModel)]="workOrderPartNumber.masterPartId" name="mpn{{i}}" 
                                                        #mpn="ngModel" errorMessage="Records not found" [forceSelection]="true"
                                                        [dropdown]="true" [suggestions]="partNumberList" (ngModelChange)="getValid()"
                                                        (onSelect)="onSelectedPartNumber($event, workOrderPartNumber, i); getWorkFlowByPNandScope(workOrderPartNumber); getStockLineByItemMasterIdOnChangePN(workOrderPartNumber,i);"
                                                        (completeMethod)="filterPartNumber($event)" emptyMessage=" "
                                                        (onClear)="clearautoCompleteInput(workOrderPartNumber, 'masterPartId' )"
                                                        [size]="30" [minLength]="1"
                                                        class="p-autoComplete-ctsm custome_automo p-autocomplete-mh120" required [disabled]="isView || quotestatusofCurrentPart =='Approved'"  appendTo="body">
                                        </p-autoComplete>
                                    </td>
                                    <td>
                                        <input type="text" class="form-control  w150" name="description{{i}}"
                                               #description="ngModel" [(ngModel)]="workOrderPartNumber.description"
                                               required disabled>
                                    </td>
                                    <td> 
                                        <input type="text" class="form-control w100" name="revisedPartNo{{i}}"
                                               #description="ngModel" class="width-100" [(ngModel)]="workOrderPartNumber.revisedPartNo"
                                               disabled>
                                    </td>
                                    <td>
                                        <input type="text" class="form-control w100 width-100" name="serialNumber{{i}}"
                                               #serialNumber="ngModel" [(ngModel)]="workOrderPartNumber.serialNumber"
                                               disabled>
                                    </td>
                                    <td>
                                        <input type="number"  class="form-control w100 text_right width-100" name="quantity{{i}}"
                                               [(ngModel)]="workOrderPartNumber.quantity" disabled>
                                    </td>
                                    <td>
                                        <p-calendar [showIcon]="true" name="receivedDate{{i}}" class="calender-cstm"
                                        [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"  (ngModelChange)="getValid()"
                                                    #receivedDate="ngModel" [(ngModel)]="workOrderPartNumber.receivedDate"
                                                    disabled appendTo="body"> 
                                        </p-calendar>
                                    </td>
                                    <td>
                                        <p-calendar [showIcon]="true" name="customerRequestDate{{i}}"
                                        [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"
                                                    class="calender-cstm" #customerRequestDate="ngModel"  (ngModelChange)="getValid()"
                                                    [(ngModel)]="workOrderPartNumber.customerRequestDate"
                                                    [minDate]="workOrderPartNumber.receivedDate" required [disabled]="isView || quotestatusofCurrentPart =='Approved'"  appendTo="body"></p-calendar>
                                    <td>
                                        <p-calendar [showIcon]="true" name="promisedDate{{i}}" class="calender-cstm"
                                        [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"  (ngModelChange)="getValid()"
                                                    #promisedDate="ngModel" [(ngModel)]="workOrderPartNumber.promisedDate"
                                                    [minDate]="workOrderPartNumber.receivedDate" required [disabled]="isView || quotestatusofCurrentPart =='Approved'"  appendTo="body">
                                        </p-calendar>
                                    <td>
                                        <p-calendar [showIcon]="true" name="estimatedCompletionDate{{i}}"
                                                    class="calender-cstm" #estimatedCompletionDate="ngModel"
                                                    [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"
                                                    [minDate]="workOrderPartNumber.promisedDate"   [maxDate]="workOrderPartNumber.estimatedShipDate" (ngModelChange)="getValid()"
                                                    [(ngModel)]="workOrderPartNumber.estimatedCompletionDate" required [disabled]="isView || quotestatusofCurrentPart =='Approved'"  appendTo="body">
                                        </p-calendar>
                                    </td>
                                    <td>
                                        <p-calendar [showIcon]="true" class="calender-cstm"
                                                    name="estimatedShipDate{{i}}"  (ngModelChange)="getValid()"
                                                    [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"
                                                    [(ngModel)]="workOrderPartNumber.estimatedShipDate"
                                                    [minDate]="workOrderPartNumber.receivedDate" #estimatedShipDate="ngModel"
                                                    required [disabled]="isView || quotestatusofCurrentPart =='Approved'"  appendTo="body"></p-calendar>
                                    </td>

                                    <td>
                                        <p-dropdown filter="true" [options]="workOrderStagesList" name="stage{{i}}" #stage="ngModel"  (ngModelChange)="getValid()"
                                                    placeholder="Select" class="p-dropdown-custom-md p-dropdown-mh120"
                                                    (onChange)="selectedStage($event.value,workOrderPartNumber,i)"
                                                    [(ngModel)]="workOrderPartNumber.workOrderStageId" required [disabled]="isView || quotestatusofCurrentPart =='Approved'" appendTo="body">
                                        </p-dropdown>
                                    </td>
                                    <td>
                                        <p-dropdown filter="true" [options]="workOrderStatusList" placeholder="Select"
                                                    name="status{{i}}" #status="ngModel"
                                                    class="p-dropdown-custom-md custome_pd-totext p-dropdown-mh120"
                                                    [(ngModel)]="workOrderPartNumber.workOrderStatusId" disabled required appendTo="body">
                                        </p-dropdown>
                                        <!-- <span>{{workOrderPartNumber.workOrderStatus}}</span> -->
                                    </td>
                                    <td>
                                        <p-autoComplete field="name" [(ngModel)]="workOrderPartNumber.partTechnicianId"
                                                        name="technician{{i}}" #technician="ngModel"  (ngModelChange)="getValid()"
                                                        errorMessage="Records not found" [forceSelection]="true" [dropdown]="true"
                                                        [suggestions]="technicianList" required
                                                        (onSelect)="onSelectedTechnician($event, workOrderPartNumber);"
                                                        (completeMethod)="filterTechnician($event)"
                                                        (onClear)="clearautoCompleteInput(workOrderPartNumber, 'partTechnicianId' )"
                                                        [size]="30" [minLength]="1"
                                                        class="p-autoComplete-ctsm custome_automo p-autocomplete-mh120"
                                                       [disabled]="isView || quotestatusofCurrentPart =='Approved'" appendTo="body">

                                        </p-autoComplete>
                                    </td>
                                    <td>
                                        <p-dropdown filter="true" placeholder="Select" name="techStation{{i}}" #techStatsion="ngModel"  (ngModelChange)="getValid()"
                                                    [options]="techStationList" class="p-dropdown-custom-md p-dropdown-mh120"
                                                    [(ngModel)]="workOrderPartNumber.techStationId"[disabled]="isView || quotestatusofCurrentPart =='Approved'" appendTo="body">
                                        </p-dropdown>
                                    </td>
                                    <td>
                                        <p-dropdown filter="true" placeholder="Select" name="scope{{i}}" #scope="ngModel"
                                        [options]="workScopesList" class="p-dropdown-custom-md p-dropdown-mh120"  (ngModelChange)="getValid()"
                                        [(ngModel)]="workOrderPartNumber.workOrderScopeId" [disabled]="isView || quotestatusofCurrentPart =='Approved'"
                                        (onChange)="getWorkFlowByPNandScope($event.value,workOrderPartNumber,'html',i)" required appendTo="body">
                            </p-dropdown>
                                    </td>
                                    <td>
                                        <p-dropdown filter="true" [options]="priorityList" placeholder="Select" name="priority{{i}}"
                                                    #priority="ngModel" class="p-dropdown-custom-md p-dropdown-mh120"  (ngModelChange)="getValid()"
                                                    [(ngModel)]="workOrderPartNumber.workOrderPriorityId" required [disabled]="isView || quotestatusofCurrentPart =='Approved'" appendTo="body">
                                        </p-dropdown>
                                    </td>
                                    <td>
                                        <p-dropdown filter="true" placeholder="Select" [options]="conditionList"  (ngModelChange)="getValid()"
                                                    name="condition{{i}}" #condition="ngModel" (onChange)="selectedCondition($event.value,workOrderPartNumber,i)"
                                                    class="p-dropdown-custom-md" [(ngModel)]="workOrderPartNumber.conditionId" required [disabled]="isView || quotestatusofCurrentPart =='Approved'" appendTo="body">
                                        </p-dropdown>
                                     </td>
                                     <td>
                                        <p-dropdown filter="true" class="min_selct_height" name="cmm{{i}}" #cmm="ngModel"  (ngModelChange)="getValid()"
                                                    [options]="cmmList" class="p-dropdown-custom-md p-dropdown-mh120"
                                                    [(ngModel)]="workOrderPartNumber.cmmId" [disabled]="isView || quotestatusofCurrentPart =='Approved'" appendTo="body">
                                        </p-dropdown>
                                    </td>
                                    <td>
                                        <span class="inline-block">
                                            <p-dropdown filter="true" [options]="workFlowList" name="workFlow{{i}}"
                                                        #workFlow="ngModel" class="p-dropdown-custom-md p-dropdown-mh120"  (ngModelChange)="getValid()"
                                                        [(ngModel)]="workOrderPartNumber.workflowId" [disabled]="isView || quotestatusofCurrentPart =='Approved'" appendTo="body">
                                            </p-dropdown>
                                        </span>
                                    </td>
                                    <td>
                                        <input type="text" class="form-control w100" name="itemGroup{{i}}"
                                               #description="ngModel" class="width-100" [(ngModel)]="workOrderPartNumber.itemGroup"
                                               disabled>
                                    </td>
                                  
                                   
                                    <td>
                                        <p class="managemnt_Wdt" matTooltipPosition="above"
                                        [matTooltip]="parsedText(workOrderPartNumber.level1)">{{workOrderPartNumber.customerReference}}</p>
                                   </td>
                                   <td *ngIf="this.workOrderGeneralInformation.workOrderTypeId==1" class="text_center" >
                                    <input type="checkbox" name="contract {{i}}" #contract="ngModel"  (ngModelChange)="getValid()" 
                                           class="form-control w60 width-100" [(ngModel)]="workOrderPartNumber.isMPNContract" disabled>
                                    <!-- <span class="cr"><i class="cr-icon pi pi-check"></i></span> Contract -->
                                </td>
                                <td>
                                    <!-- {{workOrderPartNumber.contractNo}} -->
                                    <input type="text" name="contract1{{i}}" class="form-control w100 width-100"
                                           [(ngModel)]="workOrderPartNumber.contractNo"  (ngModelChange)="getValid()"
                                           [required]="workOrderPartNumber.isMPNContract"
                                           [disabled]="!workOrderPartNumber.isMPNContract">
                                </td>
                                <td>
                                    <input type="text" class="form-control w100 width-100" name="stockLineNumber{{i}}"
                                           #serialNumber="ngModel" [(ngModel)]="workOrderPartNumber.stockLineNumber"
                                           disabled>
                                </td>
                                    <td>
                                        <input type="text" class="form-control w50 width-100"
                                               [(ngModel)]="workOrderPartNumber.nte" name="nte{{i}}" #nte="ngModel"
                                              >
                                    </td>
                                   
                                    
                                   
                                  
                                  
                                   
                                  
                                    
                                    <td class="text_center">
                                        <input type="checkbox" class="form-control w60 pointer_event_none" name="isPMA{{i}}"
                                               #isPMA="ngModel" [(ngModel)]="workOrderPartNumber.isPMA" >
                                    </td>
                                    <td class="text_center">
                                        <input type="checkbox" class="form-control w60 pointer_event_none" name="isDER{{i}}"
                                               #isDER="ngModel" [(ngModel)]="workOrderPartNumber.isDER" >

                                    </td>
                                    <td>
                                        <input type="number" class="form-control w50" name="tatDaysCurrent{{i}}"
                                               #tatDaysCurrent="ngModel" [(ngModel)]="workOrderPartNumber.tatDaysCurrent"
                                               disabled>
                                    </td>
                                    <td>
                                        <input type="number" class="form-control w50" name="tatDaysStandard{{i}}"
                                               #tatDaysStandard="ngModel" [(ngModel)]="workOrderPartNumber.tatDaysStandard"
                                               disabled>
                                    </td>
                                    <td>
                                        <p class="managemnt_Wdt" matTooltipPosition="above"
                                        [matTooltip]="parsedText(workOrderPartNumber.level1)">{{workOrderPartNumber.level1}}</p>
                                   </td>
                                    <td>
                                        <p class="managemnt_Wdt" matTooltipPosition="above"
                                        [matTooltip]="parsedText(workOrderPartNumber.level2)">{{workOrderPartNumber.level2}}</p>
                                     </td>
                                    <td>
                                        <p class="managemnt_Wdt" matTooltipPosition="above"
                                        [matTooltip]="parsedText(workOrderPartNumber.level3)">{{workOrderPartNumber.level3}}</p>
                                    </td>
                                    <td>
                                        <p class="managemnt_Wdt" matTooltipPosition="above"
                                        [matTooltip]="parsedText(workOrderPartNumber.level4)">{{workOrderPartNumber.level4}}</p>
                                    </td>
                                    <td *ngIf="!isView" class="table-column-icon-width"> 
                                        <span *ngIf="!workOrderGeneralInformation.isSinglePN " class="delete-row-btn" >
                                            <!-- <a class="btn btn-danger boxed-float-btn nobg"  (click)="openDelete(content,i)" [disabled]="workOrderQuoteId"
                                               matTooltipPosition="above" matTooltip="Delete" >
                                                <i class="fa fa-trash"></i> 
                                            </a>  -->

                                            <button type="button" class="btn nobg btn-delete-cstm" (click)="openDelete(content,i)"  [disabled]="quotestatusofCurrentPart =='Approved' || workOrderPartNumber==false" matTooltip="Delete" matTooltipPosition="above">
                                                <i class="fa fa-trash"></i>
                                            </button> </span>
             
                                        <span *ngIf="workOrderGeneralInformation.isSinglePN ">
                                         
                                            <button type="button" class="btn nobg btn-delete-cstm" disabled>
                                                <i class="fa fa-trash" ></i>
                                            </button> 
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        </div>
                    </div>
                    <div class="footer_adjust" *ngIf="!hideWOHeader && !isView">
                        <button class="btn btn-primary pull-right" *ngIf="(!showTabsGrid && !isEdit) || isRecCustomer"
                            type="button" [disabled]="!workOrderForm.valid || checkworkscope() || checkTechnician()" (click)="saveWorkOrder()">
                            Save
                        </button>
                        <!-- !workOrderForm.valid || -->
                        <button class="btn btn-primary pull-right" *ngIf="isEdit && !isRecCustomer" type="button"
                            [disabled]=" disableSaveForPart || !workOrderForm.valid || checkTechnician()" (click)="saveWorkOrder()">
                            Update 
                        </button>
                        <button *ngIf="showTabsGrid && !isView" class="btn btn-primary pull-right" (click)="createQuote()">
                            {{(workOrderQuoteId)?'Edit Quote':'Create Quote'}}
                        </button>
                    </div>
                    </div>
                    </div>

                    <ng-template #content let-c="close" let-d="dismiss" data-backdrop="static">
                        <div class="modal-header">
                            <h4 class="modal-title">Are You Sure Want to Delete?</h4>
                            <button type="button" class="close" aria-label="Close" (click)="dismissModel()">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                    
                        <div class="modal-body">
                            <!-- <strong>
                                Receiving Num:
                                <span class="new-label">{{selectedRowForDelete.receivingNumber}}</span>
                            </strong> -->
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" (click)="deleteMPN()">Yes</button>
                            <button type="button" class="btn btn-danger" (click)="dismissModel()">No</button>
                        </div>
                    </ng-template>
            
            </div>
        </form>
        <div class="modal fade" id="add-description" role="dialog" data-backdrop="static" data-keyboard="false">
            <div class="modal-dialog modal-sm" >
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Edit {{type==1 ? 'Notes' : 'Memo'}}</h4>
                    </div> 
                    <div class="modal-body">
                        <p-editor [(ngModel)]="tempMemo" (ngModelChange)="memoValidate()" [style]="{'height':'320px'}" name="tempMemo"
                        required>
                    </p-editor>
                    </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary editor-buttons-margin" data-dismiss="modal" 
                            [disabled]="disableForMemo"
                                (click)="onSaveDescription()">
                                Save
                            </button>
                            <button type="button" class="btn btn-danger editor-buttons-margin" data-dismiss="modal">
                                Close
                            </button>
                        </div>
                    
                </div>
            </div>
        </div>
    </div>
    <div class="card mn-t7" *ngIf="showTabsGrid" >
        <div *ngIf="showTabsMPNGrid">
            <div class="card-header" *ngIf="!workOrderGeneralInformation.isSinglePN">
                Multiple MPN
            </div>
            <div class="card-body">
                <div class="col-md-12" [hidden]="workOrderGeneralInformation.isSinglePN && !showTabsGrid">
                    <div class="col-md-2">
                        <label class="control-label col-sm-3 label_adjf">MPN
                        </label>
                        <div class="col-sm-7">
                            <p-dropdown [options]="mpnPartNumbersList" name="partNumber" #partNumber="ngModel"
                                placeholder="Select Part Number" (onChange)="changeofMPN($event.value)"
                                class="p-dropdown-custom-md" [(ngModel)]="selectedMPN">
                            </p-dropdown>
                        </div>
                    </div>
                    <div class="col-md-10 mpn-grid" *ngIf="mpnGridData">
                        <div class="col-md-3">
                            <label class="fs12">Description : </label>
                            <span>{{mpnGridData.description}}</span>
                        </div>
                        <div class="col-md-2">
                            <label class="fs12">Workscope : </label>
                            <span>{{mpnGridData.workscope}}</span>
                        </div>
                        <div class="col-md-2">
                            <label class="fs12">NTE : </label>
                            <span>{{mpnGridData.nte}}</span>
                        </div>

                        <div class="col-md-1">
                            <label class="fs12">Qty :</label>
                            <span class="text_right">{{mpnGridData.qty}}</span>
                        </div>
                        <div class="col-md-2">
                            <label class="fs12 stage-align">Stage : </label>
                            <span>{{mpnGridData.stage}}</span>
                        </div>
                        <div class="col-md-2">
                            <label class="fs12">Priority :</label>
                            <span>{{mpnGridData.priority}}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="card-body" *ngIf="showGridMenu" style="padding: 0px;">
            <div class="col-md-2" *ngIf="isSubWorkOrder==true">
  <label class="control-label col-sm-3 label_adjf" >MPN
  </label>
  <div class="col-sm-7">
      <p-dropdown [options]="mpnDropdownList"  name="subWOPartNoId" #subWOPartNoId="ngModel"
          placeholder="Select Part Number" (onChange)="changeofMPNForSubWo($event.value)"
          class="p-dropdown-custom-md" [(ngModel)]="selectedMPNSubWo">
      </p-dropdown>
  </div>
</div>
            <div class="card col-md-12 div_bsck" >
                <!--#f1f1f1-->
                <ul class="nav nav-pills nav-pills-cstm back_filsd wo_td margin-top-2" id="pills-tab" role="tablist"
                   *ngIf="!hideWOHeader">

                    <li class="nav-item" *ngIf="isSubWorkOrder">
                        <a id="pills-home-tab" role="tab" aria-controls="pills-home" aria-selected="true"
                            [ngClass]="{active : gridActiveTab === 'workOrderMain'}"
                            (click)="gridTabChange('workOrderMain');  ">WorkOrder Main</a>
                    </li>
                    <li class="nav-item dropdown" *ngIf="workFlowId !==0">
                        <!-- <p-splitButton [label]="showWorkflowLabel" [model]="wflowitems"></p-splitButton> -->
                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                            aria-expanded="false"
                            [ngClass]="{active : gridActiveTab === 'workFlow' ||  subTabWorkFlow === 'editworkFlow' || subTabWorkFlow === 'createworkFlow' || subTabWorkFlow === 'viewworkFlow'  }">Workflow</a>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" (click)="subTabWorkFlowChange('viewworkFlow');">View WF</a>
                            <a class="dropdown-item" (click)="subTabWorkFlowChange('editworkFlow')" *ngIf="!isView">
                                Edit
                                Existing WF
                            </a>
                            <div class="dropdown-divider"></div>
                        </div>
                    </li>
                    <li class="nav-item">
                        <a id="pills-contact-tab" role="tab" [ngClass]="{active : gridActiveTab === 'materialList'}"
                            (click)="gridTabChange('materialList'); ">
                            Material
                            List
                        </a>
                    </li>
                    <li class="nav-item">
                        <a id="pills-home-tab" role="tab" aria-controls="pills-home" aria-selected="true"
                            [ngClass]="{active : gridActiveTab === 'labor'}"
                            (click)="gridTabChange('labor');  ">Labor</a>
                    </li>
                    <li class="nav-item">
                        <a id="pills-profile-tab" role="tab" aria-controls="pills-profile"
                            [ngClass]="{active : gridActiveTab === 'equipment'}"
                            (click)="gridTabChange('equipment');">Tools</a>
                    </li>
                    <!-- <li class="nav-item" [hidden]="workOrderGeneralInformation.isSinglePN">
                        <a id="pills-contact-tab" role="tab" aria-controls="pills-contact"
                            [ngClass]="{active : gridActiveTab === 'quote'}" (click)="gridTabChange('quote')">Quote</a>
                    </li> -->
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                            [ngClass]="{active : gridActiveTab === 'main'}" (click)="gridTabChange('main')">
                            Main
                            Component
                        </a>
                        <div class="dropdown-menu">
                            <!-- <a class="dropdown-item" (click)="mainComponentTabSelected('existingRO')">
                                Add to an
                                Existing RO
                            </a> -->
                            <a class="dropdown-item" (click)="mainComponentTabSelected('createNewRO')">
                                 RO
                            </a>
                            <!-- Create  New RO -->
                            <a class="dropdown-item" (click)="mainComponentTabSelected('interOrexternal')">
                                Convert Internal to
                                External
                            </a>
                            <a class="dropdown-item" (click)="mainComponentTabSelected('returnMCToCustomer')">
                                Return MC to Customer
                            </a>
                            <!-- <a class="dropdown-item" (click)="mainComponentTabSelected('returnmc')">
                                Return MC to
                                Customer  
                            </a> -->

                        </div>
                    </li>
                    <li class="nav-item" *ngIf="!isSubWorkOrder">
                        <a id="pills-contact-tab" role="tab" [ngClass]="{active : gridActiveTab === 'billorInvoice'}"
                            (click)="gridTabChange('billorInvoice');">Billing/Invoicing</a>
                        <!-- billingCreateOrEdit(); -->
                    </li>
                    <li class="nav-item" *ngIf="!isSubWorkOrder">
                        <a id="pills-contact-tab" role="tab" [ngClass]="{active : gridActiveTab === 'quote'}"
                            (click)="gridTabChange('quote');">Quote</a>
                    </li>
                    <li class="nav-item" *ngIf="!isSubWorkOrder">
                        <a id="pills-contact-tab" role="tab" [ngClass]="{active : gridActiveTab === 'shipping'}"
                            (click)="gridTabChange('shipping')">Shipping</a>
                    </li>
                    <li class="nav-item" *ngIf="!isSubWorkOrder">
                        <a id="pills-contact-tab" role="tab" [ngClass]="{active : gridActiveTab === ' '}"
                            (click)="gridTabChange('subWO')">Sub-WO</a> 
                    </li>
                    <li class="nav-item">
                        <a id="pills-contact-tab" role="tab" [ngClass]="{active : gridActiveTab === 'communication'}"
                        (click)="gridTabChange('communication')">Communication</a> 
                    </li>
                    <!-- <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                            aria-expanded="false" [ngClass]="{active : gridActiveTab === 'communication'}"
                            (click)="gridTabChange('communication')">Communication</a>
                        <div class="dropdown-menu">
                            <a class="dropdown-item" (click)="selectedCommunicationTab='memo'">Memo</a>
                            <a class="dropdown-item" (click)="selectedCommunicationTab='email'">Email</a>
                            <a class="dropdown-item" (click)="selectedCommunicationTab='phone'">Phone</a>
                            <a class="dropdown-item" (click)="selectedCommunicationTab='text'">Text</a>
                        </div>
                    </li> -->
                    <li class="nav-item">
                        <a class="nav-link" id="pills-contact-tab" role="tab"
                            [ngClass]="{active : gridActiveTab === 'documents'}"
                            (click)="gridTabChange('documents'); getDocumentsByWorkOrderId();">Documents</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                            aria-expanded="false" [ngClass]="{active : gridActiveTab === 'workComplete'}"
                            (click)="gridTabChange('workComplete')">Work Complete</a>
                        <div class="dropdown-menu">
                            <a class="dropdown-item">Move to Finished Goods</a>
                            <a class="dropdown-item">No Work Performed -Return to Customer</a>
                    <!-- <li class="dropdown-submenu">
                        <a class="test">Another dropdown <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a>3rd level dropdown</a></li>
                            <li><a>3rd level dropdown</a></li>
                        </ul>
                    </li> -->
            </div>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="pills-contact-tab" role="tab"
                    [ngClass]="{active : gridActiveTab === 'woanalysis'}" (click)="gridTabChange('woanalysis')">WO
                    Analysis</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="pills-contact-tab" role="tab"
                    [ngClass]="{active : gridActiveTab === 'laboranalysis'}" (click)="gridTabChange('laboranalysis')">
                    Labor Analysis</a>
            </li>
            <li class="nav-item">
                <a id="pills-contact-tab" role="tab" [ngClass]="{active : gridActiveTab === 'tearDown'}"
                    (click)="gridTabChange('tearDown')">Tear Down</a>
            </li>
            <li class="nav-item dropdown">
                <!-- (click)="gridTabChange('otherOptions')" -->
                <a class="nav-link dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                    aria-expanded="false" [ngClass]="{active : gridActiveTab === 'otherOptions'}"
                    >Other Options</a>
                <div class="dropdown-menu">

                    <a class="dropdown-item" (click)="otherOptionTabSelected('freight');gridTabChange('otherOptions')">Freight</a>
                    <!--<a class="dropdown-item" (click)="otherOptionTabSelected('contactGrid')">Contact Grid</a>-->
                    <!--<a class="dropdown-item" (click)="otherOptionTabSelected('accounting')">Accounting</a>-->
                    <a class="dropdown-item" (click)="otherOptionTabSelected('charges');gridTabChange('otherOptions')">Charges</a>
                    <!-- <a class="dropdown-item" (click)="otherOptionTabSelected('exclusions')">Exclusion </a> -->
                </div>
            </li>
            </ul> 
            <br>
            <div *ngIf="isWorkOrderMainView && mainWorkOrderId !=0" [ngClass]="{hidedata :  gridActiveTab !== 'workOrderMain' }">
                <!-- <app-work-order-list [isSubWorkOrder]="isSubWorkOrder" [workOrderId]="mainWorkOrderId"
                    [isWorkOrderMainView]="isWorkOrderMainView" (closeView)="closeWorkOrderMainView($event)">
                </app-work-order-list> -->
                <!-- <div class="card-body"> -->
                    <app-work-view-component [workOrderId]="mainWorkOrderId"></app-work-view-component>
                <!-- </div> -->
            </div>  
            <div [ngClass]="{hidedata :  subTabWorkFlow !== 'createworkFlow' }">
                <!-- <wf-create [isWorkOrder]="isWorkOrder" [savedWorkOrderData]="savedWorkOrderData" (savedWorkFlowWorkOrderData)="savedWorkFlowData($event)" > </wf-create> -->
            </div> 

            <div *ngIf="workFlowId && subTabWorkFlow && editWorkFlowData"
                [ngClass]="{hidedata: subTabWorkFlow !== 'editworkFlow' }">
                <wf-create [isWorkOrder]="isWorkOrder" [workOrderPartNumberId]="workOrderPartNumberId"
                    [workFlowWorkOrderId]="workFlowWorkOrderId" [savedWorkOrderData]="savedWorkOrderData" [workFlowId]="workFlowId"
                    (savedWorkFlowWorkOrderData)="savedWorkFlowData($event)"> </wf-create>
            </div>
            <div *ngIf="workFlowId && subTabWorkFlow " class="wf-label-cstm"
                [ngClass]="{hidedata :  subTabWorkFlow !== 'viewworkFlow' }">
                <app-workflow-list [isWorkOrder]="isWorkOrder" [workFlowType]="subTabWorkFlow"
                    [workFlowId]="workFlowId"></app-workflow-list>
            </div>
            <div *ngIf="workOrderId && (gridActiveTab == 'materialList') "
                [ngClass]="{hidedata : gridActiveTab !== 'materialList' }"> 
                <app-work-order-complete-material-list [materialStatus]="materialStatus" [isWorkOrder]="isWorkOrder"
                    [workFlowObject]="workFlowObject" [savedWorkOrderData]="savedWorkOrderData" [isSubWorkOrder]="isSubWorkOrder" [subWOPartNoId]="subWOPartNoId" [subWorkOrderDetails]="subWorkOrderDetails"
                    [mpnId]="workOrderPartNumberId" [employeesOriginalData]="employeesOriginalData"
                    [workOrderMaterialList]="workOrderMaterialList" (saveRIParts)="saveReservedPartorIssue($event)"
                    (saveMaterialListForWO)="saveWorkOrderMaterialList($event)"  [workOrderId]="workOrderId" 
                    (updateMaterialListForWO)="updateWorkOrderMaterialList($event)" [taskList]="taskList"
                    (refreshData)="getMaterialListHandle()" [mpnPartNumbersList]="mpnPartNumbersList" [isView]="isView || isViewForApprovedPart"></app-work-order-complete-material-list>
            </div>
           <div *ngIf="labor && (gridActiveTab == 'labor') " [ngClass]="{hidedata : gridActiveTab !== 'labor'}" id="check">
                <app-work-order-labor [taskList]="taskList" [laborForm]="labor"
                    [employeesOriginalData]="employeesOriginalData" [workOrderLaborList]="workOrderLaborList"
                    [workOrderWorkFlowOriginalData]="workOrderWorkFlowOriginalData" [isSubWorkOrder]="isSubWorkOrder" [subWOPartNoId]="subWOPartNoId" [subWorkOrderDetails]="subWorkOrderDetails"
                    [selectedPartNumber]="selectedPartNumber" [savedWorkOrderData]="savedWorkOrderData"
                    (saveworkOrderLabor)="saveworkOrderLabor($event)" (refreshLabor)="refreshLabor($event)" [workFlowId]="workFlowId" [isView]="isView || isViewForApprovedPart">
                </app-work-order-labor>  
            </div> 
            <div *ngIf="(gridActiveTab == 'equipment')" [ngClass]="{hidedata : gridActiveTab !== 'equipment'}">
                <app-work-order-assets (saveEquipmentListForWO)="saveWorkOrderEquipmentList($event)" [workOrderPartNumberId]="workOrderPartNumberId"
                    (updateEquipmentListForWO)="updateWorkOrderEquipmentList($event)" [woNumber]="workOrderGeneralInformation.workOrderNum" [customerName]="workOrderGeneralInformation.customerDetails.customerName" [woOperDate]="workOrderGeneralInformation.openDate"
                    (refreshData)="getEquipmentByWorkOrderId($event)" [employeesOriginalData]="employeesOriginalData" [isSubWorkOrder]="isSubWorkOrder" [subWOPartNoId]="subWOPartNoId" [subWorkOrderDetails]="subWorkOrderDetails"
                    [isWorkOrder]="isWorkOrder" [workFlowObject]="workFlowObject"  [workOrderId]="workOrderId"
                    [workOrderAssetList]="workOrderAssetList" [workFlowWorkOrderId]="workFlowWorkOrderId" [savedWorkOrderData]="savedWorkOrderData" [isView]="isView"> 
                </app-work-order-assets>
            </div>
            <div *ngIf="workOrderId && workOrderPartNumberId && (subTabMainComponent === 'existingRO')"
                [ngClass]="{hidedataMain :  subTabMainComponent !== 'existingRO'} ">
                <app-work-order-ro-list [mpnId]="workOrderPartNumberId" [isView]="isView || isViewForApprovedPart"></app-work-order-ro-list>
            </div>
            <div *ngIf="workOrderId && workOrderPartNumberId && (subTabMainComponent === 'createNewRO') "
                [ngClass]="{hidedataMain :  subTabMainComponent !== 'createNewRO'} ">
                <app-work-order-ro-create [mpnId]="workOrderPartNumberId" [isView]="isView || isViewForApprovedPart" [isSubWorkOrder]="isSubWorkOrder" [subWOPartNoId]="subWOPartNoId"> </app-work-order-ro-create>
            </div>
            <div *ngIf="workOrderId && workOrderPartNumberId && (subTabMainComponent === 'returnMCToCustomer') "
                [ngClass]="{hidedataMain :  subTabMainComponent !== 'returnMCToCustomer'} ">
                <app-wo-return-to-customer [workOrderPartNoId]="workOrderPartNumberId" [workOrderId]="workOrderId"> </app-wo-return-to-customer>
            </div>
            <div *ngIf="billing && quoteMaterialList && (gridActiveTab == 'billorInvoice') && !isSubWorkOrder"
                [ngClass]="{hidedata : gridActiveTab !== 'billorInvoice'}">
                <app-work-order-billing [billingorInvoiceForm]="billing" 
                    [savedWorkOrderData]="savedWorkOrderData" 
                    [employeesOriginalData]="employeesOriginalData" [isEditBilling]="isEditBilling" [isbillingNotCreated]="isbillingNotCreated"
                    (saveWOBilling)="saveWorkOrderBilling($event)" (updateWOBilling)="saveWorkOrderBilling($event)"
                    [workOrderQuoteId]="workOrderQuoteId" [quoteExclusionList]="quoteExclusionList" [workFlowWorkOrderId]="workFlowWorkOrderId"
                    [quoteMaterialList]="quoteMaterialList" [quoteFreightsList]="quoteFreightsList" [quotestatusofCurrentPart]="quotestatusofCurrentPart" [workFlowId]="workFlowId" [labordata]="labor" [workOrderLaborList]="workOrderLaborList"
                    [quoteChargesList]="quoteChargesList" [workOrderChargesList]="workOrderChargesList" [quoteLaborList]="quoteLaborList" [taskList]="taskList" [buildMethodDetails]="buildMethodDetails" [isViewMode] = "isView || isViewForApprovedPart"></app-work-order-billing>
            </div> 

            <div *ngIf="(gridActiveTab == 'quote') && !isSubWorkOrder">
                <div *ngIf="workOrderQuoteId == undefined" class="no-quote">
                    Quote not yet created
                </div>
                <div class="form-row pull-right btn-back-wo" *ngIf="workOrderQuoteId == undefined">
                    <button class="btn btn-primary" (click)="enableBackToWO('wo')">
                        Back To Work Order
                    </button>
                </div>
                <div *ngIf="workOrderQuoteId != undefined ">
                    <app-work-order-quote [workorderid]="workOrderId" isView="true"
                        (enableBackToWO)="enableBackToWO($event)" [customerId]="customerId" enableEditBtn="true" isWoTab="true" [isListView]="isListView">
                    </app-work-order-quote>
                </div>
            </div>
            <div *ngIf="(gridActiveTab == 'shipping') && !isSubWorkOrder">
                    <app-shipping [workOrderGeneralInformation]="workOrderGeneralInformation" [managementStructureId]="managementStructureId" [workOrderPartNumberId]="selectedPartNumber.workOrderPartNumberId" [isView]="isView || isViewForApprovedPart"></app-shipping>
            </div>
            <div *ngIf="workOrderId && (gridActiveTab === 'subWO') " [ngClass]="{hidedata : gridActiveTab !== 'subWO'}">
                <app-sub-work-orderlist [workOrderId]="workOrderId" [mpnId]="workOrderPartNumberId" [isView]="isView || isViewForApprovedPart" [forSubWorkOrder]="false">
                </app-sub-work-orderlist>

            </div>
     <!-- <p style="color: red;">       {{workOrderGeneralInformation.customerId}}</p> -->
            <div *ngIf="(gridActiveTab == 'communication')" [ngClass]="{hidedata : gridActiveTab !== 'communication'}">
                <app-communication [isViewMode]="isView"   [idForContact]="workOrderGeneralInformation.customerId.customerId" [type]="1" 
                [moduleName]="moduleNamee"  [referenceId]="isSubWorkOrder ==true ?subWOPartNoId :workFlowWorkOrderId"></app-communication>
            </div>
            <div *ngIf="documents && (gridActiveTab == 'documents')"
                [ngClass]="{hidedata: gridActiveTab !== 'documents'}">
             <div>
                    <app-common-documents   [moduleName]="moduleNamee" [referenceId]="isSubWorkOrder ==true ?subWOPartNoId :workFlowWorkOrderId" [isViewMode]="isView" [offLineUpload]="false"></app-common-documents>
                  </div> 
            </div>
            <div *ngIf="(gridActiveTab == 'woanalysis')" [ngClass]="{hidedata: gridActiveTab !== 'woanalysis'}">
                <app-work-order-analysis [savedWorkOrderData]="savedWorkOrderData" [selectedPartNumber]="selectedPartNumber" [isSubWorkOrder]="isSubWorkOrder" [subWOPartNoId]="subWOPartNoId" [subWorkOrderDetails]="subWorkOrderDetails"></app-work-order-analysis>
            </div>

            <div *ngIf="(gridActiveTab == 'laboranalysis')" [ngClass]="{hidedata: gridActiveTab !== 'laboranalysis'}">
                <app-work-order-labour-analysis [savedWorkOrderData]="savedWorkOrderData" [selectedPartNumber]="selectedPartNumber" [isSubWorkOrder]="isSubWorkOrder" [subWOPartNoId]="subWOPartNoId" [subWorkOrderDetails]="subWorkOrderDetails">
                </app-work-order-labour-analysis>
            </div>
            <div *ngIf="workOrderId && (gridActiveTab == 'tearDown')" class="wf-label-cstm set_pad"
                [ngClass]="{hidedata : gridActiveTab !== 'tearDown'}">
                <app-common-teardown *ngIf="!isView" [workOrderId]="workOrderId" [workFlowWorkOrderId]="workFlowWorkOrderId" [savedWorkOrderData]="savedWorkOrderData" [subWorkOrderDetails]="subWorkOrderDetails" [isSubWorkOrder]="isSubWorkOrder" [subWOPartNoId]="subWOPartNoId"
                    [jobTitles]="jobTitles" [getsaveTearDownData]="saveTearDownData" [isEdit]='isEdit' [isView]="isView || isViewForApprovedPart" [workOrderGeneralInformation]="workOrderGeneralInformation">
                </app-common-teardown> 
                <app-teardown-overview  *ngIf="isView"  [isSubWorkOrder]="isSubWorkOrder" [subWOPartNoId]="subWOPartNoId" [workFlowWorkOrderId1]="workFlowWorkOrderId"></app-teardown-overview>
            </div>

            <div *ngIf="workOrderId && (subTabOtherOptions == 'charges')" class="wf-label-cstm"
                [ngClass]="{hidedataOthers :  subTabOtherOptions !== 'charges'} ">
                <app-work-order-charges [workFlowObject]="workFlowObject" [isWorkOrder]="isWorkOrder" [isSubWorkOrder]="isSubWorkOrder"
                    [workOrderChargesList]="workOrderChargesList" [subWOPartNoId]="subWOPartNoId"
                    (saveChargesListForWO)="saveWorkOrderChargesList($event)"  
                    (saveChargesListDeletedStatus)="getChargesDeletedStatus($event)" 
                    
                    (updateChargesListForWO)="updateWorkOrderChargesList($event)" [taskList]="taskList"
                    (refreshData)="getChargesListByWorkOrderId()" [isView]="isView || isViewForApprovedPart"></app-work-order-charges>
            </div>

            
            <div *ngIf="workOrderId && (subTabOtherOptions == 'exclusions')" class="wf-label-cstm"
                [ngClass]="{hidedataOthers :  subTabOtherOptions !== 'exclusions'} ">
                <app-work-order-exclusions [workFlowObject]="workFlowObject" [isWorkOrder]="isWorkOrder"
                    [workOrderExclusionsList]="workOrderExclusionsList" 
                    (saveExclusionsListForWO)="saveWorkOrderExclusionsList($event)"
                    (updateExclusionsListForWO)="updateWorkOrderExclusionsList($event)" [taskList]="taskList"
                    (refreshData)="getExclusionListByWorkOrderId()" [isView]="isView || isViewForApprovedPart"></app-work-order-exclusions>
            </div>
            <div *ngIf="workOrderId && (subTabOtherOptions == 'freight')" class="wf-label-cstm"
                [ngClass]="{hidedataOthers :  subTabOtherOptions !== 'freight'} ">
                <app-work-order-freight  (saveFreightsListDeletedStatus)="getFreightssDeletedStatus($event)"  [freightForm]="freight" [workOrderFreightList]="workOrderFreightList" [isSubWorkOrder]="isSubWorkOrder" [subWOPartNoId]="subWOPartNoId" [subWorkOrderDetails]="subWorkOrderDetails"
                    [savedWorkOrderData]="savedWorkOrderData" (saveFreightListForWO)="saveWorkOrderFreightsList($event)"
                    (updateFreightListForWo)="updateWorkOrderFreightsList($event)"
                    (refreshData)="getFreightListByWorkOrderId()" [taskList]="taskList" [isView]="isView || isViewForApprovedPart">
                </app-work-order-freight>
            </div>

            <div *ngIf="addresses" [ngClass]="{hidedata : gridActiveTab !== 'address'}">
                <app-work-order-addresses [addressesForm]="addresses"></app-work-order-addresses>
            </div>


        </div>
    </div>
</div>
<div id="warnRestrictMesg" class="modal fade" role="dialog" data-backdrop="static">
    <div class="modal-dialog modal-xsm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title warning_color" *ngIf="restrictID == 0">Warning</h4>
                <h4 class="modal-title restrict_color" *ngIf="restrictID != 0">Restriction</h4>
                <!-- <p id="clockdiv" class="clockdiv"></p> -->
            </div>
            <div class="pad_msf">
                <p *ngIf="warningID != 0 && restrictID == 0" class="mar_o warning_color">
                    {{warningMessage}}</p>
                <!-- <p *ngIf="warningMessage != undefined">Not able to create customer work because cuatomer having restrcitions</p> -->
                <p *ngIf="restrictID != 0 " class="mar_o restrict_color">
                    {{restrictMessage}}</p>
                <!-- <p *ngIf=" restrictID != 0 && isCustomerAction ==true" class="mar_o">Not able to  {{isEdit?'Edit':Create}} Work Order   because customer
                    having restrictions</p>
                <p *ngIf=" restrictID != 0 && isQuoteAction ==true" class="mar_o">Not able to  {{(workOrderQuoteId)?'Edit ':'Create '}} Work Order Quote  because customer
                        having restrictions</p>
                <p *ngIf=" restrictID != 0 && isBillAction ==true" class="mar_o">Not able to  show Billing/Invoicing because customer
                            having restrictions</p> -->
                <!-- <p *ngIf=" restrictID != 0 && isQuoteActionTab ==true" class="mar_o">Not able to  show Quote details because customer
                                having restrictions</p> -->

            </div>
            <div class="modal-footer footer-padding">
                <button class="btn btn-primary footer-button-padding" data-dismiss="modal" (click)="WarnRescticModel()"
                  >Ok </button>
            </div>
        </div>
    </div>
</div>
</div>
<div class="preloader" *ngIf="isSpinnerVisible">
    <div class="loading">
        <div class="lds-roller"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
    </div>
</div>
