<div *ngIf="(fromWoList ==false || fromWoList ==undefined) && !isView">
    <button data-target="#addNewMaterials" data-toggle="modal" class="btn btn-primary mar-left-5"
        (click)="createNew();" style="min-width: 97px !important;">Add PN</button>
    <button type="button" class="btn btn-primary" (click)="openPartNumber()" style="min-width: 97px !important;">
        Add PN New
    </button>
    <button *ngIf="workOrderMaterialList && workOrderMaterialList.length > 0" class="btn btn-primary" 
        (click)="partsIssueRI(1)" data-toggle="modal" style="min-width: 97px !important;"
        data-target="#reserve">Reserve </button>
    <button *ngIf="workOrderMaterialList && workOrderMaterialList.length > 0 && (enablePickTicket)" class="btn btn-primary" 
            (click)="onclickpicktiket()" style="min-width: 97px !important;">Pick Ticket </button>
    <button *ngIf="workOrderMaterialList && workOrderMaterialList.length > 0" class="btn btn-primary"
         (click)="partsIssueRI(2)" data-toggle="modal" data-target="#reserve" style="min-width: 97px !important;"> Issue
    </button>
    <button *ngIf="workOrderMaterialList && workOrderMaterialList.length > 0" class="btn btn-primary"
         (click)="partsIssueRI(3)" data-toggle="modal" data-target="#reserve" style="min-width: 97px !important;">
        Reserve & Issue </button>
    <button *ngIf="workOrderMaterialList && workOrderMaterialList.length > 0" class="btn btn-primary"
         (click)="partsIssueRI(4)" data-toggle="modal" data-target="#reserve" style="min-width: 97px !important;">
        Unissue </button>
    <button *ngIf="workOrderMaterialList && workOrderMaterialList.length > 0" class="btn btn-primary"
         (click)="partsIssueRI(5)" data-toggle="modal" data-target="#reserve" style="min-width: 97px !important;">
        Unreserve </button>
</div>
<div id="addNewMaterials" class="modal fade" role="dialog" data-backdrop="static">
    <div class="modal-dialog modal-xlg"> 
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">{{ isEdit ? 'Edit' : 'Add'  }} PN</h4>
            </div>
            <div class="modal-body">
                <div *ngIf="!isEdit && addNewMaterial"> 
                    <grd-material [isWorkOrder]="isWorkOrder" [customerId]="customerId" [isSubWorkOrder]="isSubWorkOrder" [workFlow]="workFlowObject" [taskList]="taskList"
                        (saveMaterialListForWO)="saveMaterialList($event)"  [mpnPartNumbersList]="mpnPartNumbersList"></grd-material>
                </div>
                <div *ngIf="isEdit && editData && addNewMaterial"> 
                    <grd-material [isEdit]="isEdit" [editData]="editData" [isWorkOrder]="isWorkOrder" [isSubWorkOrder]="isSubWorkOrder"
                        [workFlow]="workFlowObject"  
                        (updateMaterialListForWO)="updateMaterialList($event)" [mpnPartNumbersList]="mpnPartNumbersList">
                    </grd-material> 
                </div>
            </div>
        </div> 
    </div>
</div>
<ng-template #addPart let-c="close" let-d="dismiss">
    <app-work-order-materials-add [isWorkOrder]="isWorkOrder" [customerId]="customerId"
                [clearData]="clearData" [display]="show" [selectedParts]="selectedParts"
                (close)="onClose($event)" [type]="'WO'">
                </app-work-order-materials-add >
    <!-- <app-work-order-materials-add [display]="show" [selectedParts]="selectedParts" 
         [clearData]="clearData" [isWorkOrder]="isWorkOrder" [customerId]="customerId"
         (close)="onClose($event)" [type]="'WO'">
        (select)="openSalesMargin($event)" [salesQuote]="salesQuote" [isStockLineViewMode]="isStockLineViewMode" [selectedSummaryRow]="selectedSummaryRow"
    </app-work-order-materials-add> -->
</ng-template>
<div id="addWOMaterials" class="modal fade" role="dialog" data-backdrop="static">
    <div class="modal-dialog modal-xlg"> 
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">{{ isEdit ? 'Edit' : 'Add'  }} PN</h4>
            </div>
            <div class="modal-body">
                <app-work-order-materials-add [isWorkOrder]="isWorkOrder" [customerId]="customerId"
                [clearData]="clearData" [display]="show" [selectedParts]="selectedParts"
                (close)="onClose($event)" [type]="'WO'">
                </app-work-order-materials-add >
                <div *ngIf="!isEdit && addNewMaterial"> 
                    <!-- <app-work-order-materials-add [isWorkOrder]="isWorkOrder" [customerId]="customerId">
                    </app-work-order-materials-add > -->
                    <!-- <grd-material [isWorkOrder]="isWorkOrder" [customerId]="customerId" [isSubWorkOrder]="isSubWorkOrder" [workFlow]="workFlowObject" [taskList]="taskList"
                        (saveMaterialListForWO)="saveMaterialList($event)"  [mpnPartNumbersList]="mpnPartNumbersList"></grd-material> -->
                </div>
                <!-- <div *ngIf="isEdit && editData && addNewMaterial"> 
                    <grd-material [isEdit]="isEdit" [editData]="editData" [isWorkOrder]="isWorkOrder" [isSubWorkOrder]="isSubWorkOrder"
                        [workFlow]="workFlowObject"  
                        (updateMaterialListForWO)="updateMaterialList($event)" [mpnPartNumbersList]="mpnPartNumbersList">
                    </grd-material> 
                </div> -->
            </div>
            <div class="modal-footer">
                <button type="button" (click)="onClosePartSearchPopUp()" class="btn btn-danger">
                  Close
                </button>
              </div>
        </div> 
    </div>
</div>
<div *ngIf="ispickticket">
    <app-work-order-pickticket [referenceId]="this.savedWorkOrderData.workOrderId"></app-work-order-pickticket>
</div> 
<div *ngIf="!ispickticket">
    <p-table class="rpo-table-cstm rro-table-cstm ptable-f10" id="custome_material" [columns]="cols" #materialTble
        [value]="workOrderMaterialList" [paginator]="true" [rows]="pageSize" [rowsPerPageOptions]="[5, 10, 20,50, 100]"
        (onPage)="pageIndexChange($event)">
        <ng-template pTemplate="header" let-columns>
            <tr>
                <th class="table-column-icon-width"></th>
                 <th class="table-column-width" [ngStyle]="{'width': col.width}" [ngClass]="{'adj_width1': col.header=='PN','adj_width2': (col.header=='PN Description' || col.header=='Classification') }" *ngFor="let col of columns" >
                    {{col.header}} 
                </th>
                <th class="table-actions-column" *ngIf="(fromWoList ==false || fromWoList ==undefined) && !isView">Actions </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-i="rowIndex" let-columns="columns">
             <tr>
                <td class="table-column-icon-width"> 
                    <span >                     
                    </span>
                      <button type="button"  (click)="getRollupMaterialList(rowData,i)"  *ngIf="rowData.isRoleUp==false && rowData.isShowPlus ==true" class="btn btn-primary roleUpd" [disabled]="rowData.partStatusId==0"   matTooltip="Show stock line details"
                      matTooltipPosition="above">
                        <i    class="fa fa-plus mr-0"  
                        ></i>
                      </button>
                      <button type="button" class="btn btn-danger roleUpd" *ngIf="rowData.isRoleUp==false && rowData.isShowPlus ==false"  matTooltip="Show stock line details" 
                      matTooltipPosition="above"  (click)="removeRollUpList(rowData,i)">
                      <i 
                      class="fa fa-minus mr-0" ></i>  
                    </button>
                </td> 
                <td class="table-column-width" *ngFor="let col of columns">
                    <input type="checkbox" name="contract {{i}}" #contract="ngModel" *ngIf="col.field =='isFromWorkFlow'"
                    class="form-control w60 defered-check" [(ngModel)]="rowData.isFromWorkFlow" disabled>
                    <p *ngIf="col.field !='line' && col.field !='memo' && col.field !='defered'&& col.field !='isFromWorkFlow' && col.field !='stockLineNumber' && col.field !='controlNo' && col.field !='controlId' && col.field !='receiver' && col.field !='altEquiv' " style="margin:0px !important"  [ngClass]="{align_rightset : (col && col.align ==1)}">  {{rowData[col.field]}}</p>
                    <p *ngIf="col.field =='line' && col.field !='memo' && col.field !='defered'&& col.field !='isFromWorkFlow' && col.field !='stockLineNumber' && col.field !='controlNo' && col.field !='controlId' && col.field !='receiver'" style="margin:0px !important" class=" p-0 text-right" [ngClass]="{align_rightset : (col && col.align ==1)}"> {{ rowData.line == undefined ?( i + 1):rowData.line }}</p>
                    <p *ngIf="col.field =='stockLineNumber' " [matTooltip]="rowData.stockLineNumber"  [matTooltipDisabled]="rowData.isMultipleStockLine == 'Single'" matTooltipPosition="above" style="margin:0px !important" [ngClass]="{align_rightset : (col && col.align ==1)}"> {{ rowData.isMultipleStockLine== 'Single' ? rowData[col.field] : rowData.isMultipleStockLine}}</p>
                    <p *ngIf=" col.field =='controlNo'" [matTooltip]="rowData.controlNo"  [matTooltipDisabled]="rowData.isMultipleControlNo == 'Single'"  matTooltipPosition="above" style="margin:0px !important" [ngClass]="{align_rightset : (col && col.align ==1)}"> {{rowData.isMultipleControlNo== 'Single' ? rowData[col.field] : rowData.isMultipleControlNo  }}</p>
                    <p *ngIf=" col.field =='controlId'" [matTooltip]="rowData.controlId"  [matTooltipDisabled]="rowData.isMultiplecontrolId == 'Single'"  matTooltipPosition="above" style="margin:0px !important" [ngClass]="{align_rightset : (col && col.align ==1)}"> {{ rowData.isMultiplecontrolId== 'Single' ? rowData[col.field] : rowData.isMultiplecontrolId }}</p>
                    <p *ngIf=" col.field =='receiver'" [matTooltip]="rowData.receiver"  [matTooltipDisabled]="rowData.isMultiplereceiver == 'Single'"  matTooltipPosition="above" style="margin:0px !important" [ngClass]="{align_rightset : (col && col.align ==1)}"> {{ rowData.isMultiplereceiver== 'Single' ? rowData[col.field] : rowData.isMultiplereceiver }}</p>
                    <p *ngIf="col.field =='altEquiv'" style="margin:0px !important">{{rowData.isAltPart ? 'Alternative' : rowData.isEquPart ? 'Equivalent' : '-'}}</p>
                    <input type="checkbox" name="contract {{i}}" #contract="ngModel" *ngIf="col.field =='defered'"
                    class="form-control w60 defered-check" [(ngModel)]="rowData.defered">
                    <span *ngIf="col.field =='memo'" [innerHTML]="rowData[col.field]" class="p_textEditor"></span>
                </td>
                <td class="action-icons-cstm table-column-width" *ngIf="(fromWoList ==false || fromWoList ==undefined) && !isView">
                    <span data-target="#addNewMaterials" data-toggle="modal"><button class="btn nobg btn-edit-cstm1" (click)="edit(rowData)" matTooltip="Edit" matTooltipPosition="above" [disabled]="rowData.quantityIssued!=0 || rowData.quantityReserved !=0"><i  [ngClass]="{'btn_disabled':rowData.quantityIssued!=0 || rowData.quantityReserved !=0}" class="fa fa-pencil"></i></button></span>
                    <!-- [disabled]="!(rowData.quantity > rowData.quantityIssued + rowData.quantityReserved + rowData.partQuantityAvailable)" -->
                    <!-- [ngClass]="{'btn_disabled': !(rowData.quantity > (rowData.quantityIssued + rowData.quantityReserved + rowData.partQuantityAvailable))}" -->
                    <span><button type="button" class="btn nobg btn-pluspo-cstm" (click)="createNewPoWorkOrder(rowData)" *ngIf="rowData.isRoleUp==false"   matTooltip="Create PO" matTooltipPosition="above" ><i class="fa fa-plus"></i></button></span>
                   
                    <span *ngIf="!isSubWorkOrder && rowData.provision=='Sub Work Order'">
                        <button type="button" class="btn nobg btn-pluspo-cstm" *ngIf="rowData.subWorkOrderId == 0" (click)="subWoClick(rowData)" [matTooltip]="rowData.subWorkOrderId ==0 ? 'Create Sub Work Order' : 'Edit Sub Work Order'" matTooltipPosition="above" [disabled]="!(rowData.partStatusId ==2 || rowData.partStatusId ==3)" >
                        <i class="fa fa-plus grn_clr"   [ngClass]="{'btn_disabled':!(rowData.partStatusId ==2 || rowData.partStatusId ==3)}"></i>
                    </button>
                    <button type="button" class="btn nobg btn-pluspo-cstm" *ngIf="rowData.subWorkOrderId != 0" (click)="editSubWo(rowData)" [matTooltip]="rowData.subWorkOrderId ==0 ? 'Create Sub Work Order' : 'Edit Sub Work Order'" matTooltipPosition="above">
                        <i class="fa fa-pencil grn_clr"  ></i>
                    </button>
                </span> 
                <span *ngIf="!isSubWorkOrder && rowData.provision !='Sub Work Order'">
                    <button type="button" class="btn nobg btn-pluspo-cstm"  disabled >
                        <i class="fa fa-plus" style="color: #b7b7b7;" ></i>
                     </button>
                </span>
                <span><button type="button" class="btn nobg btn-delete-cstm" *ngIf="rowData.isRoleUp==false;" (click)="openDelete(content,rowData)"  [ngClass]="{'btn_disabled': (rowData.quantityIssued!=0 || rowData.quantityReserved!=0)}" [disabled]="rowData.quantityIssued!=0 || rowData.quantityReserved !=0" matTooltip="Remove" matTooltipPosition="above"><i class="fa fa-trash"></i></button> </span>
                <!-- <span data-toggle="modal" data-target="#stockAudit"><a class="btn nobg btn-hist-cstm" (click)="openStocklineAudit(rowData)" matTooltip="StockLine History" matTooltipPosition="above"><i class="fa fa-history"></i></a></span> -->
                <span data-toggle="modal" data-target="#materialAudit"><a class="btn nobg btn-hist-cstm mr-top5"  (click)="openMaterialAudit(rowData)" matTooltip="Material List History" matTooltipPosition="above"><i class="fa fa-history"></i></a></span>
            
            </td>
            </tr>
        </ng-template> 
        <ng-template pTemplate="emptymessage" let-columns>
            <tr>
                <td colspan="49" class="no-records-cstm no-records-msg" style="margin-left:-36%">
                    No records found
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="summary" id="footer">
            <label id="footer" class="footer" style="background: #fff !important;">Total:</label>
            <input class="footer-input-width" [(ngModel)]="materialTble._totalRecords" [disabled]="true" pInputText
                type="text" />
            &nbsp;&nbsp;
            <label id="footer" class="footer1">Pages Count:</label>
            <input class="footer-input-width" [ngModel]="
            getPageCount(materialTble._totalRecords, pageSize)
          " [disabled]="true" pInputText type="text" />
        </ng-template>
    </p-table>
</div>
<div id="reserve" class="modal fade" role="dialog" data-backdrop="static">
    <div class="modal-dialog modal-xlg">
        <!-- Modal content-->
        <div class="modal-content">
            <div class="preloader" *ngIf="isSpinnerVisibleReserve">
                <div class="loading">
                    <div class="lds-roller">
                        <div></div><div></div> <div></div><div></div><div></div> <div></div><div></div><div></div>
                    </div>
                </div>
            </div>
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" (click)="closeMaterial()">&times;</button>
                <h4 class="modal-title" *ngIf="statusId === 1">Reserved Parts</h4>
                <h4 class="modal-title" *ngIf="statusId === 2">Issued Parts</h4>
                <h4 class="modal-title" *ngIf="statusId === 3">Reserve & Issue Parts</h4>
                <h4 class="modal-title" *ngIf="statusId === 4">Unissue Parts</h4>
                <h4 class="modal-title" *ngIf="statusId === 5">Unreserve Parts</h4>
                <p id="clockdiv" class="clockdiv" *ngIf="counter"> Session Expire in {{counter | formatTime}}</p>
            </div>
            <div class="form-row mar-left-15" *ngIf="statusId !== 2 && statusId !== 4 && statusId !== 5">
                <div class="col-md-2">
                    <p-checkbox class="p-checkbox-label-womaterial" name="task" binary="false" 
                        label="Include Alternate PN" (onChange)="resetAlternateParts($event)" [(ngModel)]="isShowAlternatePN">
                    </p-checkbox> 
                </div>
                <div class="col-md-4" style="margin-left:-50px !important">
                    <p-checkbox class="p-checkbox-label-womaterial" name="task" binary="false" label="Include Eq PN"
                        (onChange)="resetEqParts($event)" [(ngModel)]="isShowEqPN"></p-checkbox>
                </div> 
            </div>
            <form #reserveData="ngForm">
                <div class="modal-body" *ngIf="reservedList">
                    <div class="table-responsive pas-table-cstm  poro-table-cstm parts-list-table-align" id="workflow-attributes-block">
                        <div class="tableFixHead">
                        <table class="table table-bordered">
                            <thead> 
                                <tr>
                                    <th class="text-center" colspan="1"></th>
                                    <th *ngIf="isShowAlternatePN  " class="text-center" colspan="1"> </th>
                                    <th *ngIf=" isShowEqPN" class="text-center" colspan="1"> </th>
                                    <th colspan="11" class="text-center"> Materials</th>
                                    <th colspan="2" class="text-center"> Stock</th>
                                    <th class="text-center" colspan="4" ></th>
                                </tr>
                                <tr>
                                    <th class="text-center select-all" style="min-width: 65px;">
                                        Select All
                                        <input type="checkbox" name="isSelectAll" 
                                        [(ngModel)]="isAllow"  (change)="allowAll($event.target.checked)">
                                    </th>
                                    <th *ngIf="isShowAlternatePN && (statusId == 1 || statusId == 3) " class="text-center">
                                        Alternate Parts
                                    </th>
                                    <th *ngIf="isShowEqPN && (statusId == 1 || statusId == 3)" class="text-center">
                                        Equivalent Parts
                                    </th>
                                    
                                    
                                    <th class="text-center" style="min-width: 110px;">PN </th>
                                    <th class="text-center" style="min-width: 130px;">Part Description</th>
                                    <th class="text-center" style="min-width: 110px;" *ngIf="(statusId == 2 || statusId == 4 || statusId == 5) && (showAlternateParts ||showEqParts) ">Alt/Equiv</th>
                                    <th class="text-center" style="min-width: 96px;"> Alternate PN For</th>
                                    <th class="text-center"> Cond Type</th>
                                    <th class="text-center width-50"> Stk Type</th>
                                    <th class="text-center width-50" style="width:60px !important">Qty Req</th> 
                                    <th class="text-center width-50" style="width:60px !important">Qty Res</th>
                                    <th class="text-center" style="width:60px !important" >  Qty To Be Reserved</th>
                                    <th class="text-center"style="width:60px !important" >
                                        <span class="font-size-10" *ngIf="statusId == 1 || statusId == 5 ">
                                        {{ statusId != 5 ? 'Qty Actually Reserving' : 'Qty Actually UnReserving'}} </span>
                                        <span class="font-size-10" *ngIf="statusId == 2 || statusId == 4 ">
                                            {{ statusId != 4  ?  'Qty Actually Issuing' : 'Qty Actually UnIssuing'}}
                                        </span>
                                        <span class="font-size-10" *ngIf="statusId == 3"> Qty Actually Resver & Issue</span>
                                    </th>
                                 <th class="text-center" style="width:60px !important"> Qty  Issued   </th>
                                    <th class="text-center" style="width:60px !important" *ngIf="statusId !==2 && statusId !==4"> Qty To Be Issued
                                    </th>
                                    <th class="text-center" style="width:60px !important" *ngIf="statusId === 2  || statusId === 4"> Qty To Be Issued
                                    </th>
                                   <th class="text-center" style="width:60px !important"> Qty on Hand </th>
                                    <th class="text-center width-50" style="width:60px !important"> Qty Avail </th>
                                    <th class="text-center" style="width:60px !important"> Qty on Order </th>
                                    <th class="text-center" style="width: 110px !important;"  *ngIf="statusId === 1 || statusId === 5 ">
                                        {{statusId == 1 ? 'Reserved' : 'UnReserved'  }} Date <span class="clr-red">*</span></th>
                                    <th class="text-center" style="width: 110px !important;"  *ngIf="statusId === 2 || statusId === 3 || statusId === 4">
                                            {{statusId === 2  ? 'Issued'  : 
                                        statusId === 3 ? 'Reserved & Issued'  
                                        : 'UnIssued' 
                                         }}
                                            Date <span class="clr-red">*</span></th>
                                    <th class="text-center" style="width: 110px !important;" *ngIf="statusId === 1 || statusId === 5">
                                        {{statusId === 1 ? 'Reserved' : 'UnReserved'}} By <span class="clr-red">*</span></th>
                                    <th class="text-center" style="width: 110px !important;" *ngIf="statusId === 2 || statusId === 3 || statusId === 4">
                                        {{statusId === 2  ? 'Issued' : statusId === 3 ? 'Reserved & Issued'  :'UnIssued'  }}
                                        By <span class="clr-red">*</span></th>
                                </tr>
                            </thead>
                            <tbody>
                                <ng-container *ngFor="let x of reservedList; let i=index;" >
                                <tr>
                                    <td class="text-center">
                                      <input type="checkbox" name="isParentSelected{{i}}" *ngIf="(statusId === 1 || statusId === 5)"
                                            [(ngModel)]="x.isParentSelected" (change)="selectedParts(x,$event)" [disabled]="x.quantityReserved==0">


                                            <input type="checkbox" name="isParentSelected{{i}}" *ngIf="(statusId === 2 || statusId === 3 || statusId === 4)"
                                            [(ngModel)]="x.isParentSelected" (change)="selectedParts(x,$event)" [disabled]="x.quantityIssued==0">
                                        </td>
                                    <td *ngIf="isShowAlternatePN && (statusId == 1 || statusId == 3)" class="text-center">
                                       <input type="checkbox" name="showAlternateParts{{i}}" 
                                            (ngModelChange)="showAlternateParts($event , x.woReservedIssuedAltParts)"
                                            [(ngModel)]="x.showAlternateParts" >
                                    </td>
                                    <td *ngIf="isShowEqPN && (statusId == 1 || statusId == 3)" class="text-center">
                                        <input type="checkbox" name="showEqParts{{i}}"
                                            (ngModelChange)="showEquantParts($event , x.woReservedIssuedEquParts)" 
                                            [(ngModel)]="x.showEqParts">
                                    </td>
                                    <td>{{x.partNumber}}</td>
                                    <td>{{x.partDescription}}</td>
                                    <td *ngIf="(statusId == 2 || statusId == 4 || statusId == 5)"></td>
                                    <td></td>
                                    <td>{{x.condition}}</td>
                                    <td>{{x.stockType}}</td>
                                    <td class="tex_end">
                                        {{x.quantity}}
                                    </td>
                                    <td class="tex_end">
                                        {{x.quantityAlreadyReserved}}
                                    </td>
                                    <td class="tex_end" *ngIf="(statusId === 1 || statusId === 5)">
                                        {{ statusId !=5  ? x.qtyToBeReserved : x.qtyToBeReserved}}
                                    </td>
                                    <td class="tex_end" *ngIf="(statusId === 2 || statusId === 3 || statusId === 4)">
                                        {{x.qtyToBeReserved}}  
                                    </td>
                                    <td *ngIf="(statusId === 1 || statusId === 5)">
                                        <input type="number" name="quantity{{i}}" [(ngModel)]="x.quantityReserved"  (keypress)="restrictMinus($event)"
                                            (keyup)="validatePartsQuantity($event,x)" [disabled]="!x.isParentSelected">
                                    </td>
                                    <td *ngIf="(statusId === 2 || statusId === 3 || statusId === 4)">
                                        <input type="number" name="quantity{{i}}" [(ngModel)]="x.quantityIssued" (keypress)="restrictMinus($event)"
                                            (keyup)="validatePartsQuantity($event,x)" 
                                            [disabled]="!x.isParentSelected">
                                    </td>
                                    <td class="tex_end">
                                        {{x.quantityAlreadyIssued}} 
                                    </td>
                                    <td  class="tex_end">
                                        {{x.qtyToBeIssued}} 
                                    </td>
                                    <td class="tex_end">{{x.quantityOnHand}}</td>
                                    <td class="tex_end">{{x.quantityAvailable}}</td>
                                    <td class="tex_end">{{x.quantityOnOrder}}</td>
                                    <td *ngIf="statusId != 2 && statusId != 3 && statusId != 4">
                                        <p-calendar [showIcon]="true" class="calender-cstm" name="reservedDate{{i}}"
                                            #reservedDate="ngModel" [required]="x.isParentSelected" [maxDate]="minDateValue"
                                            [(ngModel)]="x.reservedDate" [maxDate]="minDateValue" disabled>
                                        </p-calendar>
                                    </td>
                                    <td *ngIf="statusId != 1 &&  statusId != 5 ">
                                        <p-calendar [showIcon]="true" class="calender-cstm" name="issuedDate{{i}}"
                                            #issuedDate="ngModel" [(ngModel)]="x.issuedDate" [maxDate]="minDateValue"
                                            [required]="x.isParentSelected" [maxDate]="minDateValue" disabled>
                                        </p-calendar>
                                    </td>
                                    <td *ngIf="statusId != 2 && statusId  != 3 && statusId != 4">
                                       <p-autoComplete field="name"
                                        [(ngModel)]="x.reservedById" 
                                        name="reservedBy{{i}}" #reservedBy="ngModel"
                                        errorMessage="Records not found" [forceSelection]="true"
                                        [dropdown]="true" [suggestions]="employeeList"
                                        (completeMethod)="filterEmployee($event)"
                                        (onClear)="clearautoCompleteInput(workOrderGeneralInformation, 'employeeId' )" appendTo='body' [baseZIndex]="9999"
                                        [size]="30" [minLength]="1" [dropdown]="true"
                                        class="p-autoComplete-ctsm"  [required]="x.isParentSelected" disabled >
                                    </p-autoComplete>
                                    <!-- [disabled]="!x.isParentSelected" -->
                                    </td>
                                    <td *ngIf="statusId != 1 && statusId != 5 ">
                                       <p-autoComplete field="name" appendTo='body' [baseZIndex]="9999"
                                        [(ngModel)]="x.issuedById"
                                        name="issuedBy{{i}}" #issuedBy="ngModel"
                                        errorMessage="Records not found" [forceSelection]="true"
                                        [dropdown]="true" [suggestions]="employeeList"
                                        (completeMethod)="filterEmployee($event)"
                                        (onClear)="clearautoCompleteInput(workOrderGeneralInformation, 'employeeId' )"
                                        [size]="30" [minLength]="1" [dropdown]="true"
                                        class="p-autoComplete-ctsm" disabled  [required]="x.isParentSelected">
                                    </p-autoComplete>
                                    <!-- [disabled]="!x.isParentSelected" -->
                                    </td> 
                                </tr>
                                <ng-container *ngIf="x.showAlternateParts==true" >
                                <tr *ngFor="let b of x.woReservedIssuedAltParts; let y=index;">
                                    <td class="text-center">
                                        <input type="checkbox" *ngIf="(statusId === 1 || statusId === 5)" [(ngModel)]="b.isChildSelected" [disabled]="b.quantityReserved==0"
                                            name="isChildSelected{{y}}" (change)="selectedParts(b,$event)">


                                            <input type="checkbox" *ngIf="(statusId === 2 || statusId === 3 || statusId === 4)" [(ngModel)]="b.isChildSelected" [disabled]="b.quantityReserved==0"
                                            name="isChildSelected{{y}}" (change)="selectedParts(b,$event)" [disabled]="x.quantityIssued==0">  
                                    </td>

                                  








                                    <td  *ngIf="isShowAlternatePN && (statusId == 1 || statusId == 3)">
                                    </td>
                                    <td *ngIf="isShowEqPN && (statusId == 1 || statusId == 3)">
                                    </td>
                                    <td>{{b.altPartNumber}}</td>
                                    <td>{{b.altPartDescription}}</td>
                                    <td  *ngIf="statusId == 2 || statusId == 4 || statusId == 5">
                                        <span>Alternative</span>
                                    </td>
                                    <td>{{b.parentPartNo}}</td>


                                    <td>{{b.condition}}</td>
                                    <td>{{b.stockType}}</td>
                                    <td class="tex_end">
                                        {{b.quantity}}
                                    </td>
                                    <td class="tex_end"> {{b.quantityAlreadyReserved}}</td> 
                                   <td class="tex_end">
                                        {{b.qtyToBeReserved}}   
                                    </td>
                                    <td *ngIf="(statusId === 1 || statusId === 5)">
                                        <input type="number" name="quantity1_{{y}}" [(ngModel)]="b.quantityReserved" (keypress)="restrictMinus($event)"
                                            (keyup)="validatePartsQuantity($event,b)" (input)="childPartValidate($event.target.value, b,1)"
                                            [disabled]="!b.isChildSelected">

                                    </td>
                                    <td *ngIf="(statusId === 2 || statusId === 3 || statusId === 4)">

                                        <input type="number" name="quantity2_{{y}}" [(ngModel)]="b.quantityIssued" (keypress)="restrictMinus($event)"
                                            (keyup)="validatePartsQuantity($event,b)"
                                            (input)="childPartValidate($event.target.value, b,1)"
                                            [disabled]="!b.isChildSelected">
                                    </td>
                                    <td class="tex_end">{{b.quantityAlreadyIssued}}</td>
                                    <td class="tex_end">{{b.qtyToBeIssued}}</td>
                                    <td class="tex_end">
                                        {{b.quantityOnHand}}
                                   </td>
                                    <td class="tex_end">
                                        {{b.quantityAvailable}}
                                    </td>
                                    <td class="tex_end">
                                        {{b.quantityOnOrder}}
                                    </td>
                                    <td *ngIf="statusId != 2 && statusId != 3 && statusId != 4">
                                        <p-calendar [showIcon]="true" class="calender-cstm" name="reservedDateAlt{{y}}"
                                            #reservedDateAlt="ngModel" [required]="b.isChildSelected" disabled
                                            [(ngModel)]="b.reservedDate"></p-calendar>
                                     </td>
                                    <td *ngIf="statusId != 1 &&  statusId != 5 ">
                                        <p-calendar [showIcon]="true" class="calender-cstm" name="issuedDateAlt{{y}}"
                                            #issuedDateAlt="ngModel" [(ngModel)]="b.issuedDate" disabled
                                            [required]="b.isChildSelected">
                                        </p-calendar>

                                    </td>
                                    <td *ngIf="statusId != 2 && statusId  != 3 && statusId != 4">
                                        <p-autoComplete field="name"
                                       [(ngModel)]="b.reservedById"
                                       name="reservedByAlt{{y}}" #reservedByAlt="ngModel"
                                        errorMessage="Records not found" [forceSelection]="true"
                                        [dropdown]="true" [suggestions]="employeeList"
                                        (completeMethod)="filterEmployee($event)"
                                        (onClear)="clearautoCompleteInput(workOrderGeneralInformation, 'employeeId' )" appendTo='body' [baseZIndex]="9999"
                                        [size]="30" [minLength]="1" [dropdown]="true"
                                        class="p-autoComplete-ctsm"   [required]="b.isChildSelected" disabled >
                                    </p-autoComplete>
                                    <!-- [disabled]="!b.isChildSelected" -->

                                    </td>
                                    <td *ngIf="statusId != 1 && statusId != 5 ">
                                        <p-autoComplete field="name"
                                        [(ngModel)]="b.issuedById"
                                        name="issuedByAlt{{y}}" #issuedByAlt="ngModel"
                                         errorMessage="Records not found" [forceSelection]="true"
                                         [dropdown]="true" [suggestions]="employeeList"
                                         (completeMethod)="filterEmployee($event)"
                                         (onClear)="clearautoCompleteInput(workOrderGeneralInformation, 'employeeId' )"
                                         [size]="30" [minLength]="1" [dropdown]="true"
                                         class="p-autoComplete-ctsm"  appendTo='body' [baseZIndex]="9999"  [required]="b.isChildSelected" disabled  >
                                     </p-autoComplete>
                                     <!-- [disabled]="!b.isChildSelected" -->
                                    </td>
                                </tr>
                                </ng-container>
                                <ng-container *ngIf="x.showEqParts==true" >
                                <tr *ngFor="let c of x.woReservedIssuedEquParts; let z=index; ">
                                    <td class="text-center">
                                        <input type="checkbox" *ngIf="(statusId === 1 || statusId === 5)" [(ngModel)]="c.isChildSelected" [disabled]="c.quantityReserved==0"
                                            name="isChildSelected{{z}}" (change)="selectedParts(c,$event)">

                                            <input type="checkbox" *ngIf="(statusId === 2 || statusId === 3 || statusId === 4)" [(ngModel)]="c.isChildSelected"  [disabled]="c.quantityReserved==0"
                                            name="isChildSelected{{z}}" (change)="selectedParts(c,$event)">
                                    </td>





                                    <td  *ngIf="isShowAlternatePN && (statusId == 1 || statusId == 3)">
                                    </td>
                                    <td *ngIf="isShowEqPN && (statusId == 1 || statusId == 3)">
                                    </td>
 <td  *ngIf="statusId == 2 || statusId == 4 || statusId == 5">
                                        <span>Equivalent</span>
                                     </td>
                                    <td>{{c.equPartNumber}}</td>
                                    <td>{{c.equPartDescription}}</td>
                                    <td>{{c.parentPartNo}}</td>
                                    <td>{{c.condition}}</td>
                                    <td>{{c.stockType}}</td>
                                    <td class="tex_end">
                                        {{c.quantity}}
                                    </td>
                                    <td class="tex_end">{{c.quantityAlreadyReserved}}</td>
                                   <td class="tex_end">
                                        {{c.qtyToBeReserved}}  
                                    </td>
                                    <td *ngIf="(statusId === 1 || statusId === 5)">
                                        <input type="number" name="quantity11_{{z}}" [(ngModel)]="c.quantityReserved" (keypress)="restrictMinus($event)"
                                            (keyup)="validatePartsQuantity($event,c)" (input)="childPartValidate($event.target.value, c,2)"
                                            [disabled]="!c.isChildSelected">
                                    </td>
                                    <td *ngIf="(statusId === 2 || statusId === 3 || statusId === 4)">
                                        <input type="number" name="quantity22_{{z}}" [(ngModel)]="c.quantityIssued"
                                            (keyup)="validatePartsQuantity($event,c)" (keypress)="restrictMinus($event)"
                                             (input)="childPartValidate($event.target.value, c,2)"
                                            [disabled]="!c.isChildSelected">
                                    </td>
                                    <td class="tex_end">{{c.quantityAlreadyIssued}}</td>
                                  <td class="tex_end">{{c.qtyToBeIssued}}</td>
                                    <td class="tex_end">
                                        {{c.quantityOnHand}}
                                    </td>
                                    <td class="tex_end">
                                        {{c.quantityAvailable}}
                                    </td>
                                    <td class="tex_end">
                                        {{c.quantityOnOrder}}
                                    </td>
                                    <td *ngIf="statusId != 2 && statusId != 3 && statusId != 4">
                                        <p-calendar [showIcon]="true" class="calender-cstm" name="reservedDateEq{{i}}"
                                            #reservedDateEq="ngModel" [required]="c.isChildSelected" [maxDate]="minDateValue" disabled appendTo='body' [baseZIndex]="9999"
                                            [(ngModel)]="c.reservedDate"></p-calendar>
                                    </td>
                                    <td *ngIf="statusId != 1 &&  statusId != 5 ">
                                       <p-calendar [showIcon]="true" class="calender-cstm" name="issuedDateEq{{z}}" appendTo="body"
                                            #issuedDateEq="ngModel" [(ngModel)]="c.issuedDate" [maxDate]="minDateValue" disabled appendTo='body' [baseZIndex]="9999"
                                            [required]="c.isChildSelected"  >
                                        </p-calendar>
                                    </td>
                                    <td *ngIf="statusId != 2 && statusId  != 3 && statusId != 4">
                                        <p-autoComplete field="name"
                                        [(ngModel)]="c.reservedById"
                                        name="reservedByEq{{z}}" #reservedByEq="ngModel"
                                         errorMessage="Records not found" [forceSelection]="true"
                                         [dropdown]="true" [suggestions]="employeeList"
                                         (completeMethod)="filterEmployee($event)"
                                         (onClear)="clearautoCompleteInput(workOrderGeneralInformation, 'employeeId' )"appendTo='body' [baseZIndex]="9999"
                                         [size]="30" [minLength]="1" [dropdown]="true"
                                         class="p-autoComplete-ctsm"  [required]="c.isChildSelected"  disabled>
                                     </p-autoComplete>
                                     <!-- [disabled]="!c.isChildSelected" -->
                                    </td>
                                    <td *ngIf="statusId != 1 && statusId != 5 ">
                                      <p-autoComplete field="name" appendTo='body' [baseZIndex]="9999"
                                        [(ngModel)]="c.issuedById"
                                        name="issuedByEq{{z}}" #issuedByEq="ngModel"
                                         errorMessage="Records not found" [forceSelection]="true"
                                         [dropdown]="true" [suggestions]="employeeList"
                                         (completeMethod)="filterEmployee($event)"
                                         (onClear)="clearautoCompleteInput(workOrderGeneralInformation, 'employeeId' )"
                                         [size]="30" [minLength]="1" [dropdown]="true"
                                         class="p-autoComplete-ctsm"   [required]="c.isChildSelected" disabled >
                                     </p-autoComplete> 
                                     <!-- [disabled]="!c.isChildSelected" -->
                                    </td>
                                </tr>
                            </ng-container>
                        </ng-container> 
                            <tr *ngIf="reservedList && reservedList.length ==0">
                                <td colspan="18" class="no-records-msg no-records-cstm">
                                    No records found
                                </td>
                            </tr> 
                            </tbody>
                        </table>
                        </div>
                        <div style="float:right">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <!-- || checkActiveStatus || checkIsSeclected()-->
                    <button class="btn btn-primary" data-dismiss="modal" (click)="saveRIPart()"
                        [disabled]="!savebutonDisabled ">
                    <span *ngIf="statusId === 1">Reserve</span>
                    <span *ngIf="statusId === 2">Issue</span>
                    <span *ngIf="statusId === 3">Reserve & Issue</span>
                    <span *ngIf="statusId === 4"> Unissue</span>
                    <span *ngIf="statusId === 5">Unreserve</span>
                    </button>
                    <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="closeMaterial()">Cancel</button>
                </div>
            </form>
        </div>
    </div>
</div>
<ng-template #timerAlertNotfi let-c="close" let-d="dismiss">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" (click)="dismissTimerAlert()">&times;</button>
      <h4 class="modal-title">Confirmation</h4>
    </div>
    <div class="modal-body">
      <h6 class="text-center">
        your session getting timeout do you want to reset the time
      </h6>
    </div>
    <div class="modal-footer">
  
      <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="dismissTimerAlert()">No</button>
      <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="actionTimerReset()">Yes</button>
    </div>
  </ng-template>
  <ng-template #tabRedirectConfirmationModal let-c="close" let-d="dismiss">
    <div class="modal-header">
      <button
        type="button"
        class="close"
        data-dismiss="modal"
        (click)="dismissModel()"
      >
        &times;
      </button>
      <h4 class="modal-title">Confirmation</h4>
    </div>
    <div class="modal-body">
      <h6 class="text-center">
Do you  to  create new Sub Work Order  or Add to existing Work Order ?
      </h6>
    </div>
    <div class="modal-footer">
      <button  type="button"  class="btn btn-danger" data-target="#existingSubWo" data-toggle="modal" data-dismiss="modal"   (click)="addToExistingSubWo()">
        Add to Existing Record
      </button>
      <button
        type="button"
        class="btn btn-primary" data-dismiss="modal" (click)="createNewSubWo()">
        Create New </button>
    </div>
  </ng-template>
  <div id="existingSubWo" class="modal fade" role="dialog" data-backdrop="static" >
    <div class="modal-dialog modal-xlg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Sub Work Order List</h4>
            </div>
            <div class="modal-body" *ngIf="subWoRecord && subWoRecord.workOrderMaterialsId !=0 && viewSubWolist==true">
                <app-sub-work-orderlist [workOrderId]="workOrderId" [mpnId]="mpnId" [forSubWorkOrder]="true" [workOrderMaterialsId]="subWoRecord.workOrderMaterialsId" >
                </app-sub-work-orderlist>
           </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger btn-height" data-dismiss="modal" (click)="dismissModel2()">Close</button>
            </div>
            </div> 
    </div>
  </div> 
  <ng-template #content let-c="close" let-d="dismiss">
    <div class="modal-header">
        
        <h4 class="modal-title">Are You Sure Want to Delete?</h4>
        <button type="button" class="close" aria-label="Close" (click)="dismissModel()">
            <span aria-hidden="true">&times;</span>
   </button>
    </div> 
    <div class="modal-body">
        <strong>
            PN:
            <span class="new-label">{{currentRow.partNumber}}</span>
        </strong>
    </div>  
    <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="delete()">Yes</button>
        <button type="button" class="btn btn-danger" (click)="dismissModel()">No</button>
    </div>
  </ng-template>

  <div id="materialAudit" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-xlg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">
            &times;
          </button>
          <h4 class="modal-title">Material History </h4>
        </div>
        <div class="modal-body">
          <div class="preloader" *ngIf="isSpinnerVisibleHistory" style="    z-index: 1060;">
              <div class="loading">
                  <div class="lds-roller"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
              </div>
          </div>
          <div class="table-responsive pas-table-cstm poro-table-cstm parts-list-table-align">
              <div class="tableFixHead history_hg"> 
            <table class="table table-bordered header-table-width"   >
 
                <!-- <span class="clr-red">*</span> -->
                <ng-container  >
                  <thead>
                      <tr>
                        <th rowspan="2">Task</th> 
                        <th rowspan="2">PN </th>
                        <th rowspan="2">PN Description</th>
                        <th rowspan="2">Serial Num</th>
                        <th rowspan="2">Cond</th>
                        <th rowspan="2">Stk Line Num</th>
                        <th rowspan="2">Request Type</th>
                        <th rowspan="2">Provision</th>
                        <!-- <th rowspan="2">PO Num </th> -->
                        <th rowspan="2">Qty Req</th>
                        <th rowspan="2">Qty Res </th>
                        <th rowspan="2">Qty Iss</th>
                        <th rowspan="2">Qty Turned In</th>
                        <th rowspan="2">Qty OH</th>
                        <th rowspan="2">Qty Avail</th>
                        <th rowspan="2">Qty Rem</th>
                        <th rowspan="2">UOM</th>
                        <th rowspan="2">Stk Type</th> 
                        <th rowspan="2">Classification</th>
                        <th rowspan="2">Qty On Order</th>
                        <th rowspan="2">Qty on BK Order</th>
                        <th rowspan="2">Need Date</th>
                        <th rowspan="2">Cntl Num</th>
                        <th rowspan="2">Cntl ID</th>
                        <th rowspan="2">Cur</th>
                        <th rowspan="2">Unit Cost</th>
                        <th rowspan="2">Extended Cost </th>
                        <th rowspan="2">Cost Date</th>
                        <th rowspan="2">PO Num </th>
                        <th rowspan="2">RO Num</th>
                        <th rowspan="2">Rec Num </th>
                        <th rowspan="2">WO Num</th>
                        <th rowspan="2">Sub-WO Num</th>
                        <th rowspan="2">SO Num</th>
                        <th rowspan="2">Site</th>
                        <th rowspan="2">Warehouse</th>
                        <th rowspan="2">Location</th>
                        <th rowspan="2">Shelf</th> 
                        <th rowspan="2">Bin</th>
                        <th rowspan="2">Is Active</th>
                        <th rowspan="2">Is Deleted</th>
                        <th rowspan="2" class="min-width-250">Memo</th>
                        <th rowspan="2">Created Date</th>
                        <th rowspan="2">Created By</th>
                        <th rowspan="2">Updated Date</th>
                        <th rowspan="2">Updated By</th>
                      </tr>
                  </thead>
                  <tbody *ngIf="auditHistoryList && auditHistoryList.length > 0">
                      <tr *ngFor="let audit of auditHistoryList; let i = index">
                         <td [ngStyle]="{color: getColorCodeForHistory(i, 'taskName', audit.taskName) ? 'black' : 'red'}">{{ audit.taskName }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'partNumber', audit.partNumber) ? 'black' : 'red'}">{{ audit.partNumber }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'partDescription', audit.partDescription) ? 'black' : 'red'}">{{ audit.partDescription }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'serialNumber', audit.serialNumber) ? 'black' : 'red'}">{{ audit.serialNumber }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'condition', audit.condition) ? 'black' : 'red'}">{{ audit.condition }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'stockLineNumber', audit.stockLineNumber) ? 'black' : 'red'}">{{ audit.stockLineNumber }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'mandatoryOrSupplemental', audit.mandatoryOrSupplemental) ? 'black' : 'red'}">{{ audit.mandatoryOrSupplemental }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'provision', audit.provision) ? 'black' : 'red'}">{{ audit.provision }}</td>
                          <!-- <td [ngStyle]="{color: getColorCodeForHistory(i, 'provision', audit.provision) ? 'black' : 'red'}">{{ audit.provision }}</td> -->
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'qunatityRequried', audit.qunatityRequried) ? 'black' : 'red'}">{{ audit.qunatityRequried }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'qunatityReserved', audit.qunatityReserved) ? 'black' : 'red'}">{{ audit.qunatityReserved }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'quantityIssued', audit.quantityIssued) ? 'black' : 'red'}">{{ audit.quantityIssued }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'qunatityTurnIn', audit.qunatityTurnIn) ? 'black' : 'red'}">{{ audit.qunatityTurnIn }}</td>
                          <td class="min-w-100" [ngStyle]="{color: getColorCodeForHistory(i, 'partQuantityOnHand', audit.partQuantityOnHand) ? 'black' : 'red'}">{{ audit.partQuantityOnHand }}</td>
                          <td class="min-w-100" [ngStyle]="{color: getColorCodeForHistory(i, 'partQuantityAvailable', audit.partQuantityAvailable) ? 'black' : 'red'}">{{ audit.partQuantityAvailable }}</td>
                          <td class="min-w-100" [ngStyle]="{color: getColorCodeForHistory(i, 'qunatityRemaining', audit.qunatityRemaining) ? 'black' : 'red'}">{{ audit.qunatityRemaining }}</td>
                          <td class="min-w-100" [ngStyle]="{color: getColorCodeForHistory(i, 'uom', audit.uom) ? 'black' : 'red'}">{{ audit.uom }}</td>
                            <td [ngStyle]="{color: getColorCodeForHistory(i, 'stockType', audit.stockType) ? 'black' : 'red'}">{{ audit.stockType }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'itemClassification', audit.itemClassification) ? 'black' : 'red'}">{{ audit.itemClassification }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'partQuantityOnOrder', audit.partQuantityOnOrder) ? 'black' : 'red'}">{{ audit.partQuantityOnOrder }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'qunatityBackOrder', audit.qunatityBackOrder) ? 'black' : 'red'}">{{ audit.qunatityBackOrder }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'needDate', audit.needDate) ? 'black' : 'red'}">{{  audit.needDate | date: 'MM/dd/yyyy' }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'controlNo', audit.controlNo) ? 'black' : 'red'}">{{ audit.controlNo }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'controlId', audit.controlId) ? 'black' : 'red'}">{{ audit.controlId }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'currency', audit.currency) ? 'black' : 'red'}">{{ audit.currency }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'unitCost', audit.unitCost) ? 'black' : 'red'}">{{ audit.unitCost }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'extendedCost', audit.extendedCost) ? 'black' : 'red'}">{{ audit.extendedCost }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'costDate', audit.costDate) ? 'black' : 'red'}">{{ audit.costDate | date: 'MM/dd/yyyy'}}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'purchaseOrderNumber', audit.purchaseOrderNumber) ? 'black' : 'red'}">{{ audit.purchaseOrderNumber }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'repairOrderNumber', audit.repairOrderNumber) ? 'black' : 'red'}">{{ audit.repairOrderNumber }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'receiver', audit.receiver) ? 'black' : 'red'}">{{ audit.receiver }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'workOrderNumber', audit.workOrderNumber) ? 'black' : 'red'}">{{ audit.workOrderNumber }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'subWorkOrderNo', audit.subWorkOrderNo) ? 'black' : 'red'}">{{ audit.subWorkOrderNo }}</td> 
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'salesOrder', audit.salesOrder) ? 'black' : 'red'}">{{ audit.salesOrder }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'site', audit.site) ? 'black' : 'red'}">{{ audit.site }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'wareHouse', audit.wareHouse) ? 'black' : 'red'}">{{ audit.wareHouse }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'location', audit.location) ? 'black' : 'red'}">{{ audit.location }}</td>
                          <td [ngStyle]="{color: getColorCodeForHistory(i, 'shelf', audit.shelf) ? 'black' : 'red'}">{{ audit.shelf }}</td>
                          <td class="min-w-100" [ngStyle]="{color: getColorCodeForHistory(i, 'bin', audit.bin) ? 'black' : 'red'}">{{ audit.bin }}</td>
                          <td>
                            <input type="checkbox" disabled [checked]="audit.isActive == true"
                            style="margin: 0px auto; display: block;" />
                             </td>
                             <td>
                            <input type="checkbox" disabled [checked]="audit.isDeferred == true"
                                   style="margin: 0px auto; display: block;" />
                        </td>
                        <td class="min-width-250" [ngStyle]="{color: getColorCodeForHistory(i, 'memo', audit.memo) ? 'black' : 'red'}">
                            <p class="p_editor" [innerHTML]="audit.memo"></p>
                        </td>
                        <td>{{ audit.createdDate | date: 'MM/dd/yyyy h:mm:ss a' }}</td>
                        <td>{{ audit.createdBy }}</td>
                        <td [ngStyle]="{color: getColorCodeForHistory(i, 'updatedDate', audit.updatedDate) ? 'black' : 'red'}">{{ audit.updatedDate | date: 'MM/dd/yyyy h:mm:ss a'}}</td>
                          <td class="min-w-100" [ngStyle]="{color: getColorCodeForHistory(i, 'updatedBy', audit.updatedBy) ? 'black' : 'red'}">{{ audit.updatedBy }}</td>
                      </tr>
                      </tbody>
                </ng-container>
            </table>
            </div>
            <ng-template *ngIf="auditHistoryList && auditHistoryList.length==0">
              <div class="text-center">
                  <div class="text-center">
                      <img src="../../../assets/images/binoculars.png" class="no-history-found-image">
                      <h4 class="no-history-found-msg">No History Found </h4>
                  </div>
              </div>
            </ng-template>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="preloader" *ngIf="isSpinnerVisible">
    <div class="loading">
        <div class="lds-roller">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
</div>




<!-- <table class="table table-bordered" id="so-table">
    <tr class="font-size-10">
        <th *ngFor="let summaryColumn of summaryColumns" [ngStyle]="{'min-width': summaryColumn.width}">
            <span *ngIf="summaryColumn.field == 'quantityToBeQuoted'
                 || summaryColumn.field == 'customerRef'
                 || summaryColumn.field == 'quantityRequested'">
                {{ summaryColumn.header }}
            </span>
            <span *ngIf="summaryColumn.field != 'quantityToBeQuoted' 
            && summaryColumn.field != 'customerRef'
                && summaryColumn.field != 'quantityRequested'">
                {{ summaryColumn.header }}
            </span>
        </th>
        <th colspan="13"></th>
        <th *ngIf="isViewMode == false"
            style="position: sticky !important; min-width: 145px !important;">Actions
        </th>
    </tr>
    <ng-container *ngIf="summaryParts.length > 0">
        <ng-container *ngFor="let summaryPart of summaryParts;let rowIndex=index;">
            <tbody>
                <tr ngClass="'row-bg1'" pReorderableRowHandle>
                    <td *ngFor="let summaryColumn of summaryColumns; let i = index"
                        class="summary-column" pReorderableRowHandle>
                        <span class="float-right" *ngIf="summaryColumn.field == 'fixRate'">
                            {{summaryPart[summaryColumn.field] | twoDecimalGlobalNumberFormatPipe : '1.5'}}
                        </span>
                        <span *ngIf="summaryColumn.field == 'itemNo'">
                            {{summaryPart[summaryColumn.field] }}
                        </span>
                        <span *ngIf="summaryColumn.field != 'itemNo'
                                    && summaryColumn.field != 'quantityRequested'
                                    && summaryColumn.field != 'quantityToBeQuoted'
                                    && summaryColumn.field != 'quantityAlreadyQuoted'
                                    && summaryColumn.field != 'qtyAvailable'
                                    && summaryColumn.field != 'qtyReserved'
                                    && summaryColumn.field != 'qtyOnHand'
                                    && summaryColumn.field != 'fixRate'
                                    && summaryColumn.field != 'grossSalePrice'
                                    && summaryColumn.field != 'salesDiscountExtended'
                                    && summaryColumn.field != 'netSalesPriceExtended'
                                    && summaryColumn.field != 'misc'
                                    && summaryColumn.field != 'freight'
                                    && summaryColumn.field != 'taxAmount'
                                    && summaryColumn.field != 'totalSales'
                                    && summaryColumn.field != 'unitCostExtended'
                                    && summaryColumn.field != 'marginAmountExtended'
                                    && summaryColumn.field != 'marginPercentageExtended'">
                            {{summaryPart[summaryColumn.field]}}
                        </span>
                        <span class="float-right" *ngIf="summaryColumn.field == 'quantityRequested'
                                    || summaryColumn.field == 'quantityToBeQuoted'
                                    || summaryColumn.field == 'quantityAlreadyQuoted'
                                    || summaryColumn.field == 'qtyAvailable'
                                    || summaryColumn.field == 'qtyReserved'
                                    || summaryColumn.field == 'qtyOnHand'">
                            {{summaryPart[summaryColumn.field] | globalNmberFormat}}
                        </span>
                        <span class="float-right" *ngIf=" summaryColumn.field == 'grossSalePrice'
                                    || summaryColumn.field == 'salesDiscountExtended'
                                    || summaryColumn.field == 'netSalesPriceExtended'
                                    || summaryColumn.field == 'misc'
                                    || summaryColumn.field == 'freight'
                                    || summaryColumn.field == 'taxAmount'
                                    || summaryColumn.field == 'totalSales'
                                    || summaryColumn.field == 'unitCostExtended'
                                    || summaryColumn.field == 'marginAmountExtended'
                                    || summaryColumn.field == 'marginPercentageExtended'">
                            {{summaryPart[summaryColumn.field] | twoDecimalGlobalNumberFormatPipe}}
                        </span>
                    </td>
                    <td colspan="13" style="background-color: #EAF2C5 !important;"></td>
                    <td *ngIf="isViewMode == false" style="position:sticky; width:80px">
                        <span>
                            <a [class.disabled]="salesQuote.isApproved || isViewMode"
                                [ngClass]="{'btn_disabled': salesQuote.isApproved || isViewMode}"
                                class="btn nobg" (click)="addPartNumber(summaryPart,rowIndex)"
                                matTooltip="Add/Edit Stock Line" matTooltipPosition="above">
                                <i class="fa fa-pencil"></i>
                            </a>
                        </span>
                        <span>
                            <a class="btn nobg" (click)="viewPartNumber(summaryPart,rowIndex)"
                                matTooltip="View Stock Line" matTooltipPosition="above">
                                <i class="fa fa-eye"></i>
                            </a>
                        </span>
                        <span>
                            <a [class.disabled]="salesQuote.isApproved || isViewMode"
                                [ngClass]="{'btn_disabled': salesQuote.isApproved || isViewMode}"
                                class="btn nobg"
                                (click)="openmultiplepartDelete(summaryPart,rowIndex,deletepartcontent)"
                                matTooltip="Delete" matTooltipPosition="above">
                                <i class="fa fa-trash"></i>
                            </a>
                        </span>
                        <span>
                            <a class="btn nobg btn-pluspo-cstm" (click)="createPO(summaryPart)"
                                matTooltip="Create PO" matTooltipPosition="above">
                                <i class="fa fa-plus"> </i>
                            </a>
                        </span>
                    </td>
                </tr>
                <tr class="child-header splitship-head child-header-back">
                    <th class="background-white"></th>
                    <th>PN</th>
                    <th>PN Description </th>
                    <th colspan="2">Stk Line Num</th>
                    <th colspan="2">Ser Num</th>
                    <th>Stk Type</th>
                    <th>Cond</th>
                    <th>Priority<span class="clr-red">*</span></th>
                    <th>Cust Req Date<span class="clr-red">*</span></th>
                    <th>Cust PRMSD Date<span class="clr-red">*</span></th>
                    <th>Est Ship Date<span class="clr-red">*</span></th>
                    <th>Qty Ord</th>
                    <th>Qty Resvd</th>
                    <th style="min-width: 60px;">Qty Avail </th>
                    <th style="min-width: 80px;">Qty On Hand</th>
                    <th>Qty to Ship</th>
                    <th>Alt/Equiv</th>
                    <th>Status </th>
                    <th>Qte Num</th>
                    <th style="min-width: 85px;">Qte Ver</th>
                    <th style="min-width: 80px;">Qte Date</th>
                    <th style="min-width: 75px;">Qty Invoiced</th>
                    <th style="min-width: 100px;">Invoice Num</th>
                    <th style="min-width: 100px;">Invoice Date </th>
                    <th style="min-width: 90px;">Ship Ref</th>
                  <th style="min-width: 75px !important;">Per Unit</th>
                    <th style="min-width: 75px !important;">Ext. Price</th>
                    <th style="min-width: 80px !important;">Misc Charges</th>
                    <th style="min-width: 85px !important;">Total Revenue</th>
                    <th style="min-width: 80px !important;">Unit Cost</th>
                    <th style="min-width: 80px !important;">Ext Cost</th>
                    <th style="min-width: 85px !important;">Margin Amt</th>
                    <th style="min-width: 85px !important;">Margin %</th>
                    <th style="min-width: 75px !important;">Freight</th>
                    <th style="min-width: 70px !important;">Tax Amt</th>
                    <th style="min-width: 90px;">Cntrl Num</th>
                    <th style="min-width: 100px;">Cntrl ID Num</th>
                    <th style="width:120px">Notes</th>
                    <th *ngIf="isViewMode == false"
                        style="min-width: 120px; position: sticky !important">Actions</th>
                </tr>
                <tr class="child-data splitship-child child-data-back"
                    *ngFor="let part of summaryPart.childParts; let stockIndex = index"
                    [hidden]="part.isDeleted">
                    <td></td>
                    <td>
                        {{ part.partNumber }}
                    </td>
                    <td>
                        {{ part.description }}
                    </td>
                    <td colspan="2">
                        {{ part.stockLineNumber }}
                    </td>
                    <td colspan="2">
                        {{ part.serialNumber }}
                    </td>
                    <td>
                        {{ part.pmaStatus }}
                    </td>
                    <td>
                        {{ part.conditionDescription }}
                    </td>
                    <td *ngIf="isViewMode == true || isEditDisabled(salesQuote, part)">
                        {{  part.priorityName }}
                    </td>
                    <td *ngIf="isViewMode == false && !isEditDisabled(salesQuote, part)">
                        <select name="priorityId" [(ngModel)]="part.priorityId" required id="priorityId"
                            #priorityId="ngModel" (change)="onEditPartDetails()">
                            <option *ngFor=" let p of salesQuote.priorities" [ngValue]="p.priorityId">
                                {{ p.description }}
                            </option>
                        </select>
                    </td>
                    <td *ngIf="isViewMode == true || isEditDisabled(salesQuote, part)">
                        {{  part.customerRequestDate | date: "MM/dd/yyyy" }}
                    </td>
                    <td *ngIf="isViewMode == false && !isEditDisabled(salesQuote, part)">
                        <p-calendar [ngClass]="inputValidCheckHeader ? 'p-clder-validate' : ''"
                            class="pas-clder" [showIcon]="true" appendTo="body"
                            name="customerRequestDate" [yearNavigator]="true" [monthNavigator]="true"
                            yearRange="1900:2100" [(ngModel)]="part.customerRequestDate"
                            (ngModelChange)="onEditPartDetails()" #customerRequestDate="ngModel"
                            [minDate]="salesQuote.openDate" required>
                        </p-calendar>
                        <div *ngIf="customerRequestDate.invalid && (customerRequestDate.dirty || customerRequestDate.touched)"
                            class="alert alert-danger alert-danger-cstm">
                            <div *ngIf="customerRequestDate.errors.required">
                                <small>Customer Request Date is required </small>
                            </div>
                        </div>
                    </td>
                    <td *ngIf="isViewMode == true || isEditDisabled(salesQuote, part)">
                        {{  part.promisedDate | date: "MM/dd/yyyy" }}
                    </td>
                    <td *ngIf="isViewMode == false && !isEditDisabled(salesQuote, part)">
                        <p-calendar [ngClass]="inputValidCheckHeader ? 'p-clder-validate' : ''"
                            class="pas-clder" [showIcon]="true" appendTo="body" name="promisedDate"
                            [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"
                            [(ngModel)]="part.promisedDate" (ngModelChange)="onEditPartDetails()"
                            #promisedDate="ngModel" [minDate]="salesQuote.openDate" required>
                        </p-calendar>
                        <div *ngIf="promisedDate.invalid && (promisedDate.dirty || promisedDate.touched)"
                            class="alert alert-danger alert-danger-cstm">
                            <div *ngIf="promisedDate.errors.required">
                                <small>Promised Date is required </small>
                            </div>
                        </div>
                    </td>
                    <td *ngIf="isViewMode == true || isEditDisabled(salesQuote, part)">
                        {{  part.estimatedShipDate | date: "MM/dd/yyyy" }}
                    </td>
                    <td *ngIf="isViewMode == false && !isEditDisabled(salesQuote, part)">
                        <p-calendar [ngClass]="inputValidCheckHeader ? 'p-clder-validate' : ''"
                            class="pas-clder" [showIcon]="true" appendTo="body" name="estimatedShipDate"
                            [yearNavigator]="true" [monthNavigator]="true" yearRange="1900:2100"
                            [(ngModel)]="part.estimatedShipDate" (ngModelChange)="onEditPartDetails()"
                            #estimatedShipDate="ngModel" [minDate]="salesQuote.openDate" required>
                        </p-calendar>
                        <div *ngIf="estimatedShipDate.invalid && (estimatedShipDate.dirty || estimatedShipDate.touched)"
                            class="alert alert-danger alert-danger-cstm">
                            <div *ngIf="estimatedShipDate.errors.required">
                                <small>Estimated Ship Date is required </small>
                            </div>
                        </div>
                    </td>
                    <td class="text-right">
                        {{ part.quantityFromThis | globalNmberFormat  }}
                    </td>
                    <td class="text-right">
                        {{ part.qtyReserved | globalNmberFormat }}
                    </td>
                    <td class="text-right">
                        {{ part.qtyAvailable | globalNmberFormat }}
                    </td>
                    <td class="text-right">
                        {{ part.quantityOnHand | globalNmberFormat }}
                    </td> <td class="text-right">
                        {{ part.qtyToShip | globalNmberFormat }}
                    </td>
                    <td>
                        {{  part.altOrEqType }}
                    </td>
                    <td>
                        {{ part.statusName }}
                    </td>
                    <td>
                        {{ part.salesQuoteNumber }}
                    </td>
                    <td>
                        {{ part.quoteVesrion }}
                    </td>
                    <td>
                        {{ part.quoteDate | date : "MM/dd/yyyy"}}
                    </td>
                    <td class="text-right">
                        {{ part.qtyInvoiced | globalNmberFormat }}
                    </td>
                    <td>
                        {{ part.invoiceNumber }}
                    </td>
                    <td>
                        {{ part.invoiceDate | date : "MM/dd/yyyy"}}
                    </td>  <td>
                        {{ part.shipReference }}
                    </td>
                    <td class="text-right">
                        {{ part.grossSalePricePerUnit  | twoDecimalGlobalNumberFormatPipe}}
                    </td>
                    <td class="text-right">
                        {{ part.grossSalePrice | twoDecimalGlobalNumberFormatPipe}}
                    </td>
                    <td class="text-right">
                        {{ part.misc | twoDecimalGlobalNumberFormatPipe}}
                    </td>
                    <td class="text-right">
                        {{ getTotalRevenue(part) | twoDecimalGlobalNumberFormatPipe}}
                    </td>
                    <td class="text-right">
                        {{ part.unitCostPerUnit | twoDecimalGlobalNumberFormatPipe }}
                    </td>
                    <td class="text-right">
                        {{ part.unitCostExtended | twoDecimalGlobalNumberFormatPipe }}
                    </td>
                    <td class="text-right">
                        {{ getMarginAmount(part) | twoDecimalGlobalNumberFormatPipe}}
                    </td>
                    <td class="text-right">
                        {{ getMarginPercentage(part) | twoDecimalGlobalNumberFormatPipe}}
                        %</td>
                    <td class="text-right">
                        {{ part.freight  | twoDecimalGlobalNumberFormatPipe }}
                    </td>
                    <td class="text-right">
                        {{ part.taxAmount  | twoDecimalGlobalNumberFormatPipe }}
                    </td>
                    <td>
                        {{ part.controlNumber }}
                    </td>
                    <td>
                        {{ part.idNumber }}
                    </td>
                    <td class="width-120"
                        *ngIf="isViewMode == false && !isEditDisabled(salesQuote, part)">
                        <div class="form-group memo-popup-cstm mat_emo"
                            style="width: 120px; display: inline-flex; margin-bottom: 0;">
                            <div [innerHTML]="part.notes" class="text_editor_box"></div>
                            <i class="fa fa-pencil" data-toggle="modal"
                                style="position: relative;top: 6px;padding-left:4px;"
                                data-target="#textarea-popupNotes" matTooltip="Notes"
                                matTooltipPosition="above"
                                (click)="onAddTextAreaInfo(part,stockIndex, rowIndex)"></i>
                        </div>
                    </td>
                    <td *ngIf="isViewMode == true || isEditDisabled(salesQuote, part)">
                        <div [innerHTML]="part.notes" class="text_editor_box"></div>
                    </td>
                    <td class="zui-sticky-col width-107" *ngIf="isViewMode == false">
                        <span *ngIf="!isEditDisabled(salesQuote, part)">
                            <a [class.disabled]="isEditDisabled(salesQuote, part)"
                                [ngClass]="{'btn_disabled': isEditDisabled(salesQuote, part)}"
                                class="btn nobg" (click)="openPartToEdit(part)" matTooltip="Edit"
                                matTooltipPosition="above">
                                <i class="fa fa-pencil"></i>
                            </a>
                        </span>
                        <span>
                            <a [class.disabled]="isDeleteDisabled(salesQuote, part)"
                                [ngClass]="{'btn_disabled': isDeleteDisabled(salesQuote, part)}"
                                class="btn nobg" (click)="openPartDelete(deleteContent,part)"
                                matTooltip="Delete" matTooltipPosition="above">
                                <i class="fa fa-trash"></i>
                            </a>
                        </span>
                        <span>
                            <a class="btn nobg btn-plusro-cstm" (click)="createRO(part)"
                                matTooltip="Create RO" matTooltipPosition="above">
                                <i class="fa fa-plus" style="color: #259e08;"></i>
                            </a>
                        </span>
                        <span>
                            <a class="btn nobg btn-plusro-cstm"
                                (click)="initiateCreateWOROPO(part, 'WO')" matTooltip="Create WO"
                                matTooltipPosition="above">
                                <i class="fa fa-plus" style="color: #24089e;"></i>
                            </a>
                        </span>
                    </td>
                </tr>
            </tbody>
        </ng-container>
    </ng-container>
    <ng-container *ngIf="summaryParts.length == 0">
        <tbody>
            <tr>
                <td colspan="48"
                    style="color: red; font-weight: bold; text-transform: uppercase;margin-left:-15%">
                    No records found
                </td>
            </tr>
        </tbody>
    </ng-container>
</table> -->